{"version":3,"file":"js/addon-entry-hide-flyout.js","sources":["webpack://GUI/./src/addons/addons/hide-flyout/style.css","webpack://GUI/./src/addons/addons/hide-flyout/lock.svg","webpack://GUI/./src/addons/addons/hide-flyout/unlock.svg","webpack://GUI/./src/addons/addons/hide-flyout/_runtime_entry.js","webpack://GUI/./src/addons/addons/hide-flyout/userscript.js"],"sourcesContent":["exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".blocklyFlyout,\\n.blocklyFlyoutScrollbar,\\n.sa-lock-image {\\n  transition-property: transform;\\n}\\n\\n.blocklyFlyout.sa-flyoutClose {\\n  transform: translateX(-200px) !important;\\n}\\n\\n.blocklyFlyoutScrollbar.sa-flyoutClose {\\n  transform: translateX(35px) !important;\\n}\\n\\n.sa-lock-image.sa-flyoutClose {\\n  transform: translateX(-260px);\\n}\\n\\n.sa-flyout-placeHolder {\\n  position: absolute;\\n  left: 61px;\\n  top: 44px;\\n  height: 100%;\\n  width: 251px;\\n}\\n\\n.sa-lock-image {\\n  position: absolute;\\n  z-index: 20;\\n  width: 20px;\\n  cursor: pointer;\\n  top: 46px;\\n  left: 280px;\\n}\\n\\n.injectionDiv {\\n  overflow: hidden !important;\\n}\\n\", \"\"]);\n\n// exports\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgc3R5bGU9Ii1tcy10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xMiAxM2ExIDEgMCAwIDAtMSAxdjNhMSAxIDAgMCAwIDIgMHYtM2ExIDEgMCAwIDAtMS0xem01LTRWN0E1IDUgMCAwIDAgNyA3djJhMyAzIDAgMCAwLTMgM3Y3YTMgMyAwIDAgMCAzIDNoMTBhMyAzIDAgMCAwIDMtM3YtN2EzIDMgMCAwIDAtMy0zek05IDdhMyAzIDAgMCAxIDYgMHYySDl6bTkgMTJhMSAxIDAgMCAxLTEgMUg3YTEgMSAwIDAgMS0xLTF2LTdhMSAxIDAgMCAxIDEtMWgxMGExIDEgMCAwIDEgMSAxeiIgZmlsbD0iIzYyNjI2MiIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgc3R5bGU9Ii1tcy10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xMiAxM2ExLjQ5IDEuNDkgMCAwIDAtMSAyLjYxVjE3YTEgMSAwIDAgMCAyIDB2LTEuMzlBMS40OSAxLjQ5IDAgMCAwIDEyIDEzem01LTRIOVY3YTMgMyAwIDAgMSA1LjEyLTIuMTMgMy4wOCAzLjA4IDAgMCAxIC43OCAxLjM4IDEgMSAwIDEgMCAxLjk0LS41IDUuMDkgNS4wOSAwIDAgMC0xLjMxLTIuMjlBNSA1IDAgMCAwIDcgN3YyYTMgMyAwIDAgMC0zIDN2N2EzIDMgMCAwIDAgMyAzaDEwYTMgMyAwIDAgMCAzLTN2LTdhMyAzIDAgMCAwLTMtM3ptMSAxMGExIDEgMCAwIDEtMSAxSDdhMSAxIDAgMCAxLTEtMXYtN2ExIDEgMCAwIDEgMS0xaDEwYTEgMSAwIDAgMSAxIDF6IiBmaWxsPSIjNjI2MjYyIi8+PC9zdmc+\"","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","/* inserted by pull.js */\nimport _twAsset0 from \"!url-loader!./lock.svg\";\nimport _twAsset1 from \"!url-loader!./unlock.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/lock.svg\") return _twAsset0;\n  if (path === \"/unlock.svg\") return _twAsset1;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nexport default async function ({ addon, global, console }) {\n  let placeHolderDiv = null;\n  let lockDisplay = null;\n  let flyOut = null;\n  let scrollBar = null;\n  let toggle = true;\n  let selectedCategory = null;\n  let toggleSetting = addon.settings.get(\"toggle\");\n  let flyoutLock = false;\n\n  function getSpeedValue() {\n    let data = {\n      none: \"0\",\n      short: \"0.25\",\n      default: \"0.5\",\n      long: \"1\",\n    };\n    return data[addon.settings.get(\"speed\")];\n  }\n  function onmouseenter(e, speed = {}) {\n    // If a mouse event was passed, only open flyout if the workspace isn't being dragged\n    if (\n      !e ||\n      e.buttons === 0 ||\n      document.querySelector(\".blocklyToolboxDiv\").className.includes(\"blocklyToolboxDelete\")\n    ) {\n      speed = typeof speed === \"object\" ? getSpeedValue() : speed;\n      flyOut.classList.remove(\"sa-flyoutClose\");\n      flyOut.style.transitionDuration = `${speed}s`;\n      scrollBar.classList.remove(\"sa-flyoutClose\");\n      scrollBar.style.transitionDuration = `${speed}s`;\n      lockDisplay.classList.remove(\"sa-flyoutClose\");\n      lockDisplay.style.transitionDuration = `${speed}s`;\n      setTimeout(() => Blockly.getMainWorkspace().recordCachedAreas(), speed * 1000);\n    }\n  }\n  function onmouseleave(e, speed = getSpeedValue()) {\n    // If we go behind the flyout or the user has locked it, let's return\n    if ((toggleSetting !== \"cathover\" && e && e.clientX <= scrollBar.getBoundingClientRect().left) || flyoutLock)\n      return;\n    flyOut.classList.add(\"sa-flyoutClose\");\n    flyOut.style.transitionDuration = `${speed}s`;\n    scrollBar.classList.add(\"sa-flyoutClose\");\n    scrollBar.style.transitionDuration = `${speed}s`;\n    lockDisplay.classList.add(\"sa-flyoutClose\");\n    lockDisplay.style.transitionDuration = `${speed}s`;\n    setTimeout(() => Blockly.getMainWorkspace().recordCachedAreas(), speed * 1000);\n  }\n\n  let didOneTimeSetup = false;\n  function doOneTimeSetup() {\n    if (didOneTimeSetup) {\n      return;\n    }\n    didOneTimeSetup = true;\n    addon.tab.redux.initialize();\n    addon.tab.redux.addEventListener(\"statechanged\", (e) => {\n      switch (e.detail.action.type) {\n        // Event casted when you switch between tabs\n        case \"scratch-gui/navigation/ACTIVATE_TAB\":\n          // always 0, 1, 2\n          lockDisplay.style.display = e.detail.action.activeTabIndex === 0 ? \"block\" : \"none\";\n          placeHolderDiv.style.display = e.detail.action.activeTabIndex === 0 ? \"block\" : \"none\";\n          if (e.detail.action.activeTabIndex === 0) {\n            onmouseenter(null, 0);\n            toggle = true;\n          }\n          break;\n        // Event casted when you switch between tabs\n        case \"scratch-gui/mode/SET_PLAYER\":\n          // always true or false\n          lockDisplay.style.display = e.detail.action.isPlayerOnly ? \"none\" : \"block\";\n          placeHolderDiv.style.display = e.detail.action.activeTabIndex === 0 ? \"block\" : \"none\";\n          break;\n      }\n    });\n    if (toggleSetting === \"category\" || toggleSetting === \"cathover\") {\n      (async () => {\n        while (true) {\n          let category = await addon.tab.waitForElement(\".scratchCategoryMenuItem\", {\n            markAsSeen: true,\n            condition: () => !addon.tab.redux.state.scratchGui.mode.isPlayerOnly,\n          });\n          category.onclick = () => {\n            if (toggle && selectedCategory === category && toggleSetting === \"category\") {\n              onmouseleave();\n              selectedCategory = category;\n            } else if (!toggle) {\n              onmouseenter();\n              selectedCategory = category;\n            } else {\n              selectedCategory = category;\n              return;\n            }\n            if (toggleSetting === \"category\") toggle = !toggle;\n          };\n        }\n      })();\n    }\n  }\n\n  while (true) {\n    flyOut = await addon.tab.waitForElement(\".blocklyFlyout\", {\n      markAsSeen: true,\n      reduxCondition: (state) => !state.scratchGui.mode.isPlayerOnly,\n    });\n    let blocklySvg = document.querySelector(\".blocklySvg\");\n    scrollBar = document.querySelector(\".blocklyFlyoutScrollbar\");\n    const tabs = document.querySelector('[class^=\"gui_tabs\"]');\n\n    // Placeholder Div\n    if (placeHolderDiv) placeHolderDiv.remove();\n    placeHolderDiv = document.createElement(\"div\");\n    if (toggleSetting === \"hover\") tabs.appendChild(placeHolderDiv);\n    placeHolderDiv.className = \"sa-flyout-placeHolder\";\n\n    // Lock Img\n    if (lockDisplay) lockDisplay.remove();\n    lockDisplay = document.createElement(\"img\");\n    lockDisplay.src = _twGetAsset(`/${flyoutLock ? \"\" : \"un\"}lock.svg`);\n    lockDisplay.className = \"sa-lock-image\";\n    lockDisplay.onclick = () => {\n      flyoutLock = !flyoutLock;\n      lockDisplay.src = _twGetAsset(`/${flyoutLock ? \"\" : \"un\"}lock.svg`);\n    };\n\n    // Only append if we don't have \"categoryclick\" on\n    if (toggleSetting === \"hover\") tabs.appendChild(lockDisplay);\n\n    if (toggleSetting === \"hover\") {\n      placeHolderDiv.onmouseenter = (e) => onmouseenter(e);\n      placeHolderDiv.onmouseup = (e) => onmouseenter();\n      document.querySelector(\".blocklyToolboxDiv\").onmouseenter = (e) => onmouseenter(e); // for columns\n      blocklySvg.onmouseenter = (e) => onmouseleave(e);\n    }\n\n    if (toggleSetting === \"cathover\") {\n      onmouseleave(null, 0);\n\n      const toolbox = document.querySelector(\".blocklyToolboxDiv\");\n      const addExtensionButton = document.querySelector(\"[class^=gui_extension-button-container_]\");\n\n      for (let e of [toolbox, addExtensionButton, flyOut, scrollBar]) {\n        e.onmouseenter = onmouseenter;\n        e.onmouseleave = onmouseleave;\n      }\n    }\n\n    doOneTimeSetup();\n  }\n}\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAhBA;AAkBA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}