(window.webpackJsonpGUI=window.webpackJsonpGUI||[]).push([[17],{1574:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));class s{constructor(e,t){this.targetId=e.id,this.id=t.id}}},1576:function(e,t,n){"use strict";t.a=(e,t)=>{const n=document.createElement("a");if(document.body.appendChild(n),navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t,e);else if("download"in HTMLAnchorElement.prototype){const s=window.URL.createObjectURL(t);n.href=s,n.download=e,n.type=t.type,n.click(),window.setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(s)},1e3)}else{let e=window.open("","_blank");const n=new FileReader;n.onloadend=function(){e.location.href=n.result,e=null},n.readAsDataURL(t)}}},1577:function(e,t,n){"use strict";const s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg");o.style.position="fixed",o.style.top="-999999px",o.style.width="0",o.style.height="0",document.body.appendChild(o);let i=0;const a=new WeakMap,r=e=>(a.get(e)||a.set(e,new Set),a.get(e)),c=(e,t)=>{let n;for(const e of t)(!n||e.priority>n.priority)&&(n=e);e.style.filter=n?n.filter:""},d=(e,t)=>{const n=r(e);n.add(t),c(e,n)},g=(e,t)=>{const n=r(e);n.delete(t),c(e,n)};t.a=class{constructor(e,t){this.priority=e;const n="sa_glower_filter".concat(i++);this.filter='url("#'.concat(n,'")'),this.previousElements=new Set;const a=document.createElementNS(s,"filter");a.id=n,a.setAttribute("width","180%"),a.setAttribute("height","160%"),a.setAttribute("x","-40%"),a.setAttribute("y","-30%");const r=document.createElementNS(s,"feGaussianBlur");r.setAttribute("in","SourceGraphic"),r.setAttribute("stdDeviation","4"),a.appendChild(r);const c=document.createElementNS(s,"feComponentTransfer");c.setAttribute("result","outBlur"),a.appendChild(c);const d=document.createElementNS(s,"feFuncA");d.setAttribute("type","table"),d.setAttribute("tableValues","0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"),c.appendChild(d);const g=document.createElementNS(s,"feFlood");g.setAttribute("flood-opacity","1"),g.setAttribute("result","outColor"),a.appendChild(g),this.filterFlood=g;const l=document.createElementNS(s,"feComposite");l.setAttribute("in","outColor"),l.setAttribute("in2","outBlur"),l.setAttribute("operator","in"),l.setAttribute("result","outGlow"),a.appendChild(l);const u=document.createElementNS(s,"feComposite");u.setAttribute("in","SourceGraphic"),u.setAttribute("in2","outGlow"),u.setAttribute("operator","over"),a.appendChild(u),o.appendChild(a),this.setColor(t)}setColor(e){this.filterFlood.setAttribute("flood-color",e)}setGlowingThreads(e){const t=new Set,n=Blockly.getMainWorkspace();if(n)for(const s of e)s.stack.forEach(e=>{const o=n.getBlockById(e);if(!o)return;if(!s.stack.find(e=>{let t=o;for(;t.childBlocks_.length;)if(t=t.childBlocks_[t.childBlocks_.length-1],e===t.id)return!0;return!1})&&o.svgPath_){const e=o.svgPath_;t.add(e)}});for(const e of this.previousElements)t.has(e)||g(e,this);for(const e of t)this.previousElements.has(e)||d(e,this);this.previousElements=t}}},1581:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(1574);const o={block:null,timerID:null};class i{constructor(e){this.addon=e,this.addon.tab.traps.getBlockly().then(e=>{this.blockly=e}),this.vm=this.addon.tab.traps.vm,this.offsetX=32,this.offsetY=32,this.navigationHistory=new a(this),this._workspace=null}getEditingTarget(){return this.vm.runtime.getEditingTarget()}setEditingTarget(e){this.getEditingTarget().id!==e&&this.vm.setEditingTarget(e)}getWorkspace(){const e=Blockly.getMainWorkspace();return e.getToolbox()&&(this._workspace=e),this._workspace}scrollBlockIntoView(e){var t;let n,i=this.getWorkspace();if(e instanceof s.a?(this.setEditingTarget(e.targetId),n=i.getBlockById(e.id)):n=e&&e.id?e:i.getBlockById(e),!n)return;let a=n.getRootBlock(),r=this.getTopOfStackFor(n).getRelativeToSurfaceXY(),c=a.getRelativeToSurfaceXY(),d=i.scale,g=c.x*d,l=r.y*d,u=n.width+g,h=n.height+l,m=i.getMetrics();if(g<m.viewLeft+this.offsetX-4||u>m.viewLeft+m.viewWidth||l<m.viewTop+this.offsetY-4||h>m.viewTop+m.viewHeight){let e=g-m.contentLeft-this.offsetX,t=l-m.contentTop-this.offsetY;this.navigationHistory.storeView(this.navigationHistory.peek(),64),i.scrollbar.set(e,t),this.navigationHistory.storeView({left:e,top:t},64)}null===(t=this.blockly)||void 0===t||t.hideChaff(),class{static flash(e){o.timerID>0&&(clearTimeout(o.timerID),o.block.svgPath_&&(o.block.svgPath_.style.fill=""));let t=4,n=!0;o.block=e,function e(){o.block.svgPath_&&(o.block.svgPath_.style.fill=n?"#ffff80":""),n=!n,t--,t>0?o.timerID=setTimeout(e,200):(o.timerID=0,o.block=null)}()}}.flash(n)}getTopOfStackFor(e){let t=e;for(;t.getOutputShape()&&t.getSurroundParent();)t=t.getSurroundParent();return t}}class a{constructor(e){this.utils=e,this.views=[],this.forward=[]}storeView(e,t){this.forward=[];let n=this.utils.getWorkspace().getMetrics(),s={left:n.viewLeft,top:n.viewTop};(!e||r(s,e)>t)&&this.views.push(s)}peek(){return this.views.length>0?this.views[this.views.length-1]:null}goBack(){const e=this.utils.getWorkspace(),t=e.getMetrics();let n={left:t.viewLeft,top:t.viewTop},s=this.peek();if(!s)return;if(r(n,s)<64&&this.views.length>1&&(this.views.pop(),this.forward.push(s)),s=this.peek(),!s)return;let o=s.left-t.contentLeft,i=s.top-t.contentTop;e.scrollbar.set(o,i)}goForward(){let e=this.forward.pop();if(!e)return;this.views.push(e);let t=this.utils.getWorkspace(),n=t.getMetrics(),s=e.left-n.contentLeft,o=e.top-n.contentTop;t.scrollbar.set(s,o)}}function r(e,t){return Math.sqrt(Math.pow(e.left-t.left,2)+Math.pow(e.top-t.top,2))}},1634:function(e,t,n){var s=n(210);(e.exports=n(9)(!1)).push([e.i,'[dir="ltr"] .sa-debugger-container {\n  margin-right: 0.2rem;\n}\n\n[dir="rtl"] .sa-debugger-container {\n  margin-left: 0.2rem;\n}\n\n.sa-debugger-small .sa-debugger-container {\n  display: none !important;\n}\n\n.sa-debugger-interface {\n  display: none;\n  position: absolute;\n  z-index: 492;\n  background-color: white;\n  width: 565px;\n  height: 25rem;\n}\n[theme="dark"] .sa-debugger-interface {\n  background: var(--ui-primary);\n}\n\n.sa-debugger-interface h1 {\n  padding: 10px;\n  z-index: 10;\n  width: calc(100% - 20px);\n  font-size: 20px;\n}\n\n.sa-debugger-tabs {\n  margin: 0;\n  display: flex;\n  align-items: center;\n  padding: 0 15px;\n  font-size: 0.75rem;\n}\n.sa-debugger-tabs li {\n  margin: 0;\n  display: flex;\n  align-items: center;\n  padding: 0.5em 1em;\n  background-color: rgba(0, 0, 0, 0.1);\n  border: 1px solid rgba(0, 0, 0, 0.15);\n  border-radius: 1rem;\n  color: white;\n  cursor: pointer;\n}\n.sa-debugger-tabs li + li {\n  margin-inline-start: 10px;\n}\n.sa-debugger-tabs li:hover {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n.sa-debugger-tabs li.sa-debugger-tab-selected {\n  background-color: white;\n  background-clip: padding-box;\n  border-color: rgba(0, 0, 0, 0.25);\n  color: #4d97ff;\n}\n.sa-debugger-tabs li img {\n  margin: 0;\n  margin-right: 0.25rem;\n  width: 1rem;\n  filter: brightness(0) invert(1);\n}\n.sa-debugger-tabs li.sa-debugger-tab-selected img {\n  filter: none;\n}\n\n.sa-debugger-header-buttons img {\n  width: 20px;\n  height: 20px;\n}\n\n.sa-debugger-unpause {\n  animation: saDebuggerUnpause 2s infinite alternate;\n}\n\n@keyframes saDebuggerUnpause {\n  0% {\n    background-color: rgba(0, 0, 0, 0.15);\n  }\n  100% {\n    background-color: rgba(0, 0, 0, 0);\n  }\n}\n\n.sa-debugger-tab-content {\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n  cursor: auto;\n}\n\n.sa-debugger-chart {\n  width: 100%;\n  height: 100%;\n}\n\n.sa-performance-tab-content {\n  padding: 15px;\n}\n\n.sa-debugger-log-outer {\n  height: 100%;\n}\n\n.sa-debugger-log-inner {\n  position: relative;\n  overflow-y: auto;\n  font-size: 12px;\n  line-height: 1.2;\n  height: 100%;\n  contain: strict;\n}\n\n.sa-debugger-log-empty {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  font-size: 20px;\n  font-style: italic;\n}\n\n.sa-debugger-log-end {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 1px;\n}\n\n.sa-debugger-log {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 20px;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.15);\n  padding-left: 4px;\n  font-family: monospace;\n  color: #000;\n}\n[theme="dark"] .sa-debugger-log {\n  color: var(--text-primary);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n.sa-debugger-log[data-type="warn"] {\n  border-color: hsl(50deg, 100%, 75%);\n  color: hsl(39deg 100% 18%);\n  background-color: hsl(50deg 100% 95%);\n}\n.sa-debugger-log[data-type="error"] {\n  border-color: hsl(0deg 100% 92%);\n  color: red;\n  background-color: hsl(0deg 100% 95%);\n}\n[theme="dark"] .sa-debugger-log[data-type="warn"] {\n  border-color: hsl(50deg, 100%, 15%);\n  color: hsl(39deg 100% 90%);\n  background-color: hsl(50deg 100% 10%);\n}\n[theme="dark"] .sa-debugger-log[data-type="error"] {\n  border-color: hsl(0deg 100% 15%);\n  color: hsl(0deg 100% 77%);\n  background-color: hsl(0deg 100% 10%);\n}\n\n.sa-debugger-log-repeats {\n  background-color: hsla(163, 85%, 40%, 1);\n  color: white;\n  border-radius: 100px;\n  padding: 1px 6px;\n  margin-right: 4px;\n}\n[theme="dark"] .sa-debugger-log-repeats {\n  color: var(--ui-primary);\n}\n\n.sa-debugger-log-icon {\n  width: 16px;\n  height: 16px;\n  margin-right: 4px;\n}\n[data-type="warn"] .sa-debugger-log-icon {\n  background-image: url('+s(n(1635))+');\n}\n[data-type="error"] .sa-debugger-log-icon {\n  background-image: url('+s(n(1636))+");\n}\n.sa-debugger-threads .sa-debugger-log-icon {\n  background-image: url("+s(n(1637))+');\n}\n\n.sa-debugger-log-link {\n  color: inherit;\n  cursor: pointer;\n  opacity: 0.5;\n  text-decoration: underline;\n  float: right;\n  text-align: right;\n  max-width: 100%;\n  padding-left: 4px;\n  margin-right: 4px;\n  margin-left: auto;\n}\n[theme="dark"] .sa-debugger-log-link {\n  color: inherit;\n}\n.sa-debugger-log-link:hover {\n  text-decoration: underline;\n  color: #4d97ff;\n  opacity: 1;\n}\n.sa-debugger-log-link-unknown {\n  pointer-events: none;\n}\n\n.sa-debugger-log-text {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: pre;\n}\n.sa-debugger-log-text-empty {\n  font-style: italic;\n}\n.sa-debugger-log-internal .sa-debugger-log-text {\n  font-style: italic;\n}\n\n.sa-debugger-thread-indent {\n  width: calc(16px * var(--level));\n  margin-right: 4px;\n}\n.sa-debugger-thread-title .sa-debugger-thread-indent {\n  margin: 0;\n}\n.sa-debugger-thread-target-name {\n  font-weight: bold;\n  margin-right: 8px;\n}\n.sa-debugger-thread-running {\n  background-color: rgba(255, 187, 0, 0.233);\n  font-weight: bold;\n}\n\n.sa-debugger-block-preview {\n  color: white;\n  padding: 1px 6px;\n  margin-right: 4px;\n}\n.sa-debugger-block-preview[data-shape="round"] {\n  border-radius: 100px;\n}\n.sa-debugger-block-preview[data-shape="stacked"] {\n  border-radius: 3px;\n}\n\n.sa-debugger-thread-compiled {\n  font-style: italic;\n}\n\n.sa-debugger-compiler-warning {\n  position: relative;\n  display: block;\n  text-align: center;\n  height: 24px;\n  color: #2121bf;\n}\n.sa-debugger-compiler-warning[hidden] {\n  display: none;\n}\n[theme="dark"] .sa-debugger-compiler-warning {\n  color: #bdbdf9;\n}\n',""])},1635:function(e,t,n){e.exports=n.p+"static/assets/0e009d6e684951615b31a267baa37636.svg"},1636:function(e,t,n){e.exports=n.p+"static/assets/76b6cb627b95d79705c0b41664064f0e.svg"},1637:function(e,t,n){e.exports=n.p+"static/assets/c846a442121113b1d04f6b9d50912038.svg"},1679:function(e,t,n){"use strict";n.r(t),n.d(t,"resources",(function(){return C}));var s="data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcuNDggNy40OCIgc3R5bGU9InRyYW5zZm9ybTpyb3RhdGUoNDVkZWcpIj48cGF0aCBkPSJNMy43NCA2LjQ4VjFNMSAzLjc0aDUuNDgiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNmZmY7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS13aWR0aDoycHgiLz48L3N2Zz4=",o="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgc3Ryb2tlPSIjNEM5N0ZGIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MTtwYWludC1vcmRlcjptYXJrZXJzIHN0cm9rZSBmaWxsIiBkPSJNNCAzLjVjLS44MzEgMC0xLjUuNjY5LTEuNSAxLjV2MTBjMCAuODMxLjY2OSAxLjUgMS41IDEuNWgxMmMuODMxIDAgMS41LS42NjkgMS41LTEuNVY1YzAtLjgzMS0uNjY5LTEuNS0xLjUtMS41Wm0wIDFoMTJjLjI3NyAwIC41LjIyMy41LjV2MTBjMCAuMjc3LS4yMjMuNS0uNS41SDRhLjQ5OS40OTkgMCAwIDEtLjUtLjVWNWMwLS4yNzcuMjIzLS41LjUtLjVaIiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJtNS40MTcgNy41IDMuNzUgMi41LTMuNzUgMi41bTUgMGg0LjE2NiIgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzhmOGY4ZjtzdHJva2Utd2lkdGg6MTtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIi8+PC9nPjxjaXJjbGUgZmlsbD0iIzRDOTdGRiIgY3g9IjE2IiBjeT0iNCIgcj0iMyIvPjwvc3ZnPg==",i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgc3Ryb2tlPSIjNEM5N0ZGIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MTtwYWludC1vcmRlcjptYXJrZXJzIHN0cm9rZSBmaWxsIiBkPSJNNCAzLjVjLS44MzEgMC0xLjUuNjY5LTEuNSAxLjV2MTBjMCAuODMxLjY2OSAxLjUgMS41IDEuNWgxMmMuODMxIDAgMS41LS42NjkgMS41LTEuNVY1YzAtLjgzMS0uNjY5LTEuNS0xLjUtMS41Wm0wIDFoMTJjLjI3NyAwIC41LjIyMy41LjV2MTBjMCAuMjc3LS4yMjMuNS0uNS41SDRhLjQ5OS40OTkgMCAwIDEtLjUtLjVWNWMwLS4yNzcuMjIzLS41LjUtLjVaIiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJtNS40MTcgNy41IDMuNzUgMi41LTMuNzUgMi41bTUgMGg0LjE2NiIgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzhmOGY4ZjtzdHJva2Utd2lkdGg6MTtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIi8+PC9nPjwvc3ZnPg==",a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik00LjU0OCA3aDEwLjkwNGEuNS41IDAgMCAxIC40OTguNTQ1bC0uNzg1IDguNjM1QTIgMiAwIDAgMSAxMy4xNzQgMThINi44MjdhMiAyIDAgMCAxLTEuOTkyLTEuODJMNC4wNSA3LjU0NkEuNS41IDAgMCAxIDQuNTQ4IDd6bTIuNzg1LTMgLjU1My0xLjY1OEEuNS41IDAgMCAxIDguMzYgMmgzLjI4YS41LjUgMCAwIDEgLjQ3NC4zNDJMMTIuNjY3IDRIMTYuNWEuNS41IDAgMCAxIC41LjV2MWEuNS41IDAgMCAxLS41LjVoLTEzYS41LjUgMCAwIDEtLjUtLjV2LTFhLjUuNSAwIDAgMSAuNS0uNWgzLjgzM3ptMS4wNTQgMGgzLjIyNmwtLjMzNC0xSDguNzIxbC0uMzM0IDF6TTEwIDExLjcybDEuNTk1LTEuNTk1YS41LjUgMCAwIDEgLjcwNyAwbC4wNzMuMDczYS41LjUgMCAwIDEgMCAuNzA3TDEwLjc4IDEyLjVsMS41OTUgMS41OTVhLjUuNSAwIDAgMSAwIC43MDdsLS4wNzMuMDczYS41LjUgMCAwIDEtLjcwNyAwTDEwIDEzLjI4bC0xLjU5NSAxLjU5NWEuNS41IDAgMCAxLS43MDcgMGwtLjA3My0uMDczYS41LjUgMCAwIDEgMC0uNzA3TDkuMjIgMTIuNWwtMS41OTUtMS41OTVhLjUuNSAwIDAgMSAwLS43MDdsLjA3My0uMDczYS41LjUgMCAwIDEgLjcwNyAwTDEwIDExLjcyeiIgaWQ9ImEiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48ZyBtYXNrPSJ1cmwoI2IpIiBmaWxsPSIjRkZGIj48cGF0aCBkPSJNMCAwaDIwdjIwSDB6Ii8+PC9nPjwvZz48L3N2Zz4=",r="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTE0LjczIDguNzc5LTQuMjUzIDQuMjY0YS42MTkuNjE5IDAgMCAxLS44OSAwTDUuMzM2IDguNzc5QS42My42MyAwIDAgMSA1Ljc4OCA3LjdoMi4xMTdsMS4yNjMtNS4wMTZhLjkxMi45MTIgMCAwIDEgMS4xMDYtLjY1Ni44OS44OSAwIDAgMSAuNjY4LjY1NkwxMi4yMDYgNy43aDIuMDcyYy41NTkgMCAuODU2LjY3LjQ1MSAxLjA3OHpNMTggMTEuODEydjIuNTc5QzE4IDE2LjM3NSAxNi4zOTUgMTggMTQuNDE3IDE4SDUuNkEzLjYwNyAzLjYwNyAwIDAgMSAyIDE0LjM5di0yLjU3OGExLjE3IDEuMTcgMCAxIDEgMi4zMzcgMHYyLjU3OUExLjI3IDEuMjcgMCAwIDAgNS42IDE1LjY1Nmg4LjgxN2MuNjg2IDAgMS4yNDYtLjU3OCAxLjI0Ni0xLjI2NXYtMi41NzljMC0uNjU2LjUzLTEuMTcyIDEuMTY5LTEuMTcyLjY1NCAwIDEuMTY4LjUxNiAxLjE2OCAxLjE3MnoiIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==",c="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTEyIDE0YTEuMjUgMS4yNSAwIDEgMCAxLjI1IDEuMjVBMS4yNSAxLjI1IDAgMCAwIDEyIDE0em0wLTEuNWExIDEgMCAwIDAgMS0xdi0zYTEgMSAwIDAgMC0yIDB2M2ExIDEgMCAwIDAgMSAxek0xMiAyYTEwIDEwIDAgMSAwIDEwIDEwQTEwLjAxMSAxMC4wMTEgMCAwIDAgMTIgMnptMCAxOGE4IDggMCAxIDEgOC04IDguMDEgOC4wMSAwIDAgMS04IDh6IiBmaWxsPSJyZWQiLz48L3N2Zz4=",d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTMgN2gxOGExIDEgMCAwIDAgMC0ySDNhMSAxIDAgMCAwIDAgMnptMCA0aDE0YTEgMSAwIDAgMCAwLTJIM2ExIDEgMCAwIDAgMCAyem0xOCAySDNhMSAxIDAgMCAwIDAgMmgxOGExIDEgMCAwIDAgMC0yem0tNCA0SDNhMSAxIDAgMCAwIDAgMmgxNGExIDEgMCAwIDAgMC0yeiIgZmlsbD0iIzRjOTdmZiIvPjwvc3ZnPg==",g="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyNCAyNCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiPjxwYXRoIHN0cm9rZT0iIzRjOTdmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik05IDE5di02YTIgMiAwIDAgMC0yLTJINWEyIDIgMCAwIDAtMiAydjZhMiAyIDAgMCAwIDIgMmgyYTIgMiAwIDAgMCAyLTJ6bTAgMFY5YTIgMiAwIDAgMSAyLTJoMmEyIDIgMCAwIDEgMiAydjEwbS02IDBhMiAyIDAgMCAwIDIgMmgyYTIgMiAwIDAgMCAyLTJtMCAwVjVhMiAyIDAgMCAxIDItMmgyYTIgMiAwIDAgMSAyIDJ2MTRhMiAyIDAgMCAxLTIgMmgtMmEyIDIgMCAwIDEtMi0yeiIvPjwvc3ZnPg==",l="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDkiIGhlaWdodD0iNTIiIHZpZXdCb3g9Ii01IDAgNDkgNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik0xNy4yMjEgOC4zNDVjMi41NTYtNC4yNTkgNi43MDItNC4yNTIgOS4yNTQgMGwxMy42NzcgMjIuNzk2YzIuNTU1IDQuMjU4LjU5NyA3LjcxLTQuMzggNy43MUg3LjkyNGMtNC45NzMgMC02LjkzLTMuNDU4LTQuMzgtNy43MUwxNy4yMjIgOC4zNDV6IiBpZD0iYSIvPjwvZGVmcz48dXNlIHN0cm9rZT0iI0ZGRiIgZmlsbD0iI0ZGRiIgeGxpbms6aHJlZj0iI2EiIHRyYW5zZm9ybT0icm90YXRlKDkwIDIwLjg1IDIzLjAwMykiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==",u="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkiIGhlaWdodD0iMTkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjIuNjggMTIuMmExLjYgMS42IDAgMCAxLTEuMjcuNjNoLTcuNjlhMS41OSAxLjU5IDAgMCAxLTEuMTYtMi41OGwxLjEyLTEuNDFhNC44MiA0LjgyIDAgMCAwLTMuMTQtLjc3IDQuMzEgNC4zMSAwIDAgMC0yIC44QTQuMjUgNC4yNSAwIDAgMCA3LjIgMTAuNmE1LjA2IDUuMDYgMCAwIDAgLjU0IDQuNjJBNS41OCA1LjU4IDAgMCAwIDEyIDE3Ljc0YTIuMjYgMi4yNiAwIDAgMS0uMTYgNC41MkExMC4yNSAxMC4yNSAwIDAgMSAzLjc0IDE4YTEwLjE0IDEwLjE0IDAgMCAxLTEuNDktOS4yMiA5LjcgOS43IDAgMCAxIDIuODMtNC4xNEE5LjkyIDkuOTIgMCAwIDEgOS42NiAyLjVhMTAuNjYgMTAuNjYgMCAwIDEgNy43MiAxLjY4bDEuMDgtMS4zNWExLjU3IDEuNTcgMCAwIDEgMS4yNC0uNiAxLjYgMS42IDAgMCAxIDEuNTQgMS4yMWwxLjcgNy4zN2ExLjU3IDEuNTcgMCAwIDEtLjI2IDEuMzlaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTIxLjM4IDExLjgzaC03LjYxYS41OS41OSAwIDAgMS0uNDMtMWwxLjc1LTIuMTlhNS45IDUuOSAwIDAgMC00LjctMS41OCA1LjA3IDUuMDcgMCAwIDAtNC4xMSAzLjE3QTYgNiAwIDAgMCA3IDE1Ljc3YTYuNTEgNi41MSAwIDAgMCA1IDIuOTIgMS4zMSAxLjMxIDAgMCAxLS4wOCAyLjYyIDkuMyA5LjMgMCAwIDEtNy4zNS0zLjgyIDkuMTYgOS4xNiAwIDAgMS0xLjQtOC4zN0E4LjUxIDguNTEgMCAwIDEgNS43MSA1LjRhOC43NiA4Ljc2IDAgMCAxIDQuMTEtMS45MiA5LjcxIDkuNzEgMCAwIDEgNy43NSAyLjA3bDEuNjctMi4xYS41OS41OSAwIDAgMSAxIC4yMUwyMiAxMS4wOGEuNTkuNTkgMCAwIDEtLjYyLjc1WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjwvc3ZnPg==",h="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTIwLjkyIDEyLjYyYTEgMSAwIDAgMC0uMjEtLjMzbC0zLTNhMSAxIDAgMCAwLTEuNDIgMS40MmwxLjMgMS4yOUg4YTEgMSAwIDAgMS0xLTFWN2ExIDEgMCAwIDAtMiAwdjRhMyAzIDAgMCAwIDMgM2g5LjU5bC0xLjMgMS4yOWExIDEgMCAwIDAgMCAxLjQyIDEgMSAwIDAgMCAxLjQyIDBsMy0zYTEgMSAwIDAgMCAuMjEtLjMzIDEgMSAwIDAgMCAwLS43NnoiIGZpbGw9ImdyYXkiLz48L3N2Zz4=",m="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTE5IDJIOWEzIDMgMCAwIDAtMyAzdjFINWEzIDMgMCAwIDAtMyAzdjEwYTMgMyAwIDAgMCAzIDNoMTBhMyAzIDAgMCAwIDMtM3YtMWgxYTMgMyAwIDAgMCAzLTNWNWEzIDMgMCAwIDAtMy0zem0tMyAxN2ExIDEgMCAwIDEtMSAxSDVhMSAxIDAgMCAxLTEtMXYtN2gxMnptMC05SDRWOWExIDEgMCAwIDEgMS0xaDEwYTEgMSAwIDAgMSAxIDF6bTQgNWExIDEgMCAwIDEtMSAxaC0xVjlhMyAzIDAgMCAwLS4xOC0xSDIwem0wLTlIOFY1YTEgMSAwIDAgMSAxLTFoMTBhMSAxIDAgMCAxIDEgMXoiIGZpbGw9IiM0Yzk3ZmYiLz48L3N2Zz4=",M="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTEyIDE2YTEgMSAwIDEgMCAxIDEgMSAxIDAgMCAwLTEtMXptMTAuNjcgMS40Ny04LjA1LTE0YTMgMyAwIDAgMC01LjI0IDBsLTggMTRBMyAzIDAgMCAwIDMuOTQgMjJoMTYuMTJhMyAzIDAgMCAwIDIuNjEtNC41M3ptLTEuNzMgMmExIDEgMCAwIDEtLjg4LjUxSDMuOTRhMSAxIDAgMCAxLS44OC0uNTEgMSAxIDAgMCAxIDAtMWw4LTE0YTEgMSAwIDAgMSAxLjc4IDBsOC4wNSAxNGExIDEgMCAwIDEgLjA1IDEuMDJ6TTEyIDhhMSAxIDAgMCAwLTEgMXY0YTEgMSAwIDAgMCAyIDBWOWExIDEgMCAwIDAtMS0xeiIgZmlsbD0iI2UwYmIwMCIvPjwvc3ZnPg==",I=n(1573),b=n(1576);const p=(e,t,n)=>Math.max(t,Math.min(n,e)),w=(e,t)=>{const n=+t.dataset.index;let s=!1;for(const o of e.children){if(+o.dataset.index>n){s=!0,e.insertBefore(t,o);break}}s||e.appendChild(t)};var A=class{constructor(){this.rows=[],this.canAutoScrollToEnd=!0,this.rowHeight=20,this.outerElement=document.createElement("div"),this.outerElement.className="sa-debugger-log-outer",this.innerElement=document.createElement("div"),this.innerElement.className="sa-debugger-log-inner",this.outerElement.appendChild(this.innerElement),this.innerElement.addEventListener("scroll",this._handleScroll.bind(this),{passive:!0}),this.innerElement.addEventListener("wheel",this._handleWheel.bind(this),{passive:!0}),this.endElement=document.createElement("div"),this.endElement.className="sa-debugger-log-end",this.endElement.dataset.index="-1",this.innerElement.appendChild(this.endElement),this.placeholderElement=document.createElement("div"),this.placeholderElement.className="sa-debugger-log-empty",this.visible=!1,this.isScrolledToEnd=!0,this.scrollTopWhenHidden="end",this.scrollTop=0,this.updateContentQueued=!1,this.scrollToEndQueued=!1,this.oldLength=-1,this.rowToMetadata=new Map}append(e){this.queueUpdateContent(),this._queueScrollToEnd(),this.rows.push(e);for(;this.rows.length>2e5;)this.rows.shift()}clear(){this.rows.length=0,this.scrollTop=0,this.isScrolledToEnd=!0,this.queueUpdateContent()}show(){this.visible=!0,this.height=this.innerElement.offsetHeight,this.queueUpdateContent(),"end"===this.scrollTopWhenHidden?this._queueScrollToEnd():this.innerElement.scrollTop=this.scrollTopWhenHidden}hide(){this.visible=!1,this.scrollTopWhenHidden=this.isScrolledToEnd?"end":this.scrollTop}_handleScroll(e){this.scrollTop=e.target.scrollTop,this.isScrolledToEnd=e.target.scrollTop+5>=e.target.scrollHeight-e.target.clientHeight,this.queueUpdateContent()}_handleWheel(e){e.deltaY<0&&(this.isScrolledToEnd=!1)}scrollIntoView(e){const t=e*this.rowHeight,n=this.scrollTop,s=this.scrollTop+this.height;t>n&&t<s||(this.scrollTop=t,this.innerElement.scrollTop=t)}_queueScrollToEnd(){this.visible&&this.canAutoScrollToEnd&&this.isScrolledToEnd&&!this.scrollToEndQueued&&(this.scrollToEndQueued=!0,queueMicrotask(()=>{if(this.scrollToEndQueued=!1,this.isScrolledToEnd){const e=this.innerElement.scrollHeight-this.innerElement.offsetHeight;this.innerElement.scrollTop=e,this.scrollTop=e}}))}queueUpdateContent(){this.visible&&!this.updateContentQueued&&(this.updateContentQueued=!0,queueMicrotask(()=>{this.updateContentQueued=!1,this.updateContent()}))}generateRow(e){}renderRow(e,t){}updateContent(){if(this.rows.length!==this.oldLength){this.oldLength=this.rows.length;const e=this.rows.length*this.rowHeight;if(this.endElement.style.transform="translateY(".concat(e,"px)"),this.rows.length)this.placeholderElement.remove();else{this.innerElement.appendChild(this.placeholderElement);for(const e of this.rowToMetadata.values())e.elements.root.remove();this.rowToMetadata.clear()}}if(0===this.rows.length)return;const e=Math.floor(this.scrollTop/this.rowHeight),t=Math.ceil(this.height/this.rowHeight),n=p(e-5,0,this.rows.length),s=p(e+t+5,0,this.rows.length),o=new Set,i=[];for(let e=n;e<s;e++){const t=this.rows[e];o.add(t);let n=this.rowToMetadata.get(t);if(!n){const e=this.generateRow(t);i.push(e.root),n={stringify:null,elements:e},this.rowToMetadata.set(t,n)}const s=JSON.stringify(t);s!==n.stringify&&(n.stringify=s,this.renderRow(n.elements,t));const a=n.elements.root;a.style.transform="translateY(".concat(e*this.rowHeight,"px)"),a.dataset.index=e}for(const[e,t]of this.rowToMetadata.entries())o.has(e)||(t.elements.root.remove(),this.rowToMetadata.delete(e));for(const e of i)w(this.innerElement,e)}};const y=e=>{if("/icons/close.svg"===e)return s;if("/icons/debug-unread.svg"===e)return o;if("/icons/debug.svg"===e)return i;if("/icons/delete.svg"===e)return a;if("/icons/download-white.svg"===e)return r;if("/icons/error.svg"===e)return c;if("/icons/logs.svg"===e)return d;if("/icons/performance.svg"===e)return g;if("/icons/play.svg"===e)return l;if("/icons/step.svg"===e)return u;if("/icons/subthread.svg"===e)return h;if("/icons/threads.svg"===e)return m;if("/icons/warning.svg"===e)return M;throw new Error("Unknown asset: ".concat(e))};async function D({debug:e,addon:t,console:n,msg:s}){const o=t.tab.traps.vm,i=e.createHeaderTab({text:s("tab-logs"),icon:y("/icons/logs.svg")}),a=new A;a.placeholderElement.textContent=s("no-logs");a.generateRow=t=>{const n=document.createElement("div");n.className="sa-debugger-log",t.internal&&n.classList.add("sa-debugger-log-internal"),n.dataset.type=t.type;const i=document.createElement("div");i.className="sa-debugger-log-icon","warn"!==t.type&&"error"!==t.type||(i.title=s("icon-"+t.type)),n.appendChild(i);const a=document.createElement("div");if(a.className="sa-debugger-log-repeats",a.style.display="none",n.appendChild(a),t.preview&&t.blockId&&t.targetInfo){const s=t.targetInfo.originalId,i=((t,n)=>{var s;const i=o.runtime.getTargetById(t);if(!i)return null;const a=e.getBlock(i,n);return a?null===(s=Object.values(a.inputs)[0])||void 0===s?void 0:s.block:null})(s,t.blockId);if(i){const t=e.createBlockPreview(s,i);t&&n.appendChild(t)}}const r=document.createElement("div");return r.className="sa-debugger-log-text",0===t.text.length?(r.classList.add("sa-debugger-log-text-empty"),r.textContent=s("empty-string")):(r.textContent=t.text,r.title=t.text),n.appendChild(r),t.targetInfo&&t.blockId&&n.appendChild(e.createBlockLink(t.targetInfo,t.blockId)),{root:n,repeats:a}},a.renderRow=(e,t)=>{const{repeats:n}=e;t.count>1&&(n.style.display="",n.textContent=t.count)};const r=e.createHeaderButton({text:s("export"),icon:y("/icons/download-white.svg"),description:s("export-desc")});r.element.addEventListener("click",async e=>{const n=e.shiftKey?await t.tab.prompt(s("export"),s("enter-format"),"{sprite}: {content} ({type})",{useEditorClasses:!0}):"{sprite}: {content} ({type})";if(!n)return;const o=a.rows.map(({text:e,targetInfo:t,type:o,count:i})=>(n.replace(/\{(sprite|type|content)\}/g,(n,i)=>({sprite:t?t.name:s("unknown-sprite"),type:o,content:e}[i]))+"\n").repeat(i)).join("");var i,r;i="logs.txt",r=o,Object(b.a)(i,new Blob([r],{type:"text/plain"}))});const c=e.createHeaderButton({text:s("clear"),icon:y("/icons/delete.svg")});c.element.addEventListener("click",()=>{d()});const d=()=>{a.clear()};return{tab:i,content:a.outerElement,buttons:[r,c],show:()=>{a.show(),e.setHasUnreadMessage(!1)},hide:()=>{a.hide()},addLog:(t,n,s)=>{const o={text:t,type:s,count:1,preview:!0};if(n){o.blockId=n.peekStack();const t=n.target.id;o.targetId=t,o.targetInfo=e.getTargetInfoById(t)}"internal"===s&&(o.internal=!0,o.preview=!1,o.type="log"),"internal-warn"===s&&(o.internal=!0,o.type="warn");const i=a.rows[a.rows.length-1];var r,c;i&&(c=i,(r=o).text===c.text&&r.type===c.type&&r.internal===c.internal&&r.blockId===c.blockId&&r.targetId===c.targetId)?(i.count++,a.queueUpdateContent()):a.append(o),a.visible||o.internal||e.setHasUnreadMessage(!0)},clearLogs:d}}var N=n(1577);const E=e=>{if("/icons/close.svg"===e)return s;if("/icons/debug-unread.svg"===e)return o;if("/icons/debug.svg"===e)return i;if("/icons/delete.svg"===e)return a;if("/icons/download-white.svg"===e)return r;if("/icons/error.svg"===e)return c;if("/icons/logs.svg"===e)return d;if("/icons/performance.svg"===e)return g;if("/icons/play.svg"===e)return l;if("/icons/step.svg"===e)return u;if("/icons/subthread.svg"===e)return h;if("/icons/threads.svg"===e)return m;if("/icons/warning.svg"===e)return M;throw new Error("Unknown asset: ".concat(e))},L=(e,t)=>{for(const n of t)e.push(n)};async function x({debug:e,addon:t,console:n,msg:s}){const o=t.tab.traps.vm,i=e.createHeaderTab({text:s("tab-threads"),icon:E("/icons/threads.svg")}),a=new A;a.canAutoScrollToEnd=!1,a.outerElement.classList.add("sa-debugger-threads"),a.placeholderElement.textContent=s("no-threads-running");const r=new N.a(10,"#ff0000");a.generateRow=t=>{const n=document.createElement("div");n.className="sa-debugger-log";const o="thread-header"===t.type,i=document.createElement("div");if(i.className="sa-debugger-thread-indent",i.style.setProperty("--level",o?t.depth:t.depth+1),n.appendChild(i),o){if(n.classList.add("sa-debugger-thread-title"),t.depth>0){const e=document.createElement("div");e.className="sa-debugger-log-icon",n.appendChild(e)}const e=document.createElement("div");e.textContent=t.targetName,e.className="sa-debugger-thread-target-name",n.appendChild(e);const o=document.createElement("div");o.className="sa-debugger-thread-id",o.textContent=s("thread",{id:t.id}),n.appendChild(o)}if("thread-stack"===t.type){const s=e.createBlockPreview(t.targetId,t.blockId);s&&n.appendChild(s)}if("compiled"===t.type){const e=document.createElement("div");e.className="sa-debugger-thread-compiled",e.textContent="Compiled threads can't be stepped and have no stack information.",n.appendChild(e)}return t.targetId&&t.blockId&&n.appendChild(e.createBlockLink(e.getTargetInfoById(t.targetId),t.blockId)),{root:n}},a.renderRow=(e,t)=>{const{root:n}=e;n.classList.toggle("sa-debugger-thread-running",!!t.running)};let c=new WeakMap;const d=new WeakMap;let g=1;const l=()=>{if(!a.visible)return;const t=[],n=o.runtime.threads,s=new Set,i=(t,n)=>{if(s.has(t))return[];s.add(t);const o=(e=>(d.has(e)||d.set(e,g++),d.get(e)))(t),a=t.target;c.has(t)||c.set(t,{headerItem:{type:"thread-header",depth:n,targetName:a.getName(),id:o},compiledItem:t.isCompiled?{type:"compiled",depth:1}:null,blockCache:new WeakMap});const r=c.get(t),l=Object(I.a)(),u=(e,s)=>{const o=e.id;if(!e)return;const c=t.stackFrames[s];r.blockCache.has(e)||r.blockCache.set(e,{});const d=r.blockCache.get(e);let g=d[s];g||(g=d[s]={type:"thread-stack",depth:n,targetId:a.id,blockId:o}),g.running=t===l&&(t.isCompiled||o===l.peekStack()&&s===l.stackFrames.length-1);const u=[g];if(c&&c.executionContext&&c.executionContext.startedThreads)for(const e of c.executionContext.startedThreads)L(u,i(e,n+1));return u},h=e.getBlock(t.target,t.topBlock),m=[r.headerItem];if(h){L(m,u(h,0));for(let n=0;n<t.stack.length;n++){const s=t.stack[n];if(s===h.id)continue;const o=e.getBlock(t.target,s);o&&L(m,u(o,n))}}return r.compiledItem&&m.push(r.compiledItem),m};for(let e=0;e<n.length;e++){const s=n[e];s.updateMonitor||L(t,i(s,0))}a.rows=t,a.queueUpdateContent()};e.addAfterStepCallback(()=>{l();const e=Object(I.a)();e?r.setGlowingThreads([e]):r.setGlowingThreads([])});const u=e.createHeaderButton({text:s("step"),icon:E("/icons/step.svg"),description:s("step-desc")});u.element.addEventListener("click",()=>{Object(I.g)()});const h=e=>{u.element.style.display=e?"":"none",l()};h(Object(I.b)()),Object(I.c)(h),Object(I.d)(l);return{tab:i,content:a.outerElement,buttons:[u],show:()=>{a.show(),l()},hide:()=>{a.hide()}}}var v=n(1581);const j=e=>{if("/icons/close.svg"===e)return s;if("/icons/debug-unread.svg"===e)return o;if("/icons/debug.svg"===e)return i;if("/icons/delete.svg"===e)return a;if("/icons/download-white.svg"===e)return r;if("/icons/error.svg"===e)return c;if("/icons/logs.svg"===e)return d;if("/icons/performance.svg"===e)return g;if("/icons/play.svg"===e)return l;if("/icons/step.svg"===e)return u;if("/icons/subthread.svg"===e)return h;if("/icons/threads.svg"===e)return m;if("/icons/warning.svg"===e)return M;throw new Error("Unknown asset: ".concat(e))},f=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)};var T=n(1634);const C={"userscript.js":async function({addon:e,global:t,console:n,msg:s}){let o;Object(I.f)(e.tab.traps.vm);const i=[],a=(...e)=>{o?o.addLog(...e):i.push(e)};let r=!1;e.tab.addBlock("​​breakpoint​​",{args:[],displayName:s("block-breakpoint"),callback:(t,n)=>{e.tab.redux.state.scratchGui.mode.isPlayerOnly?r||(a(s("cannot-pause-player"),n,"error"),r=!0):(Object(I.e)(!0),E(!0))}}),e.tab.addBlock("​​log​​ %s",{args:["content"],displayName:s("block-log"),callback:({content:e},t)=>{a(e,t,"log")}}),e.tab.addBlock("​​warn​​ %s",{args:["content"],displayName:s("block-warn"),callback:({content:e},t)=>{a(e,t,"warn")}}),e.tab.addBlock("​​error​​ %s",{args:["content"],displayName:s("block-error"),callback:({content:e},t)=>{a(e,t,"error")}});const c=e.tab.traps.vm;await new Promise((e,t)=>{if(c.editingTarget)return e();c.runtime.once("PROJECT_LOADED",e)});const d=await e.tab.traps.getBlockly(),g=document.createElement("div");g.className="sa-debugger-container";const l=document.createElement("div");l.className=e.tab.scratchClass("button_outlined-button","stage-header_stage-button");const u=document.createElement("div");u.className=e.tab.scratchClass("button_content");const h=document.createElement("img");h.className=e.tab.scratchClass("stage-header_stage-button-icon"),h.draggable=!1,h.src=j("/icons/debug.svg"),u.appendChild(h),l.appendChild(u),g.appendChild(l),l.addEventListener("click",()=>E(!0));const m=Object.assign(document.createElement("div"),{className:e.tab.scratchClass("card_card",{others:"sa-debugger-interface"})}),M=Object.assign(document.createElement("div"),{className:e.tab.scratchClass("card_header-buttons")}),b=Object.assign(document.createElement("ul"),{className:"sa-debugger-tabs"}),p=Object.assign(document.createElement("div"),{className:e.tab.scratchClass("card_header-buttons-right",{others:"sa-debugger-header-buttons"})}),w=Object.assign(document.createElement("div"),{className:"sa-debugger-tab-content"}),A=document.createElement("a");A.addEventListener("click",()=>{e.tab.redux.dispatch({type:"scratch-gui/modals/OPEN_MODAL",modal:"settingsModal"})}),A.className="sa-debugger-log sa-debugger-compiler-warning",A.textContent="The debugger works best when the compiler is disabled.";const y=()=>{A.hidden=!c.runtime.compilerOptions.enabled};c.on("COMPILER_OPTIONS_CHANGED",y),y();let N=!1;const E=e=>{N=e,m.style.display=N?"flex":"",N?F.show():F.hide()};let L=0,T=0,C=0,S=0;const k=()=>{document.removeEventListener("mouseup",k),document.removeEventListener("mousemove",Z)},z=(e,t)=>{C=e,S=t;const n=(document.documentElement.clientWidth||document.body.clientWidth)-1,s=(document.documentElement.clientHeight||document.body.clientHeight)-1,o=Math.max(0,Math.min(e-L,n-m.offsetWidth)),i=Math.max(0,Math.min(t-T,s-m.offsetHeight));m.style.left=o+"px",m.style.top=i+"px"},Z=e=>{e.preventDefault(),z(e.clientX,e.clientY)};window.addEventListener("resize",()=>{z(C,S)}),M.addEventListener("mousedown",e=>{e.preventDefault(),L=e.clientX-m.offsetLeft,T=e.clientY-m.offsetTop,C=e.clientX,S=e.clientY,document.addEventListener("mouseup",k),document.addEventListener("mousemove",Z)}),M.append(b,p),m.append(M,A,w),document.body.append(m);const W=({text:t,icon:n,description:s})=>{const o=Object.assign(document.createElement("div"),{className:e.tab.scratchClass("card_shrink-expand-button"),draggable:!1});s&&(o.title=s);const i=Object.assign(document.createElement("img"),{src:n,draggable:!1}),a=Object.assign(document.createElement("span"),{textContent:t});return o.appendChild(i),o.appendChild(a),{element:o,image:i,text:a}},O=W({text:s("unpause"),icon:j("/icons/play.svg")});O.element.classList.add("sa-debugger-unpause"),O.element.addEventListener("click",()=>Object(I.e)(!1));const G=e=>{O.element.style.display=e?"":"none"};G(Object(I.b)()),Object(I.c)(G);const Y=W({text:s("close"),icon:j("/icons/close.svg")});Y.element.addEventListener("click",()=>E(!1));const H=c.runtime._step,U=[];c.runtime._step=function(...e){const t=H.call(this,...e);for(const e of U)e();return t};const B=(e,t)=>e.blocks.getBlock(t)||c.runtime.flyoutBlocks.getBlock(t),J=e=>{e!==c.editingTarget.id&&c.runtime.getTargetById(e)&&c.setEditingTarget(e)},P=()=>{const t=e.tab.redux;0!==t.state.scratchGui.editorTab.activeTabIndex&&t.dispatch({type:"scratch-gui/navigation/ACTIVATE_TAB",activeTabIndex:0})},R=t=>{const n=Blockly.getMainWorkspace().getBlockById(t);n&&(n.workspace.isFlyout||new v.a(e).scrollBlockIntoView(t))},_=e=>e.replace(/%[nbs]/g,"()"),Q={debug:{createHeaderButton:W,createHeaderTab:({text:e,icon:t})=>{const n=document.createElement("li"),s=Object.assign(document.createElement("img"),{src:t,draggable:!1}),o=Object.assign(document.createElement("span"),{textContent:e});return n.appendChild(s),n.appendChild(o),{element:n,image:s,text:o}},setHasUnreadMessage:e=>{const t=j(e?"/icons/debug-unread.svg":"/icons/debug.svg");h.src!==t&&(h.src=t)},addAfterStepCallback:e=>{U.push(e)},getBlock:B,getTargetInfoById:e=>{const t=c.runtime.getTargetById(e);if(t){let e=t.getName(),n=t;return t.isOriginal||(e=s("clone-of",{sprite:e}),n=t.sprite.clones[0]),{exists:!0,originalId:n.id,name:e}}return{exists:!1,original:null,name:s("unknown-sprite")}},createBlockLink:(e,t)=>{const n=document.createElement("a");n.className="sa-debugger-log-link";const{exists:s,name:o,originalId:i}=e;return n.textContent=o,s?n.addEventListener("mousedown",()=>{J(i),P(),R(t)}):n.classList.add("sa-debugger-log-link-unknown"),n},createBlockPreview:(t,n)=>{const s=c.runtime.getTargetById(t);if(!s)return null;const o=B(s,n);if(!o||"text"===o.opcode)return null;let i,a,r,g;if("data_variable"===o.opcode||"data_listcontents"===o.opcode||"argument_reporter_string_number"===o.opcode||"argument_reporter_boolean"===o.opcode)i=Object.values(o.fields)[0].value,a="data_variable"===o.opcode?"data":"data_listcontents"===o.opcode?"list":"more",r="round";else if("procedures_call"===o.opcode){const t=o.mutation.proccode;i=_(t);const n=e.tab.getCustomBlock(t);n?(a="addon-custom-block",g=n.color):a="more"}else if("procedures_definition"===o.opcode){const e=o.inputs.custom_block.block,t=B(s,e).mutation.proccode;i=d.ScratchMsgs.translate("PROCEDURES_DEFINITION","define %1").replace("%1",_(t)),a="more"}else{var l;const e={jsonInit(e){l=e}},t=d.Blocks[o.opcode];if(t)try{t.init.call(e)}catch(e){}if(!l)return null;if(i=(e=>{const t=t=>{const n=e["message".concat(t)],s=e["args".concat(t)];if(!n)return null;const o=n.split(/%\d+/g);let i="";for(let e=0;e<o.length;e++){i+=o[e];const t=s&&s[e];if(t){const e=t.type;if("field_vertical_separator"===e);else if("field_image"===e){const e=t.src;e.endsWith("rotate-left.svg")?i+="↩":e.endsWith("rotate-right.svg")&&(i+="↪")}else i+="()"}}return i},n=[];let s=0;for(;;){const e=t(s);if(!e)break;n.push(e),s++}return n.join(" ")})(l),!i)return null;a=l.category;r=l.extensions&&(l.extensions.includes("shape_statement")||l.extensions.includes("shape_hat")||l.extensions.includes("shape_end"))||"previousStatement"in l||"nextStatement"in l?"stacked":"round"}if(!i||!a)return null;if(!g){const e={"data-lists":"data_lists",list:"data_lists",events:"event"},t=d.Colours[e[a]||a];g=t?t.primary:d.Colours.pen.primary}const u=document.createElement("span");u.className="sa-debugger-block-preview",u.textContent=i,u.style.backgroundColor=g,u.dataset.shape=r;return u.dataset.category={list:"data-lists",more:"custom"}[a]||a,u}},addon:e,msg:s,console:n};o=await D(Q);const V=await x(Q),X=[o,V];for(const e of i)o.addLog(...e);let F;i.length=0;const q=e=>{if(e===F)return;F&&(F.hide(),F.tab.element.classList.remove("sa-debugger-tab-selected")),e.tab.element.classList.add("sa-debugger-tab-selected"),F=e,f(w),w.appendChild(e.content),f(p),p.appendChild(O.element);for(const t of e.buttons)p.appendChild(t.element);p.appendChild(Y.element),N&&F.show()};for(const e of X)e.tab.element.addEventListener("click",()=>{q(e)}),b.appendChild(e.tab.element);q(X[0]),e.tab.redux.state&&"small"===e.tab.redux.state.scratchGui.stageSize.stageSize&&document.body.classList.add("sa-debugger-small"),document.addEventListener("click",e=>{e.target.closest("[class*='stage-header_stage-button-first']")?document.body.classList.add("sa-debugger-small"):e.target.closest("[class*='stage-header_stage-button-last']")&&document.body.classList.remove("sa-debugger-small")},{capture:!0});const K=c.runtime.greenFlag;c.runtime.greenFlag=function(...t){return e.settings.get("log_clear_greenflag")&&o.clearLogs(),e.settings.get("log_greenflag")&&o.addLog(s("log-msg-flag-clicked"),null,"internal"),K.call(this,...t)};const $=c.runtime.targets[0].constructor.prototype.makeClone;c.runtime.targets[0].constructor.prototype.makeClone=function(...t){e.settings.get("log_failed_clone_creation")&&!c.runtime.clonesAvailable()&&o.addLog(s("log-msg-clone-cap",{sprite:this.getName()}),c.runtime.sequencer.activeThread,"internal-warn");var n=$.call(this,...t);return e.settings.get("log_clone_create")&&n&&o.addLog(s("log-msg-clone-created",{sprite:this.getName()}),c.runtime.sequencer.activeThread,"internal"),n};const ee=c.runtime.startHats;for(c.runtime.startHats=function(t,n,...i){return e.settings.get("log_broadcasts")&&"event_whenbroadcastreceived"===t&&o.addLog(s("log-msg-broadcasted",{broadcast:n.BROADCAST_OPTION}),c.runtime.sequencer.activeThread,"internal"),ee.call(this,t,n,...i)};;)await e.tab.waitForElement('[class*="stage-header_stage-size-row"]',{markAsSeen:!0,reduxEvents:["scratch-gui/mode/SET_PLAYER","scratch-gui/mode/SET_FULL_SCREEN","fontsLoaded/SET_FONTS_LOADED","scratch-gui/locales/SELECT_LOCALE"]}),"editor"===e.tab.editorMode?e.tab.appendToSharedSpace({space:"stageHeader",element:g,order:0}):E(!1)},"style.css":n.n(T).a}}}]);