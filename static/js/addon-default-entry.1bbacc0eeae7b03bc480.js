(window.webpackJsonpGUI=window.webpackJsonpGUI||[]).push([[4],{1651:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,"/* Imported by other addons */\n\n.sa-block-color {\n  --sa-block-colored-background: var(--sa-block-background-primary);\n  --sa-block-colored-background-secondary: var(--sa-block-field-background);\n  --sa-block-bright-background: var(--sa-block-background-primary);\n  --sa-block-text: var(--editorTheme3-blockText, white);\n  --sa-block-gray-text: white;\n  --sa-block-colored-text: var(--sa-block-background-primary);\n  --sa-block-text-on-bright-background: var(--editorTheme3-blockText, white);\n  --sa-block-input-color: var(--editorTheme3-inputColor, white);\n  --sa-block-input-text: var(--editorTheme3-inputColor-text, #575e75);\n}\n\n.sa-block-color-motion {\n  --sa-block-background-primary: var(--editorTheme3-motion-primary, #4c97ff);\n  --sa-block-background-secondary: var(--editorTheme3-motion-secondary, #4280d7);\n  --sa-block-background-tertiary: var(--editorTheme3-motion-tertiary, #3373cc);\n  --sa-block-field-background: var(--editorTheme3-motion-field, #3373cc);\n}\n\n.sa-block-color-looks {\n  --sa-block-background-primary: var(--editorTheme3-looks-primary, #9966ff);\n  --sa-block-background-secondary: var(--editorTheme3-looks-secondary, #855cd6);\n  --sa-block-background-tertiary: var(--editorTheme3-looks-tertiary, #774dcb);\n  --sa-block-field-background: var(--editorTheme3-looks-field, #774dcb);\n}\n\n.sa-block-color-sounds {\n  --sa-block-background-primary: var(--editorTheme3-sounds-primary, #cf63cf);\n  --sa-block-background-secondary: var(--editorTheme3-sounds-secondary, #c94fc9);\n  --sa-block-background-tertiary: var(--editorTheme3-sounds-tertiary, #bd42bd);\n  --sa-block-field-background: var(--editorTheme3-sounds-field, #bd42bd);\n}\n\n.sa-block-color-events {\n  --sa-block-background-primary: var(--editorTheme3-event-primary, #ffbf00);\n  --sa-block-background-secondary: var(--editorTheme3-event-secondary, #e6ac00);\n  --sa-block-background-tertiary: var(--editorTheme3-event-tertiary, #cc9900);\n  --sa-block-field-background: var(--editorTheme3-event-field, #cc9900);\n}\n\n.sa-block-color-control {\n  --sa-block-background-primary: var(--editorTheme3-control-primary, #ffab19);\n  --sa-block-background-secondary: var(--editorTheme3-control-secondary, #ec9c13);\n  --sa-block-background-tertiary: var(--editorTheme3-control-tertiary, #cf8b17);\n  --sa-block-field-background: var(--editorTheme3-control-field, #cf8b17);\n}\n\n.sa-block-color-sensing {\n  --sa-block-background-primary: var(--editorTheme3-sensing-primary, #5cb1d6);\n  --sa-block-background-secondary: var(--editorTheme3-sensing-secondary, #47a8d1);\n  --sa-block-background-tertiary: var(--editorTheme3-sensing-tertiary, #2e8eb8);\n  --sa-block-field-background: var(--editorTheme3-sensing-field, #2e8eb8);\n}\n\n.sa-block-color-operators {\n  --sa-block-background-primary: var(--editorTheme3-operators-primary, #59c059);\n  --sa-block-background-secondary: var(--editorTheme3-operators-secondary, #46b946);\n  --sa-block-background-tertiary: var(--editorTheme3-operators-tertiary, #389438);\n  --sa-block-field-background: var(--editorTheme3-operators-field, #389438);\n}\n\n.sa-block-color-data {\n  --sa-block-background-primary: var(--editorTheme3-data-primary, #ff8c1a);\n  --sa-block-background-secondary: var(--editorTheme3-data-secondary, #ff8000);\n  --sa-block-background-tertiary: var(--editorTheme3-data-tertiary, #db6e00);\n  --sa-block-field-background: var(--editorTheme3-data-field, #db6e00);\n}\n\n.sa-block-color-data-lists,\n.sa-block-color-list {\n  --sa-block-background-primary: var(--editorTheme3-data_lists-primary, #ff661a);\n  --sa-block-background-secondary: var(--editorTheme3-data_lists-secondary, #ff5500);\n  --sa-block-background-tertiary: var(--editorTheme3-data_lists-tertiary, #e64d00);\n  --sa-block-field-background: var(--editorTheme3-data_lists-field, #e64d00);\n}\n\n.sa-block-color-more,\n.sa-block-color-null {\n  --sa-block-background-primary: var(--editorTheme3-more-primary, #ff6680);\n  --sa-block-background-secondary: var(--editorTheme3-more-secondary, #ff4d6a);\n  --sa-block-background-tertiary: var(--editorTheme3-more-tertiary, #ff3355);\n  --sa-block-field-background: var(--editorTheme3-more-field, #ff3355);\n}\n\n.sa-block-color-pen {\n  --sa-block-background-primary: var(--editorTheme3-pen-primary, #0fbd8c);\n  --sa-block-background-secondary: var(--editorTheme3-pen-secondary, #0da57a);\n  --sa-block-background-tertiary: var(--editorTheme3-pen-tertiary, #0b8e69);\n  --sa-block-field-background: var(--editorTheme3-pen-field, #0b8e69);\n}\n\n.sa-block-color-addon-custom-block {\n  --sa-block-background-primary: var(--editorTheme3-addons-primary, #29beb8);\n  --sa-block-background-secondary: var(--editorTheme3-addons-secondary, #3aa8a4);\n  --sa-block-background-tertiary: var(--editorTheme3-addons-tertiary, #3aa8a4);\n  --sa-block-field-background: var(--editorTheme3-addons-field, #3aa8a4);\n}\n",""])},1652:function(e,t,o){"use strict";o.d(t,"b",(function(){return c})),o.d(t,"a",(function(){return l})),o.d(t,"c",(function(){return d}));var n=o(734);const s=new Map,r=1e3,i=new n.a,a="clearTextCache";function c(e){let t=e.innerHTML;if(0===t.length)return 0;let o=s.get(t);return o||(o=e.getBoundingClientRect().width,s.set(t,o),s.size>r&&s.delete(s.keys().next()),o)}function l(){s.clear(),i.dispatchEvent(new CustomEvent(a))}function d(e){i.addEventListener(a,e)}},1657:function(e,t,o){"use strict";o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return s}));const n=()=>/^#?[0-9a-fA-F]{3,8}$/,s=e=>{let t=String(e);if(!n().test(t))return"#000000";if(t.startsWith("#")||(t="#".concat(t)),4===t.length){const[e,o,n,s]=t;t="#".concat(o).concat(o).concat(n).concat(n).concat(s).concat(s)}return t.toLowerCase()}},1658:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));class n{constructor(e){this.timeout=null,this.callback=null,this.wait=e}abort(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.timeout&&(clearTimeout(this.timeout),e&&this.callback(),this.timeout=this.callback=null)}limit(e){this.abort(!1),this.callback=e,this.timeout=setTimeout((()=>{this.timeout=this.callback=null,e()}),this.wait)}}},1659:function(e,t,o){"use strict";o.d(t,"a",(function(){return s})),o.d(t,"b",(function(){return r}));let n=!1;const s={paintSkew:null,paintSnap:null};function r(e,t){if(n)return;n=!0;const o=t.prototype.onMouseDrag;t.prototype.onMouseDrag=function(e){if(!this.active)return;const t=()=>{s.paintSnap?s.paintSnap.call(this,e):o.call(this,e)};s.paintSkew?s.paintSkew.call(this,e,t):t()}}},1664:function(e,t,o){"use strict";o.d(t,"b",(function(){return r})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return u}));let n=!1,s=!1;function r(e,t){n=e,s=e&&t}let i=!1;function a(e){i=e}let c=!1,l=!1;document.addEventListener("mousedown",(function(e){c=e.ctrlKey||e.metaKey,l=e.altKey}),{capture:!0});let d=!1;async function u(e){if(d)return;d=!0;const t=await e.tab.traps.getBlockly(),o=t.Gesture.prototype.startDraggingBlock_;t.Gesture.prototype.startDraggingBlock_=function(){let e=this.targetBlock_;const r=!(this.mostRecentEvent_ instanceof MouseEvent),a=i&&l&&!r&&!this.flyout_&&!this.shouldDuplicateOnDrag_&&"procedures_definition"!==this.targetBlock_.type,d=s&&!r&&e.getParent(),u=(n||a)&&c===!d&&!e.isShadow();if((a||u)&&(t.Events.getGroup()||t.Events.setGroup(!0)),a){let o;this.startWorkspace_.setResizesEnabled(!1),t.Events.disable();try{const n=t.Xml.blockToDom(e);o=t.Xml.domToBlock(n,this.startWorkspace_),t.scratchBlocksUtils.changeObscuredShadowIds(o);const s=e.getRelativeToSurfaceXY();o.moveBy(s.x,s.y)}catch(e){console.error(e)}t.Events.enable(),o&&(e=o,this.targetBlock_=o,t.Events.isEnabled()&&t.Events.fire(new t.Events.BlockCreate(o)))}if(u){if(r||a){const t=e.getNextBlock();t&&t.dispose()}e.unplug(!0)}for(var p=arguments.length,h=new Array(p),g=0;g<p;g++)h[g]=arguments[g];return o.call(this,...h)}}},1703:function(e,t,o){(t=e.exports=o(9)(!1)).i(o(1651),""),t.push([e.i,'.sa-find-bar {\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  width: 100%;\n  height: 100%;\n  margin-left: 1em;\n}\n.sa-find-bar[hidden] {\n  /* !important to override displayNoneWhileDisabled */\n  display: none !important;\n}\n\n.sa-find-wrapper {\n  overflow: visible;\n  position: relative;\n  height: 2rem;\n  width: 100%;\n  max-width: 16em;\n}\n\n.sa-find-dropdown-out {\n  display: block;\n  top: -6px;\n  z-index: 100;\n  width: 100%;\n  max-width: 16em;\n  position: relative;\n  padding: 4px;\n  border: none;\n  border-radius: 4px;\n  margin-top: 6px;\n}\n\n.sa-find-dropdown-out.visible {\n  position: absolute;\n  width: 16em;\n  box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, 0.3);\n  background-color: var(--ui-modal-background);\n  outline: 1px solid var(--ui-black-transparent);\n}\n\n/* We need to modify Scratch styles so that the place where the find bar is injected */\n/* has actually correct size information, which is used to make the find bar not cover up controls */\n[class*="gui_tab-list_"] {\n  width: 100%;\n}\n[class*="gui_tab_"] {\n  flex-grow: 0;\n}\n\n.sa-find-input {\n  width: 100%;\n  box-sizing: border-box !important;\n  /* !important required for extension, because CSS injection method (and hence order) differs from addon */\n  height: 1.5rem;\n\n  /* Change Scratch default styles */\n  border-radius: 0.25rem;\n  font-size: 0.75rem;\n  padding-left: 0.4em;\n}\n\n.sa-find-input:focus {\n  /* Change Scratch default styles */\n  box-shadow: none;\n}\n\n.sa-find-dropdown {\n  display: none;\n  position: relative;\n  padding: 0.2em 0;\n  font-size: 0.75rem;\n  line-height: 1;\n  overflow-y: auto;\n  min-height: 128px;\n  max-height: 65vh;\n  user-select: none;\n  max-width: 100%;\n  margin-top: 6px;\n  border: none;\n}\n\n.sa-find-dropdown-out.visible > .sa-find-dropdown {\n  display: block;\n}\n\n.sa-find-dropdown > li {\n  display: block;\n  padding: 0.5em 0.3em;\n  white-space: nowrap;\n  margin: 0;\n  font-weight: bold;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n\n.sa-find-dropdown > li > b {\n  background-color: #aaffaa;\n  color: black;\n}\n\n/* Drop down items */\n.sa-find-dropdown > li:hover,\n.sa-find-dropdown > li.sel {\n  color: var(--sa-block-text-on-bright-background);\n  cursor: pointer;\n}\n\n.sa-find-dropdown > li::before {\n  content: "\\25CF   "; /* â— */\n}\n\n.sa-find-flag {\n  color: #4cbf56;\n}\n/* .sa-find-dropdown added for specificity */\n.sa-find-dropdown > .sa-find-flag:hover,\n.sa-find-dropdown > .sa-find-flag.sel {\n  background-color: #4cbf56;\n  color: white;\n}\n\n.sa-find-dropdown .sa-block-color {\n  color: var(--sa-block-colored-text);\n}\n.sa-find-dropdown .sa-block-color:hover,\n.sa-find-dropdown .sa-block-color.sel {\n  background-color: var(--sa-block-bright-background);\n}\n\n.sa-find-carousel {\n  font-weight: normal;\n  position: absolute;\n  right: 0;\n  white-space: nowrap;\n  background-color: inherit;\n  z-index: 1;\n  padding: 0;\n}\n\n.sa-find-carousel-control {\n  padding: 0 6px;\n}\n\n.sa-find-carousel-control:hover {\n  color: #ffff80;\n}\n',""])},1704:function(e,t,o){(t=e.exports=o(9)(!1)).i(o(1651),""),t.push([e.i,'.sa-mcp-root {\n  display: flex;\n  white-space: nowrap;\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n\n  position: absolute;\n  min-width: 100px;\n  background-color: var(--ui-modal-background);\n  border-radius: 4px;\n  box-shadow:\n    rgba(0, 0, 0, 0.3) 0 0 3px,\n    rgba(0, 0, 0, 0.2) 0 3px 10px;\n\n  z-index: 999;\n}\n\n.sa-mcp-container {\n  display: flex;\n  flex-flow: column;\n  top: -6px;\n  z-index: 100;\n  position: absolute;\n  box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, 0.3);\n  background-color: var(--ui-modal-background);\n  outline: 1px solid var(--ui-black-transparent);\n  border: none;\n  border-radius: 4px;\n}\n\n.sa-mcp-input-wrapper {\n  position: relative;\n  margin: 4px;\n  /* !important required for extension, because CSS injection method (and hence order) differs from addon */\n  box-sizing: border-box !important;\n  height: 1.5rem;\n  min-height: 1.5rem;\n\n  /* Change Scratch default styles */\n  border-radius: 0.25rem;\n  font-size: 0.75rem;\n  padding-left: 0.2rem;\n  padding-right: 0.2rem;\n}\n\n.sa-mcp-input-wrapper:focus {\n  /* Change Scratch default styles */\n  box-shadow: none;\n}\n\n.sa-mcp-input-wrapper[data-error="true"] {\n  border-color: red;\n}\n\n.sa-mcp-input-wrapper > input {\n  position: absolute;\n  border: 0;\n  background-color: transparent;\n  outline: none;\n  width: 100%;\n  height: 100%;\n  line-height: 100%;\n  box-sizing: border-box;\n}\n\n.sa-mcp-input-suggestion {\n  color: hsla(225, 15%, 40%, 0.65);\n}\n\n.sa-mcp-preview-container {\n  flex: auto;\n  overflow-y: scroll;\n}\n\n.sa-mcp-root /* <-- specificity */ .sa-mcp-preview-container {\n  scrollbar-width: none;\n}\n\n.sa-mcp-preview-container::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n}\n\n.sa-mcp-preview-blocks {\n  width: 100%;\n  min-height: 100%;\n  /* https://stackoverflow.com/a/22166728/8448397 */\n  float: left;\n}\n\n.sa-mcp-preview-scrollbar {\n  position: absolute;\n  width: 11px;\n  right: 0;\n  bottom: 0;\n}\n\n.sa-mcp-preview-block-bg {\n  width: 100%;\n  fill: transparent;\n  cursor: grab;\n}\n\n.sa-mcp-preview-block {\n  filter: brightness(95%);\n  cursor: grab;\n}\n\n.sa-mcp-preview-block-selection {\n  filter: brightness(103%);\n}\n\n.sa-mcp-preview-block-bg-selection {\n  fill: #7774;\n}\n',""])},1705:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,".blocklyTextShiftArrow {\n  position: absolute;\n  top: -50px;\n  left: 50%;\n  margin-left: -12.5px;\n  cursor: pointer;\n}\n",""])},1706:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,".u-dropdown-searchbar {\n  width: 100%;\n  box-sizing: border-box;\n  /* based on styles for the title input */\n  color: white;\n  background-color: hsla(0, 100%, 100%, 0.25);\n  border: 1px solid hsla(0, 0%, 0%, 0.15);\n  padding: 0.5rem;\n  outline: none;\n  transition: 0.25s ease-out;\n  font-size: 13px;\n  font-weight: bold;\n  border-radius: 4px;\n}\n.u-dropdown-searchbar:hover {\n  background-color: hsla(0, 100%, 100%, 0.5);\n}\n.u-dropdown-searchbar:focus {\n  background-color: white;\n  color: black;\n}\n.blocklyDropDownDiv .goog-menu {\n  overflow-x: hidden;\n}\n",""])},1734:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,'.sa-color-picker {\n  display: flex;\n}\n\n.sa-color-picker-code {\n  margin: 8px 0;\n}\n\n.sa-color-picker-paint {\n  margin-top: 16px;\n  margin-bottom: 4px;\n}\n\n.sa-color-picker > .sa-color-picker-color {\n  border: none;\n  border-top-left-radius: 1rem;\n  border-bottom-left-radius: 1rem;\n  padding: 0;\n  padding-left: 0.6rem;\n  padding-right: 0.4rem;\n  margin-left: 0.5rem;\n  outline: none;\n  box-sizing: border-box;\n  width: 3rem;\n  height: 2rem;\n}\n\n.sa-color-picker > .sa-color-picker-text {\n  box-sizing: border-box;\n  width: calc(150px - 3rem);\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n\n[dir="rtl"] .sa-color-picker > .sa-color-picker-color {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  border-top-right-radius: 1rem;\n  border-bottom-right-radius: 1rem;\n  margin-left: 0;\n  margin-right: 0.5rem;\n}\n\n[dir="rtl"] .sa-color-picker > .sa-color-picker-text {\n  border-top-left-radius: 1rem;\n  border-bottom-left-radius: 1rem;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n\nbody.sa-hide-eye-dropper-background div[class*="stage_color-picker-background"] {\n  /* Do not show eye dropper background if the color picker is "fake" */\n  display: none;\n}\n',""])},1735:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,'.sa-onion-button {\n  position: relative;\n}\n.sa-onion-button:focus-within {\n  background-color: var(--editorDarkMode-primary-transparent35, hsla(260, 60%, 60%, 0.35));\n}\n.sa-onion-image[data-image="toggle"] {\n  filter: var(--filter-icon-white);\n}\n.sa-onion-image[data-image="settings"] {\n  filter: var(--filter-icon-black);\n}\n.sa-onion-button[data-enabled="true"] .sa-onion-image {\n  filter: brightness(0) invert(1);\n}\n.sa-onion-button[data-enabled="true"] {\n  color: white;\n  background-color: var(--looks-secondary);\n}\n\n.sa-onion-group {\n  position: relative;\n  flex-direction: row;\n}\n\n.sa-onion-settings-wrapper {\n  position: absolute;\n  justify-items: center;\n  left: 50%;\n  width: 1.95rem;\n  height: 1.95rem;\n  display: grid;\n}\n\n.sa-onion-settings {\n  position: absolute;\n  bottom: 100%;\n  /* based on the styles for the color dropdown */\n  padding: 4px;\n  border-radius: 4px;\n  border: 1px solid #ddd;\n  border: 1px solid var(--ui-black-transparent);\n  transition-property: bottom, opacity;\n  transition-duration: 500ms;\n  transition-timing-function: cubic-bezier(0.23, 1, 0.32, 1);\n  opacity: 0;\n  pointer-events: none;\n  background: var(--ui-modal-background);\n  color: var(--ui-text-primary);\n  min-height: 100%;\n  min-width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25em;\n}\n.sa-onion-settings[data-visible="true"] {\n  bottom: calc(100% + 22px);\n  pointer-events: auto;\n  opacity: 1;\n}\n\n.sa-onion-settings-line {\n  display: flex;\n  justify-content: flex-end;\n  align-items: baseline;\n  gap: 0.25em;\n}\n\n.sa-onion-settings-input {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  text-align: center;\n  border: 0;\n  background: transparent;\n  -moz-appearance: textfield;\n  border: 0;\n  outline: 0;\n}\n\n.sa-onion-settings-input::-webkit-outer-spin-button,\n.sa-onion-settings-input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\n.sa-onion-settings-tip {\n  position: absolute;\n  bottom: 0;\n  transform: translateY(100%);\n  right: calc(50% - 7px);\n}\n.sa-onion-settings-polygon {\n  fill: var(--ui-modal-background);\n  stroke: var(--ui-black-transparent);\n}\n\n.sa-onion-settings-label {\n  white-space: nowrap;\n}\n',""])},1739:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,'.sa-stage-color-picker-picking [class^="stage_color-picker-background_"] {\n  display: none;\n}\n',""])},1763:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,'.sa-folders-contextmenu-item {\n  max-width: 250px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n[sa-folders-context-type="folder"] .react-contextmenu > :not(.sa-ctx-menu) {\n  display: none;\n}\n',""])},1775:function(e,t,o){(e.exports=o(9)(!1)).push([e.i,".sa-comment-preview-outer {\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 100000000;\n  pointer-events: none;\n}\n\n.sa-comment-preview-inner {\n  width: calc(200px - 16px);\n  max-height: calc(132px - 8px);\n  padding: 8px;\n  overflow: hidden;\n\n  font-size: 12px;\n  white-space: pre-wrap;\n  pointer-events: none;\n\n  color: rgb(87, 94, 117);\n  background-color: rgb(255 255 255 / 90%);\n  border-style: none;\n  border-radius: 8px;\n  filter: drop-shadow(0px 5px 5px rgb(0 0 0 / 10%));\n\n  transform: perspective(200px);\n}\n\n@supports (backdrop-filter: blur(16px)) {\n  .sa-comment-preview-inner {\n    background-color: rgb(255 255 255 / 75%);\n    backdrop-filter: blur(16px);\n  }\n}\n\n.sa-comment-preview-fade {\n  transition:\n    opacity 0.1s,\n    filter 0.1s,\n    transform 0.1s linear;\n}\n\n.sa-comment-preview-hidden {\n  opacity: 0;\n  filter: none;\n  transform: perspective(200px) translateZ(-20px);\n}\n\n.sa-comment-preview-reduce-transparency {\n  background-color: rgb(255 255 255);\n  backdrop-filter: none;\n}\n",""])},1792:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return c}));class n{constructor(e){this.addon=e,this.vm=e.tab.traps.vm,this.events=[]}triggerDragAndDrop(e,t,o,n){n=n||!1;let s=function(e,t,o,s){let r=document.createEvent("MouseEvents");r.initMouseEvent(e,!0,!0,window,1,1,1,o,s,n,!1,!1,!1,0,t),t.dispatchEvent(r)},r=e,i=t;if(!r)return!1;let a=r.getBoundingClientRect(),c=Math.floor((a.left+a.right)/2),l=Math.floor((a.top+a.bottom)/2);if(s("mouseover",r,c,l),s("mousedown",r,c,l),s("dragstart",r,c,l),s("drag",r,c,l),s("mousemove",r,c,l),!i){if(o){let e=o.x,t=o.y;s("drag",r,e,t),s("mousemove",r,e,t)}return!1}a=i.getBoundingClientRect();let d=Math.floor((a.left+a.right)/2),u=Math.floor((a.top+a.bottom)/2);return s("drag",r,d,u),s("mousemove",i,d,u),s("mouseenter",i,d,u),s("dragenter",i,d,u),s("mouseover",i,d,u),s("dragover",i,d,u),s("drop",i,d,u),s("dragend",r,d,u),s("mouseup",r,d,u),!0}bindOnce(e,t,o,n){n=!!n,e.removeEventListener(t,o,n),e.addEventListener(t,o,n),this.events.push(new s(e,t,o,n))}unbindAllEvents(){for(const e of this.events)e.dom.removeEventListener(e.event,e.func,e.capture);this.events=[]}}class s{constructor(e,t,o,n){this.dom=e,this.event=t,this.func=o,this.capture=n}}class r{static startUndoGroup(e){const t=e.undoStack_;t.length&&(t[t.length-1]._devtoolsLastUndo=!0)}static endUndoGroup(e){const t=e.undoStack_;setTimeout((()=>{const e=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%()*+,-./:;=?@[]^_`{|}~";let t="";for(let o=0;o<20;o++)t+=e[Math.floor(Math.random()*e.length)];return t}();for(let o=t.length-1;o>=0&&!t[o]._devtoolsLastUndo;o--)t[o].group=e}),0)}}class i{constructor(e,t,o){this.addon=e,this.msg=t,this.m=o,this.domHelpers=new n(e),this.codeTab=null,this.costTab=null,this.costTabBody=null,this.selVarID=null,this.canShare=!1,this.mouseXY={x:0,y:0}}async init(){for(this.addContextMenus();;){const e=await this.addon.tab.waitForElement("ul[class*=gui_tab-list_]",{markAsSeen:!0,reduxEvents:["scratch-gui/mode/SET_PLAYER","fontsLoaded/SET_FONTS_LOADED","scratch-gui/locales/SELECT_LOCALE"],reduxCondition:e=>!e.scratchGui.mode.isPlayerOnly});this.initInner(e)}}async addContextMenus(){const e=await this.addon.tab.traps.getBlockly(),t=e.WorkspaceSvg.prototype.cleanUp,o=this;e.WorkspaceSvg.prototype.cleanUp=function(){o.addon.settings.get("enableCleanUpPlus")?o.doCleanUp():t.call(this)};let n=e.Msg.CLEAN_UP;this.addon.settings.get("enableCleanUpPlus")&&(e.Msg.CLEAN_UP=this.m("clean-plus")),this.addon.settings.addEventListener("change",(()=>{this.addon.settings.get("enableCleanUpPlus")?e.Msg.CLEAN_UP=this.m("clean-plus"):e.Msg.CLEAN_UP=n})),this.addon.tab.createBlockContextMenu(((t,o)=>(t.push({enabled:e.clipboardXml_,text:this.m("paste"),separator:!0,_isDevtoolsFirstItem:!0,callback:()=>{let e=this.getTopBlockIDs();document.dispatchEvent(new KeyboardEvent("keydown",{keyCode:86,ctrlKey:!0,griff:!0})),setTimeout((()=>{this.beginDragOfNewBlocksNotInIDs(e)}),10)}}),t)),{workspace:!0}),this.addon.tab.createBlockContextMenu(((e,t)=>(e.push({enabled:!0,text:this.m("make-space"),_isDevtoolsFirstItem:!0,callback:()=>{this.doCleanUp(t)},separator:!0},{enabled:!0,text:this.m("copy-all"),callback:()=>{this.eventCopyClick(t)},separator:!0},{enabled:!0,text:this.m("copy-block"),callback:()=>{this.eventCopyClick(t,1)}},{enabled:!0,text:this.m("cut-block"),callback:()=>{this.eventCopyClick(t,2)}}),e)),{blocks:!0}),this.addon.tab.createBlockContextMenu(((e,t)=>("data"!==t.getCategory()&&"data-lists"!==t.getCategory()||(this.selVarID=t.getVars()[0],e.push({enabled:!0,text:this.m("swap",{var:"data"===t.getCategory()?this.m("variables"):this.m("lists")}),callback:async()=>{let e=this.getWorkspace().getVariableById(this.selVarID),t=await window.prompt(this.msg("replace",{name:e.name}));t&&this.doReplaceVariable(this.selVarID,t,e.type)},separator:!0})),e)),{blocks:!0,flyout:!0})}getWorkspace(){return Blockly.getMainWorkspace()}isCostumeEditor(){return this.costTab.className.indexOf("gui_is-selected")>=0}getTopBlocks(){let e=this.getOrderedTopBlockColumns().cols,t=[];for(const o of e)t=t.concat(o.blocks);return t}doCleanUp(e){let t=this.getWorkspace(),o=e&&e.getRootBlock();r.startUndoGroup(t);let n=this.getOrderedTopBlockColumns(!0),s=n.cols,i=n.orphans.blocks.length;if(i>0&&!e){let e=this.msg("orphaned",{count:i});if(confirm(e))for(const e of n.orphans.blocks)e.dispose();else s.unshift(n.orphans)}let a=48,c=n.maxWidths;for(const e of s){let t=64,n=0;for(const s of e.blocks){let e=s===o?380:0,r=s===o?480:72,i=s.getRelativeToSurfaceXY();a-i.x==0&&t-i.y==0||s.moveBy(a-i.x,t-i.y);let l=s.getHeightWidth();t+=l.height+r;let d=c[s.id]||0;n=Math.max(n,Math.max(l.width+e,d))}a+=n+96}let l=t.getTopComments();for(const e of l)e.setVisible&&(e.setVisible(!1),e.needsAutoPositioning_=!0,e.setVisible(!0));setTimeout((()=>{let e=this.getWorkspace(),t=e.getVariableMap(),o=t.getVariablesOfType(""),n=[];for(const e of o)if(e.isLocal){let o=t.getVariableUsesById(e.getId());o&&0!==o.length||n.push(e)}if(n.length>0){const t=n.length;let o=this.msg("unused-var",{count:t});for(let e=0;e<n.length;e++){e>0&&(o+=", "),o+=n[e].name}if(confirm(o))for(const t of n)e.deleteVariableById(t.getId())}let s=t.getVariablesOfType("list"),i=[];for(const e of s)if(e.isLocal){let o=t.getVariableUsesById(e.getId());o&&0!==o.length||i.push(e)}if(i.length>0){const t=i.length;let o=this.msg("unused-list",{count:t});for(let e=0;e<i.length;e++){e>0&&(o+=", "),o+=i[e].name}if(confirm(o))for(const t of i)e.deleteVariableById(t.getId())}r.endUndoGroup(e)}),100)}isBlockAnOrphan(e){return!!e.outputConnection}getOrderedTopBlockColumns(e){let t=this.getWorkspace(),o=t.getTopBlocks(),n={};if(e){let e=t.getTopComments();for(const t of e)if(t.setVisible){t.setVisible(!1),t.needsAutoPositioning_=!0,t.setVisible(!0);let e=t.getBoundingRectangle().bottomRight.x,o=t.block_.getRootBlock(),s=o.getBoundingRectangle().topLeft.x;n[o.id]=Math.max(e-s,n[o.id]||0)}}let s=[];let r={x:-999999,count:0,blocks:[]};for(const t of o){let o=t.getRelativeToSurfaceXY(),n=null,i=256;if(e&&this.isBlockAnOrphan(t))r.blocks.push(t);else{for(const e of s){let t=Math.abs(o.x-e.x);t<i&&(i=t,n=e)}n?(n.x=(n.x*n.count+o.x)/++n.count,n.blocks.push(t)):s.push(new a(o.x,1,[t]))}}s.sort(((e,t)=>e.x-t.x));for(const e of s)e.blocks.sort(((e,t)=>e.getRelativeToSurfaceXY().y-t.getRelativeToSurfaceXY().y));return{cols:s,orphans:r,maxWidths:n}}getVariableUsesById(e){let t=[],o=this.getTopBlocks(!0);for(const n of o){let o=n.getDescendants();for(const n of o){let o=n.getVarModels();if(o)for(const s of o)s.getId()===e&&t.push(n)}}return t}doReplaceVariable(e,t,o){let n=this.getWorkspace(),s=n.getVariable(t,o);if(!s)return void alert(this.msg("var-not-exist"));let i=s.getId();r.startUndoGroup(n);let a=this.getVariableUsesById(e);for(const e of a)try{""===o?e.getField("VARIABLE").setValue(i):e.getField("LIST").setValue(i)}catch(e){}r.endUndoGroup(n)}getTopBlockIDs(){let e=this.getWorkspace().getTopBlocks(),t=new Set;for(const o of e)t.add(o.id);return t}beginDragOfNewBlocksNotInIDs(e){if(!this.addon.settings.get("enablePasteBlocksAtMouse"))return;let t=this.getWorkspace().getTopBlocks();for(const o of t)if(!e.has(o.id)){let e={x:this.mouseXY.x,y:this.mouseXY.y};o.setIntersects(!0),this.domHelpers.triggerDragAndDrop(o.svgPath_,null,e)}}updateMousePosition(e){this.mouseXY.x=e.clientX,this.mouseXY.y=e.clientY}eventMouseMove(e){this.updateMousePosition(e)}eventKeyDown(e){const t=e=>{let t=this.costTabBody.querySelector("div[class*='sprite-selector-item_is-selected']"),o=e?t.parentNode.previousSibling:t.parentNode.nextSibling;if(o){let e=o.closest("div[class*=gui_flex-wrapper]");o.querySelector("div[class^='sprite-selector-item_sprite-name']").click(),o.scrollIntoView({behavior:"auto",block:"center",inline:"start"}),e.scrollTop=0}};if(document.URL.indexOf("editor")<=0)return;let o=e.ctrlKey||e.metaKey;if("ArrowLeft"===e.key&&o){if("INPUT"===document.activeElement.tagName)return;if(this.isCostumeEditor())return t(!0),e.cancelBubble=!0,e.preventDefault(),!0}if("ArrowRight"===e.key&&o){if("INPUT"===document.activeElement.tagName)return;if(this.isCostumeEditor())return t(!1),e.cancelBubble=!0,e.preventDefault(),!0}if(86===e.keyCode&&o&&!e.griff){let e=this.getTopBlockIDs();setTimeout((()=>{this.beginDragOfNewBlocksNotInIDs(e)}),10)}}eventCopyClick(e,t){let o=this.getWorkspace();if(e){e.select();let n=t?e.getNextBlock():null;n&&n.unplug(!1),document.dispatchEvent(new KeyboardEvent("keydown",{keyCode:67,ctrlKey:!0})),(n||2===t)&&setTimeout((()=>{n&&o.undo(),2===t&&(r.startUndoGroup(o),e.dispose(!0),r.endUndoGroup(o))}),0)}}eventMouseDown(e){this.updateMousePosition(e)}eventMouseUp(e){this.updateMousePosition(e)}initInner(e){var t=this;let o=e.childNodes;this.codeTab&&o[0]!==this.codeTab&&this.domHelpers.unbindAllEvents(),this.codeTab=o[0],this.costTab=o[1],this.costTabBody=document.querySelector("div[aria-labelledby="+this.costTab.id+"]"),this.domHelpers.bindOnce(document,"keydown",(function(){return t.eventKeyDown(...arguments)}),!0),this.domHelpers.bindOnce(document,"mousemove",(function(){return t.eventMouseMove(...arguments)}),!0),this.domHelpers.bindOnce(document,"mousedown",(function(){return t.eventMouseDown(...arguments)}),!0),this.domHelpers.bindOnce(document,"mouseup",(function(){return t.eventMouseUp(...arguments)}),!0)}}class a{constructor(e,t,o){this.x=e,this.count=t,this.blocks=o}}const c={"userscript.js":async function(e){let{addon:t,console:o,msg:n,safeMsg:s}=e;new i(t,n,s).init()},"icon--close.svg":"data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA3LjQ4IDcuNDgiPjxkZWZzPjxzdHlsZT4uY2xzLTF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6MnB4O308L3N0eWxlPjwvZGVmcz48dGl0bGU+aWNvbi0tYWRkPC90aXRsZT48bGluZSBjbGFzcz0iY2xzLTEiIHgxPSIzLjc0IiB5MT0iNi40OCIgeDI9IjMuNzQiIHkyPSIxIi8+PGxpbmUgY2xhc3M9ImNscy0xIiB4MT0iMSIgeTE9IjMuNzQiIHgyPSI2LjQ4IiB5Mj0iMy43NCIvPjwvc3ZnPg=="}},1793:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return s}));var n=o(1735);const s={"userscript.js":async function(e){let{addon:t,console:o,msg:n}=e;const s=await t.tab.traps.getPaper(),r=await t.tab.waitForElement("[class^='paint-editor_canvas-container']");try{if(!("colorIndex"in t.tab.redux.state.scratchPaint.fillMode))return void o.error("Detected new paint editor; this will be supported in future versions.")}catch(e){}const i=r[t.tab.traps.getInternalKey(r)].child.child.child.stateNode,a=[],c=e=>{const t=e.substr(1),o=parseInt(t,16);return[o>>16&255,o>>8&255,255&o]},l={enabled:t.settings.get("default")&&!t.self.disabled,previous:+t.settings.get("previous"),next:+t.settings.get("next"),opacity:+t.settings.get("opacity"),opacityStep:+t.settings.get("opacityStep"),layering:t.settings.get("layering"),mode:t.settings.get("mode"),beforeTint:c(t.settings.get("beforeTint")),afterTint:c(t.settings.get("afterTint"))},d=()=>s.project.layers.find((e=>e.data.isBackgroundGuideLayer)).children[0].position;let u=0;const p=()=>++u,h=()=>{p();const e=s.project;if(!e)return;a.length=0;const t=e.layers;for(let e=t.length-1;e>=0;e--){const o=t[e];o.data.sa_isOnionLayer&&o.remove()}},g=()=>{const e=s.project;if(!e)return;const t=e.layers.find((e=>e.data.sa_isOnionLayer));if(t)if("front"===l.layering)e.addLayer(t);else{0===e.layers.find((e=>e.data.isRasterLayer)).index?e.insertLayer(0,t):e.insertLayer(1,t)}},m=(e,t)=>{if(e.children)for(const o of e.children)m(o,t);t(e)},f=(e,t,o,n)=>{const s=n?l.beforeTint:l.afterTint,r=(e+t+o)/3/255/1.5+(1-1/1.5);return[s[0]*r,s[1]*r,s[2]*r]},b=(e,t)=>(e=>{let[t,o,n]=e;const s=Math.round(t).toString(16).padStart(2,"0"),r=Math.round(o).toString(16).padStart(2,"0"),i=Math.round(n).toString(16).padStart(2,"0");return"#".concat(s).concat(r).concat(i)})(f(255*e.red,255*e.green,255*e.blue,t)),y=(e,t)=>{const{width:o,height:n}=e.canvas,s=e.context,r=s.getImageData(0,0,o,n),i=r.data;for(let e=0;e<i.length;e+=4){const o=i[e+0],n=i[e+1],s=i[e+2];if(0===i[e+3])continue;const r=f(o,n,s,t);i[e+0]=r[0],i[e+1]=r[1],i[e+2]=r[2]}s.putImageData(r,0,0)},k=e=>{const t=e.strokeBounds,{width:o,height:n}=t,r=Math.min(3e3/o,3e3/n),i=new s.Raster(new s.Size(o,n));i.remove(),i.smoothing=!0,i.guide=!0,i.locked=!0;let a=0;const c=i.draw;return i.draw=function(){const i=this.getView().getZoom()*window.devicePixelRatio,l=Math.max(1,Math.min(r,2**Math.ceil(Math.log2(i))));if(l>a){a=l;const r=this.canvas,i=this.context,c=o*l,d=n*l;r.width=c,r.height=d,this._size=new s.Size(c,d);const u=t.getTopLeft(),p=t.getBottomRight(),h=new s.Size(p.subtract(u)),g=(new s.Matrix).scale(l).translate(u.negate());i.save(),g.applyToContext(i),e.draw(i,new s.Base({matrices:[g]})),i.restore(),this.matrix.reset(),this.transform((new s.Matrix).translate(u.add(h.divide(2))).scale(1/l))}for(var d=arguments.length,u=new Array(d),p=0;p<d;p++)u[p]=arguments[p];return c.call(this,...u)},i},v=(e,t,o,n)=>new Promise(((r,i)=>{const{rotationCenterX:a,rotationCenterY:c}=t,u=(o=(o=o.split(/<\s*svg:/).join("<")).split(/<\/\s*svg:/).join("</")).match(/<svg [^>]*>/);u&&-1===u[0].indexOf("xmlns=")&&(o=o.replace("<svg ",'<svg xmlns="http://www.w3.org/2000/svg" '));const p=(new DOMParser).parseFromString(o,"text/xml"),h=p.documentElement.attributes.viewBox?p.documentElement.attributes.viewBox.value.match(/\S+/g):null;if(h)for(let e=0;e<h.length;e++)h[e]=parseFloat(h[e]);s.project.importSVG(o,{expandShapes:!0,insert:!1,onLoad:t=>{t?r((e=>{const t=[];return m(e,(e=>{e instanceof s.Raster&&t.push(new Promise(((t,o)=>{e.on("load",(()=>t())),e.on("error",(()=>o(new Error("Raster inside SVG failed to load"))))})))})),Promise.all(t)})(t).then((()=>(t=>{if(t.opacity=e,m(t,(e=>{"PathItem"===e.className&&(e.clockwise=!0),"PointText"===e.className||e.children||e.strokeWidth&&(e.strokeWidth=2*e.strokeWidth),e.locked=!0,e.guide=!0})),t.scale(2,new s.Point(0,0)),"tint"===l.mode){const e=new Set;m(t,(t=>{if(t.strokeColor&&(t.strokeColor=b(t.strokeColor,n)),t.fillColor){const o=t.fillColor.gradient;if(o){if(e.has(o))return;e.add(o);for(const e of o.stops)e.color=b(e.color,n)}else t.fillColor=b(t.fillColor,n)}t.canvas&&y(t,n)}))}const o=d();if(void 0!==a&&void 0!==c){let e=new s.Point(a,c);h&&h.length>=2&&!isNaN(h[0])&&!isNaN(h[1])&&(e=e.subtract(h[0],h[1])),t.translate(o.subtract(e.multiply(2)))}else t.translate(o.subtract(t.bounds.width,t.bounds.height));return k(t)})(t)))):i(new Error("could not load onion skin"))}})})),w=async()=>{const e=s.project;if(!e)return;const n=(()=>{const e=document.querySelector("[class*='selector_list-item'][class*='sprite-selector-item_is-selected']");if(!e)return-1;const t=e.querySelector("[class*='sprite-selector-item_number']");return t?+t.textContent-1:-1})();if(-1===n)return;h();const r=p(),i=t.tab.traps.vm;if(!i)return;const a=e.activeLayer,c=i.editingTarget.sprite.costumes,m=Math.max(0,n-l.previous),f=Math.min(c.length-1,n+l.next);try{const e=[];for(let t=m;t<=f;t++){if(t===n)continue;const o=t<n,s=Math.abs(t-n)-1,r=(l.opacity-l.opacityStep*s)/100;r<=0||e.push({index:t,isBefore:o,opacity:r})}const t=await Promise.all(e.map((e=>{let{index:t,isBefore:o,opacity:n}=e;const r=c[t],a=i.getCostume(t);if("svg"===r.dataFormat)return v(n,r,a,o);if("png"===r.dataFormat||"jpg"===r.dataFormat)return((e,t,o,n)=>new Promise(((r,i)=>{let{rotationCenterX:a,rotationCenterY:c}=t;const u=new Image;u.onload=()=>{const t=d(),o=Math.min(2*t.x,u.width),i=Math.min(2*t.y,u.height);void 0===a&&(a=o/2),void 0===c&&(c=i/2);const p=new s.Raster(u);p.opacity=e,p.guide=!0,p.locked=!0;const h=o/2+(t.x-a),g=i/2+(t.y-c);p.position=new s.Point(h,g),p.remove(),"tint"===l.mode&&y(p,n),r(p)},u.onerror=()=>{i(new Error("could not load image"))},u.src=o})))(n,r,a,o);throw new Error("Unknown data format: ".concat(r.dataFormat))})));if(u===r){const e=(()=>{const e=new s.Layer;return e.locked=!0,e.guide=!0,e.data.sa_isOnionLayer=!0,e})();for(const o of t)e.addChild(o);g()}}catch(e){o.error(e)}a.activate()},I=e=>{l.enabled!==e&&(l.enabled=e,l.enabled?(0===l.next&&0===l.previous&&(l.previous=1,O.previous.value=l.previous),0===l.opacity&&(l.opacity=25,O.opacity.value=l.opacity),w()):h(),S.dataset.enabled=l.enabled)},T=e=>{0===l.previous&&0===l.next||0===l.opacity?I(!1):l.enabled?e?g():w():(l.previous>0||l.next>0)&&I(!0)},x=()=>{const e=document.createElement("div");return e.className="sa-onion-group",e},M=function(){let{useButtonTag:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=document.createElement(e?"button":"span");return t.className="sa-onion-button",t.setAttribute("role","button"),t},N=e=>{const o=document.createElement("img");return o.className="sa-onion-image",o.draggable=!1,o.dataset.image=e,o.loading="lazy",o.src=t.self.getResource("/"+e+".svg"),o},L=x();t.tab.displayNoneWhileDisabled(L,{display:"flex"});const S=M();S.dataset.enabled=l.enabled,S.addEventListener("click",(()=>I(!l.enabled))),S.title=n("toggle"),S.appendChild(N("toggle"));const C=M();C.addEventListener("click",(()=>E(!A()))),C.title=n("settings"),C.appendChild(N("settings")),document.body.addEventListener("click",(e=>{A()&&!e.target.matches(".sa-onion-group *")&&E(!1)}));const D=document.createElement("div");D.className="sa-onion-settings-wrapper",L.append(D,S,C);const _=document.createElement("div");_.className="sa-onion-settings";const E=e=>{C.dataset.enabled=e,_.dataset.visible=e},A=()=>"true"===_.dataset.visible,O={};for(const e of["previous","next","opacity","opacityStep"]){const t=document.createElement("label");t.className="sa-onion-settings-line";const o=document.createElement("div");o.className="sa-onion-settings-label",o.textContent=n(e),t.appendChild(o);const s=x(),r=M(),i=document.createElement("div");i.style.width="20px",r.appendChild(i);const a=document.createElement("input");O[e]=a,a.className="sa-onion-settings-input",a.type="number",a.step="1",a.min="0",a.max="100",a.value=l[e],a.addEventListener("input",(t=>{if(0===a.value.length)return l[e]=0,void T();let o=+a.value;o>+a.max?o=+a.max:o<0&&(o=0),a.value=o,l[e]=o,T()})),a.addEventListener("blur",(()=>{a.value||(a.value="0")})),r.appendChild(a);const c=M();c.appendChild(N("decrement")),c.addEventListener("click",(()=>{l[e]>0&&(l[e]--,a.value=l[e],T())}));const d=M();d.appendChild(N("increment")),d.addEventListener("click",(()=>{l[e]<+a.max&&(l[e]++,a.value=l[e],T())})),s.appendChild(c),s.appendChild(r),s.appendChild(d),t.appendChild(s),_.appendChild(t)}const j=document.createElement("div");j.className="sa-onion-settings-line";const z=document.createElement("div");z.className="sa-onion-settings-label",z.textContent=n("mode");const B=x();j.appendChild(z);const R=M({useButtonTag:!0});R.appendChild(document.createTextNode(n("merge"))),B.appendChild(R),R.addEventListener("click",(e=>{l.mode="merge",W.dataset.enabled=!1,R.dataset.enabled=!0,T()})),R.dataset.enabled="merge"===l.mode;const W=M({useButtonTag:!0});W.appendChild(document.createTextNode(n("tint"))),B.appendChild(W),W.addEventListener("click",(e=>{l.mode="tint",W.dataset.enabled=!0,R.dataset.enabled=!1,T()})),W.dataset.enabled="tint"===l.mode,j.appendChild(B),_.appendChild(j);const Z=document.createElement("div");Z.className="sa-onion-settings-line";const G=document.createElement("div");G.className="sa-onion-settings-label",G.textContent=n("layering");const P=x();Z.appendChild(G);const U=M({useButtonTag:!0});U.appendChild(document.createTextNode(n("front"))),P.appendChild(U),U.addEventListener("click",(e=>{l.layering="front",H.dataset.enabled=!1,U.dataset.enabled=!0,T(!0)})),U.dataset.enabled="front"===l.layering;const H=M({useButtonTag:!0});H.appendChild(document.createTextNode(n("behind"))),P.appendChild(H),H.addEventListener("click",(e=>{l.layering="behind",H.dataset.enabled=!0,U.dataset.enabled=!1,T(!0)})),H.dataset.enabled="behind"===l.layering,Z.appendChild(P),_.appendChild(Z);const Y="http://www.w3.org/2000/svg",V=document.createElementNS(Y,"svg");V.setAttribute("class","sa-onion-settings-tip"),V.setAttribute("width","14"),V.setAttribute("height","7");const F=document.createElementNS(Y,"polygon");F.setAttribute("class","sa-onion-settings-polygon"),F.setAttribute("points","0,0 7,7, 14,0"),V.appendChild(F),_.appendChild(V);let X=null;t.self.addEventListener("disabled",(()=>{E(!1),X=l.enabled,I(!1)})),t.self.addEventListener("reenabled",(()=>{I(X)}));(()=>{const e=s.Project.prototype.addLayer;s.Project.prototype.addLayer=function(t){const o=e.call(this,t);if(t.data.isBackgroundGuideLayer){let t;for(;t=a.shift();)e.call(this,t);g()}return o};const t=s.Project.prototype.importJSON;s.Project.prototype.importJSON=function(e){const o=t.call(this,e);return l.enabled&&w(),o};const o=s.Layer.prototype.remove;s.Layer.prototype.remove=function(){if(this.data.isBackgroundGuideLayer){for(const e of s.project.layers)e.data.sa_isOnionLayer&&a.push(e);for(const e of a)e.remove()}return o.call(this)}})(),(()=>{let e=!1;const t=i.constructor,o=t.prototype.importImage;t.prototype.importImage=function(){e=!0,h();for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return o.call(this,...n)};const n=t.prototype.recalibrateSize;t.prototype.recalibrateSize=function(t){return n.call(this,(()=>{t&&t(),e&&(e=!1,l.enabled&&w())}))},i.recalibrateSize=t.prototype.recalibrateSize.bind(i),i.importImage=t.prototype.importImage.bind(i)})(),(async()=>{let e=!1;for(;;){const o=(await t.tab.waitForElement("[class^='paint-editor_canvas-controls']",{markAsSeen:!0,reduxEvents:["scratch-gui/navigation/ACTIVATE_TAB","scratch-gui/mode/SET_PLAYER","fontsLoaded/SET_FONTS_LOADED","scratch-gui/locales/SELECT_LOCALE","scratch-gui/targets/UPDATE_TARGET_LIST"],reduxCondition:e=>1===e.scratchGui.editorTab.activeTabIndex&&!e.scratchGui.mode.isPlayerOnly})).querySelector("[class^='paint-editor_zoom-controls']");if(t.tab.appendToSharedSpace({space:"paintEditorZoomControls",element:L,order:1}),D.appendChild(_),!e){e=!0;const t=o.firstChild.className,n=o.firstChild.firstChild.className,s=o.firstChild.firstChild.firstChild.className;for(const e of document.querySelectorAll(".sa-onion-group"))e.className+=" "+t;for(const e of document.querySelectorAll(".sa-onion-button"))e.className+=" "+n;for(const e of document.querySelectorAll(".sa-onion-image"))e.className+=" "+s}l.enabled&&w()}})()},"style.css":o.n(n).a,"decrement.svg":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtzdHJva2Utd2lkdGg6LjczNDczNiIgZD0iTTMuMjUgMTEuMzU4aDE3LjUwMXYxLjI4NUgzLjI1eiIvPjwvc3ZnPg==","increment.svg":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSIyNCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtzdHJva2Utd2lkdGg6LjczNDczNiIgZD0iTTMuMjUgMTEuMzU4aDE3LjUwMXYxLjI4NUgzLjI1eiIvPjxwYXRoIHRyYW5zZm9ybT0icm90YXRlKDkwKSIgc3R5bGU9ImZpbGw6IzU3NWU3NTtzdHJva2Utd2lkdGg6LjczNDczNiIgZD0iTTMuMjUtMTIuNjQyaDE3LjUwMXYxLjI4NUgzLjI1eiIvPjwvc3ZnPg==","settings.svg":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggc3R5bGU9Im9wYWNpdHk6Ljc1O2ZpbGw6bm9uZTtzdHJva2U6IzAwMDtzdHJva2Utd2lkdGg6NDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIgZD0iTTU2IDE2djk2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMi4zNzYgLTIuMzc2KSBzY2FsZSguMjI0NjIpIi8+PHBhdGggc3R5bGU9Im9wYWNpdHk6LjU7ZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIiBkPSJNNDAgMzJ2NjQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48cGF0aCBzdHlsZT0ib3BhY2l0eTouMjU7ZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIiBkPSJNMjQgNDh2MzIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48cGF0aCBzdHlsZT0ib3BhY2l0eTouNzU7ZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIiBkPSJNNzIgMTZ2OTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48cGF0aCBzdHlsZT0ib3BhY2l0eTouNTtmaWxsOm5vbmU7c3Ryb2tlOiMwMDA7c3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiIGQ9Ik04OCAzMnY2NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIuMzc2IC0yLjM3Nikgc2NhbGUoLjIyNDYyKSIvPjxwYXRoIHN0eWxlPSJvcGFjaXR5Oi4yNTtmaWxsOm5vbmU7c3Ryb2tlOiMwMDA7c3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiIGQ9Ik0xMDQgNDh2MzIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjM3NiAtMi4zNzYpIHNjYWxlKC4yMjQ2MikiLz48L3N2Zz4=","toggle.svg":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZmlsbD0iI2JmYmZiZiIgZD0iTTM5LjYzMi0uNTc2Yy4wNy0uMDQ2LjE4Ny0uMDIzLjIxLjA3bC42MDYgMi40OTJzMS40OSAxLjA5NSAxLjkzMyAxLjg2M2MuNzQ1IDEuMjgxLjc2OCAyLjMzLjc2OCAyLjMzczEuNjU0LjQ4OCAxLjkzMyAxLjgxNmMuMjggMS4zMjctLjc0NSAzLjg0My01LjEyMyA0LjcwNS00LjM3OS44NjEtNy44OTYtLjMyNy05LjU1LTIuOTgyLTEuNjUzLTIuNjU1Ljk1Ni01LjgyMi44MTYtNS42MzZsLS40OS00LjE2OWMtLjAyMy0uMDkzLjA5NC0uMTYzLjE4Ny0uMTE2bDIuODE4IDEuODRzMS4wNDgtLjM5NiAyLjE0My0uNDQzYTcuMDEgNy4wMSAwIDAgMSAxLjc0Ny4wOTN6IiBzdHlsZT0ib3BhY2l0eTouNTttaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAxMDI2O3N0cm9rZS13aWR0aDouOTMxNjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MCIvPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0iTTQ3LjM2NSA2LjUyOGMtMS4wOTUuODg1LTIuNzcyLjkwOC0yLjc3Mi45MDhtMi40NjkgMS43Yy0xLjQ2Ny4xMTctMi4zNzYtLjMyNi0yLjM3Ni0uMzI2TTI4LjY2MyA2LjQ1OHMyLjAwMy42NTIgMi44MTggMS4zNzRtLjA3LjgxNWMtMS4wMDIuMzk2LTIuNzI1LjE0LTIuNzI1LjE0IiBzdHlsZT0ib3BhY2l0eTouNTttaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAxMDI2O3N0cm9rZS13aWR0aDouOTMxNjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MCIvPjxwYXRoIGZpbGw9IiNiZmJmYmYiIGQ9Ik00MS45NjEgMS43NTNjLjA3LS4wNDYuMTg3LS4wMjMuMjEuMDdsLjYwNiAyLjQ5MnMxLjQ5IDEuMDk1IDEuOTMzIDEuODYzYy43NDUgMS4yODEuNzY4IDIuMzMuNzY4IDIuMzNzMS42NTQuNDg4IDEuOTMzIDEuODE2Yy4yOCAxLjMyNy0uNzQ1IDMuODQzLTUuMTIzIDQuNzA1LTQuMzc5Ljg2MS03Ljg5Ni0uMzI3LTkuNTUtMi45ODItMS42NTMtMi42NTUuOTU2LTUuODIyLjgxNi01LjYzNmwtLjQ5LTQuMTY5Yy0uMDIzLS4wOTMuMDk0LS4xNjMuMTg3LS4xMTZsMi44MTggMS44NHMxLjA0OC0uMzk2IDIuMTQzLS40NDNhNy4wMSA3LjAxIDAgMCAxIDEuNzQ3LjA5M3oiIHN0eWxlPSJvcGFjaXR5Oi43NTttaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAxMDI2O3N0cm9rZS13aWR0aDouOTMxNjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MCIvPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0iTTQ5LjY5NCA4Ljg1N2MtMS4wOTUuODg1LTIuNzcyLjkwOC0yLjc3Mi45MDhtMi40NjkgMS43Yy0xLjQ2Ny4xMTctMi4zNzYtLjMyNi0yLjM3Ni0uMzI2TTMwLjk5MiA4Ljc4N3MyLjAwMy42NTIgMi44MTggMS4zNzRtLjA3LjgxNWMtMS4wMDIuMzk2LTIuNzI1LjE0LTIuNzI1LjE0IiBzdHlsZT0ib3BhY2l0eTouNzU7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMTAyNjtzdHJva2Utd2lkdGg6LjkzMTY7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjAiLz48cGF0aCBmaWxsPSIjYmZiZmJmIiBkPSJNNDQuMjkgNC4wODJjLjA3LS4wNDcuMTg2LS4wMjQuMjEuMDdsLjYwNSAyLjQ5MnMxLjQ5IDEuMDk0IDEuOTMzIDEuODYzYy43NDUgMS4yOC43NjkgMi4zMjkuNzY5IDIuMzI5czEuNjUzLjQ4OSAxLjkzMyAxLjgxNmMuMjggMS4zMjgtLjc0NSAzLjg0My01LjEyNCA0LjcwNS00LjM3OC44NjItNy44OTUtLjMyNi05LjU0OS0yLjk4MS0xLjY1My0yLjY1NS45NTUtNS44MjMuODE1LTUuNjM2bC0uNDg5LTQuMTdjLS4wMjMtLjA5Mi4wOTMtLjE2Mi4xODctLjExNmwyLjgxOCAxLjg0czEuMDQ4LS4zOTYgMi4xNDItLjQ0MmE3LjAxIDcuMDEgMCAwIDEgMS43NDcuMDkzeiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiNmZmY7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDEwMjY7c3Ryb2tlLXdpZHRoOi45MzE2O3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowIi8+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBkPSJNNTIuMDIyIDExLjE4NWMtMS4wOTQuODg1LTIuNzcxLjkwOC0yLjc3MS45MDhtMi40NjggMS43Yy0xLjQ2Ny4xMTctMi4zNzUtLjMyNS0yLjM3NS0uMzI1TTMzLjMyIDExLjExNXMyLjAwMy42NTIgMi44MTggMS4zNzRtLjA3LjgxNmMtMS4wMDEuMzk1LTIuNzI1LjE0LTIuNzI1LjE0IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMTAyNjtzdHJva2Utd2lkdGg6LjkzMTY7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjAiLz48ZyBzdHlsZT0ib3BhY2l0eTouMTg5ODU0Ij48cGF0aCBkPSJNMS4yNDMgOC41YS42MzcuNjM3IDAgMCAwLS40NSAxLjA4NmwuMy4zYy4yNDItLjM1Mi41NDYtLjY1OC44OTgtLjlsLS4yOTctLjNhLjYzNi42MzYgMCAwIDAtLjQ1LS4xODVaIiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6IzAwMTAyNjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6LjE5NjQ5MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjAzNDk2IDAgMCAxLjAzNDk2IC4wNCAtMi42NDcpIi8+PHBhdGggZD0iTTE1LjExNCAxOS41MDZhMy41MDEgMy41MDEgMCAxIDEtNy4wMDMgMCAzLjUwMSAzLjUwMSAwIDAgMSA3LjAwMyAwem0tNy4zOTItNy4zMThhMy41IDMuNSAwIDEgMCAuNDA2IDYuOTg1IDMuNSAzLjUgMCAwIDEgMy4xNS0zLjE1IDMuNSAzLjUgMCAwIDAtMy41NTYtMy44MzV6bS0zLjc0Ni0zLjgyYTMuNTAxIDMuNTAxIDAgMSAwIC4zMzYgNi45ODQgMy41MDIgMy41MDIgMCAwIDEgMy4xNDgtMy4xNDggMy41IDMuNSAwIDAgMC0zLjQ4NC0zLjgzNnoiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTojMDAxMDI2O3N0cm9rZS13aWR0aDouOTMyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiIHRyYW5zZm9ybT0ibWF0cml4KDEuMDM0OTYgMCAwIDEuMDM0OTYgLjA0IC0yLjY0NykiLz48cGF0aCBkPSJNMTQuNDk3IDIxLjQ5MWMtLjI0My4zNTItLjU1LjY1Ni0uOTAyLjg5OWwzLjA4NCAzLjA4NGEuNjM4LjYzOCAwIDAgMCAuOSAwIC42MzcuNjM3IDAgMCAwIDAtLjl6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6IzAwMTAyNjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6LjE5NjQ5MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjAzNDk2IDAgMCAxLjAzNDk2IC4wNCAtMi42NDcpIi8+PC9nPjxnIHN0eWxlPSJvcGFjaXR5Oi44MDU1MyI+PGcgc3R5bGU9Im9wYWNpdHk6LjU4NTkyOCI+PHBhdGggZD0iTTEuMjQzIDguNWEuNjM3LjYzNyAwIDAgMC0uNDUgMS4wODZsLjMuM2MuMjQyLS4zNTIuNTQ2LS42NTguODk4LS45bC0uMjk3LS4zYS42MzYuNjM2IDAgMCAwLS40NS0uMTg1WiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiMwMDEwMjY7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOi4xOTY0OTI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIgdHJhbnNmb3JtPSJtYXRyaXgoMS4wMzQ5NiAwIDAgMS4wMzQ5NiAyLjc3NSAtNS4xNykiLz48cGF0aCBkPSJNMTUuMTE0IDE5LjUwNmEzLjUwMSAzLjUwMSAwIDEgMS03LjAwMyAwIDMuNTAxIDMuNTAxIDAgMCAxIDcuMDAzIDB6bS03LjM5Mi03LjMxOGEzLjUgMy41IDAgMSAwIC40MDYgNi45ODUgMy41IDMuNSAwIDAgMSAzLjE1LTMuMTUgMy41IDMuNSAwIDAgMC0zLjU1Ni0zLjgzNXptLTMuNzQ2LTMuODJhMy41MDEgMy41MDEgMCAxIDAgLjMzNiA2Ljk4NCAzLjUwMiAzLjUwMiAwIDAgMSAzLjE0OC0zLjE0OCAzLjUgMy41IDAgMCAwLTMuNDg0LTMuODM2eiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOm5vbmU7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOm5vbnplcm87c3Ryb2tlOiMwMDEwMjY7c3Ryb2tlLXdpZHRoOi45MzI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIgdHJhbnNmb3JtPSJtYXRyaXgoMS4wMzQ5NiAwIDAgMS4wMzQ5NiAyLjc3NSAtNS4xNykiLz48cGF0aCBkPSJNMTQuNDk3IDIxLjQ5MWMtLjI0My4zNTItLjU1LjY1Ni0uOTAyLjg5OWwzLjA4NCAzLjA4NGEuNjM4LjYzOCAwIDAgMCAuOSAwIC42MzcuNjM3IDAgMCAwIDAtLjl6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6IzAwMTAyNjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6LjE5NjQ5MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjAzNDk2IDAgMCAxLjAzNDk2IDIuNzc1IC01LjE3KSIvPjwvZz48L2c+PHBhdGggZmlsbD0iI2Q5OWU4MiIgZD0iTTIxLjkwNyAxOS4xM2EuNjM2LjYzNiAwIDAgMS0uNDUtLjE4NUw1LjU3MiAzLjA1OGEuNjM3LjYzNyAwIDAgMSAuOS0uOWwxNS44ODUgMTUuODg2YS42MzcuNjM3IDAgMCAxLS40NSAxLjA4N3oiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDojMDAxMDI2O2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDouMTk2NDkyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiIHRyYW5zZm9ybT0ibWF0cml4KDEuMDM0OTYgMCAwIDEuMDM0OTYgLjYxNyAtMS4zMykiLz48cGF0aCBmaWxsPSIjZmNiMWUzIiBkPSJNMTIuMjUzIDUuMzRhMy41IDMuNSAwIDEgMS03IDAgMy41IDMuNSAwIDAgMSA3IDB6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2ZlZmVmZDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6IzAwMTAyNjtzdHJva2Utd2lkdGg6LjkzMjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjAzNDk2IDAgMCAxLjAzNDk2IC42MTcgLTEuMzMpIi8+PHBhdGggZmlsbD0iI2ZmZDk4MyIgZD0iTTExLjc2OCAxMi41NjZhMy41IDMuNSAwIDEgMSAxLjYxLTYuODEzIDMuNSAzLjUgMCAwIDEtMS42MSA2LjgxM3oiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDojZmVmZWZkO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTojMDAxMDI2O3N0cm9rZS13aWR0aDouOTMyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiIHRyYW5zZm9ybT0ibWF0cml4KDEuMDM0OTYgMCAwIDEuMDM0OTYgLjYxNyAtMS4zMykiLz48cGF0aCBmaWxsPSIjYTZkMzg4IiBkPSJNMTkuODkyIDEyLjk3N2EzLjUwMSAzLjUwMSAwIDEgMS03LjAwMyAwIDMuNTAxIDMuNTAxIDAgMCAxIDcuMDAzIDB6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2ZlZmVmZDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6IzAwMTAyNjtzdHJva2Utd2lkdGg6LjkzMjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjAzNDk2IDAgMCAxLjAzNDk2IC42MTcgLTEuMzMpIi8+PHBhdGggZmlsbD0iI2Q5OWU4MiIgZD0iTTIxLjkwNyAxOS4xM2EuNjM2LjYzNiAwIDAgMS0uNDUtLjE4NWwtMy44OTgtMy45YS42MzYuNjM2IDAgMSAxIC45LS45bDMuODk4IDMuOWEuNjM3LjYzNyAwIDAgMS0uNDUgMS4wODZ6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6IzAwMTAyNjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6LjE5NjQ5MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjAzNDk2IDAgMCAxLjAzNDk2IC42MTcgLTEuMzMpIi8+PC9zdmc+"}},1794:function(e,t,o){"use strict";var n;function s(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o.r(t),o.d(t,"resources",(function(){return ee}));const r=0,i=1,a=2,c=3,l=4,d=5;class u{constructor(e,t,o){if(this.constructor===u)throw new Error("Abstract classes can't be instantiated.");this.type=e,this.inputIdx=t,this.fieldIdx=o,this.defaultValue=null}setValue(e,t){throw new Error("Sub-class must override abstract method.")}getInput(e){return e.inputList[this.inputIdx]}getField(e){return-1===this.fieldIdx?this.getInput(e).connection.targetBlock().inputList[0].fieldRow[0]:this.getInput(e).fieldRow[this.fieldIdx]}}class p extends u{constructor(e,t,o,n){if(super(e,t,o),this.constructor===p)throw new Error("Abstract classes can't be instantiated.");this.defaultValue=n}setValue(e,t){if(t instanceof k){const o=t.createWorkspaceForm();if(!o.outputConnection)throw new Error('Cannot put block "'+o.typeInfo.id+'" into a round type input.');o.outputConnection.connect(this.getInput(e).connection)}else this.getField(e).setValue(this._toFieldValue(t))}_toFieldValue(e){throw new Error("Sub-class must override abstract method.")}}class h extends p{constructor(e,t,o){super(r,e,t,o)}_toFieldValue(e){const t=typeof e;if("number"===t)return e;if("string"===t)return e;throw new Error("Cannot set round type input to value of type "+t)}}class g extends p{constructor(e,t,o){super(i,e,t,o)}_toFieldValue(e){const t=typeof e;if("number"===t)return e;if("string"===t){if(0===e.length)return e;const t=parseFloat(e);if(isNaN(t))throw new Error('Cannot set numeric type input to string "'+e+'".');return e}throw new Error("Cannot set round type input to value of type "+t)}}class m extends u{constructor(e,t){super(a,e,t)}setValue(e,t){if(!(t instanceof k))throw new Error("Boolean type inputs can only contain blocks.");{const o=t.createWorkspaceForm();if(!o.outputConnection||t.typeInfo.shape!==v.Boolean)throw new Error('Cannot put block "'+t.typeInfo.id+'" into a boolean type input.');o.outputConnection.connect(this.getInput(e).connection)}}}class f extends u{constructor(e,t){super(c,e,t)}setValue(e,t){if("string"!=typeof t)throw new Error("Cannot set color type input to value of type "+typeof type);if(!t.match(/^#[0-9a-fA-F]{6}$/))throw new Error('Invalid color "'+t+'".');this.getField(e).setValue(t)}}class b extends u{constructor(e,t,o,n){super(l,t,o),this.values=[];for(let t=0;t<e.length;t++)"string"==typeof e[t][1]&&-1===b.INVALID_VALUES.indexOf(e[t][1])&&this.values.push({value:e[t][1],string:e[t][0].replaceAll(String.fromCharCode(160)," ")});this.isRound=n,this.defaultValue=this.values[0]}setValue(e,t){if(this.isRound&&t instanceof k)t.createWorkspaceForm().outputConnection.connect(this.getInput(e).connection);else{if(-1===this.values.indexOf(t))throw new Error("Invalid enum value. Expected item from the values list.");this.getField(e).setValue(t.value)}}}s(b,"INVALID_VALUES",["DELETE_VARIABLE_ID","RENAME_VARIABLE_ID","NEW_BROADCAST_MESSAGE_ID","NEW_BROADCAST_MESSAGE_ID","createGlobalVariable","createLocalVariable","createGlobalList","createLocalList","createBroadcast","RENAME_BROADCAST_MESSAGE_ID"]);class y extends u{constructor(e,t){super(d,e,t)}setValue(e,t){if(!(t instanceof k))throw new Error("Block type inputs can only contain blocks.");{const o=t.createWorkspaceForm();if(!o.previousConnection||!t.typeInfo.shape.canStackUp)throw new Error('Cannot put block "'+t.typeInfo.id+'" into a block type input.');o.previousConnection.connect(this.getInput(e).connection)}}}class k{constructor(e){this.typeInfo=e;for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];this.inputs=o;for(let e=0;e<this.typeInfo.inputs.length;e++)null==this.inputs[e]&&(this.inputs[e]=this.typeInfo.inputs[e].defaultValue)}createWorkspaceForm(){"control_stop"===this.typeInfo.id&&this.typeInfo.domForm.querySelector("mutation").setAttribute("hasnext",""+("other scripts in sprite"===this.inputs[0].value));const e=this.typeInfo.Blockly.Xml.domToBlock(this.typeInfo.domForm,this.typeInfo.workspace);for(let t=0;t<this.typeInfo.inputs.length;t++){const o=this.inputs[t];null!=o&&this.typeInfo.inputs[t].setValue(e,o)}return e}}class v{static getBlockShape(e){return 2===e.edgeShape_?v.Round:1===e.edgeShape_?v.Boolean:e.startHat_?v.Hat:e.nextConnection?v.Stack:v.End}constructor(e,t,o){this.canStackUp=e,this.canStackDown=t,this.canBeRound=o}}s(v,"Round",new(n=v)(!1,!1,!0)),s(v,"Boolean",new n(!1,!1,!0)),s(v,"Hat",new n(!1,!0,!1)),s(v,"End",new n(!0,!1,!1)),s(v,"Stack",new n(!0,!0,!1));class w{static getBlockCategory(e,t){let o;return o="procedures_call"===e.type?t.getAddonBlock(e.getProcCode())?"addon-custom-block":"more":e.usesDefaultExtensionColors?"pen":"sensing_of"===e.type?"sensing":"event_whenbackdropswitchesto"===e.type?"events":e.category_,{name:o,colorPrimary:e.colour_,colorSecondary:e.colourSecondary_,colorTertiary:e.colourTertiary_}}static getBlocks(e,t,o,n){var s;const r=null===(s=o.getToolbox())||void 0===s?void 0:s.flyout_.getWorkspace();if(!r)return[];const i=[],a=e.Xml.workspaceToDom(r),c={};for(const e of a.children)if("BLOCK"===e.tagName){c[e.getAttribute("id")]=e}for(const s of r.getTopBlocks())i.push(...w._createBlocks(o,t,e,n,s,c[s.id]));return i}static _createBlocks(e,t,o,n,s,r){let i=[],a=[];const c=e=>{i.push(e),a.push(e)},l=(e,t,s)=>{if("blocklyText blocklyDropdownText"===e.className_){const o=e.getOptions();c(new b(o,t,s,-1===s))}else if(e instanceof o.FieldImage)switch(e.src_.split("/").pop()){case"green-flag.svg":i.push(n("/_general/blocks/green-flag"));break;case"rotate-right.svg":i.push(n("/_general/blocks/clockwise"));break;case"rotate-left.svg":i.push(n("/_general/blocks/anticlockwise"))}else e.argType_?"colour"===e.argType_[0]?c(new f(t,s)):"number"===e.argType_[1]?c(new g(t,s,e.text_)):c(new h(t,s,e.text_)):0!==e.getText().trim().length&&i.push(e.getText())};for(let e=0;e<(null===(d=s.inputList)||void 0===d?void 0:d.length);e++){var d;const t=s.inputList[e];for(let o=0;o<t.fieldRow.length;o++)l(t.fieldRow[o],e,o);if(t.connection){const o=t.connection.targetBlock();if(o){if(1!==o.inputList.length||1!==o.inputList[0].fieldRow.length)throw new Error("This should never happen.");l(o.inputList[0].fieldRow[0],e,-1)}else t.outlinePath?c(new m(e,-1)):c(new y(e,-1))}}if("of"===s.id){let n,c,l=[];a[0].isRound?(n=1,c=0):(n=0,c=1);let d=a[n],u=a[c];const p=i.indexOf(d),h=i.indexOf(u),g=[[o.Msg.SENSING_OF_BACKDROPNUMBER,"backdrop #"],[o.Msg.SENSING_OF_BACKDROPNAME,"backdrop name"],[o.Msg.SENSING_OF_VOLUME,"volume"]],m=[[o.Msg.SENSING_OF_XPOSITION,"x position"],[o.Msg.SENSING_OF_YPOSITION,"y position"],[o.Msg.SENSING_OF_DIRECTION,"direction"],[o.Msg.SENSING_OF_COSTUMENUMBER,"costume #"],[o.Msg.SENSING_OF_COSTUMENAME,"costume name"],[o.Msg.SENSING_OF_SIZE,"size"],[o.Msg.SENSING_OF_VOLUME,"volume"]];for(const a of u.values){let f;const y="_stage_"===a.value;if(y){f=t.runtime.getTargetForStage().getAllVariableNamesInScopeByType("").map((e=>[e,e])).concat(g)}else{f=t.runtime.getSpriteTargetByName(a.value).getAllVariableNamesInScopeByType("",!0).map((e=>[e,e])).concat(m)}const k=[];k[n]=new b(f,d.inputIdx,d.fieldIdx,!1),k[c]=new b([[a.string,a.value]],u.inputIdx,u.fieldIdx,y);const v=[...i];v[p]=k[n],v[h]=k[c],l.push(new w(e,o,t,s,r,v,k))}return l}if("control_stop"===s.id){const n=a[0],c=n.values.findIndex((e=>"other scripts in sprite"===e.string)),l=n.values.splice(c,1)[0],d=new b([[l.string,l.value]],n.inputIdx,n.fieldIdx,n.isRound),u=[...i];return u[i.indexOf(n)]=d,[new w(e,o,t,s,r,i,a,v.End),new w(e,o,t,s,r,u,[d],v.Stack)]}return[new w(e,o,t,s,r,i,a)]}constructor(e,t,o,n,s,r,i,a){this.id=n.id,this.workspaceForm=n,this.domForm=s,this.shape=null!=a?a:v.getBlockShape(this.workspaceForm),this.category=w.getBlockCategory(this.workspaceForm,o),this.workspace=e,this.Blockly=t,this.parts=r,this.inputs=i}createBlock(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new k(this,...t)}}function I(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function T(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?I(Object(o),!0).forEach((function(t){x(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):I(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function x(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class M{constructor(e,t,o,n){let{precedence:s=-1,isProper:r=!0,isTruncated:i=!1,isLegal:a=!0,isDefiningFeature:c=!1}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.start=e,this.end=t,this.type=o,this.value=n,this.precedence=s,this.isProper=r,this.isTruncated=i,this.isLegal=a,this.isDefiningFeature=c}createBlockValue(e){return this.type.createBlockValue(this,e)}}class N{constructor(e){if(this.constructor===N)throw new Error("Abstract classes can't be instantiated.");this.shouldCache=e}*parseTokens(e,t,o){throw new Error("Sub-class must override abstract method.")}}class L extends N{constructor(e){super(e.shouldCache),this.inner=e}*parseTokens(e,t,o){yield _.INSTANCE.createToken(t),yield*this.inner.parseTokens(e,t,o)}}class S extends N{constructor(e){super(!1),this.inner=e,this.inner.shouldCache&&(this.cache=[],this.cacheQueryID=null)}*parseTokens(e,t,o){if(!this.inner.shouldCache)return void(yield*this.inner.parseTokens(e,t,o));this.cacheQueryID!==e.id&&(this.cache=[],this.cacheQueryID=e.id);let n=this.cache[t];if(n)yield*n;else{this.cache[t]=n=[];for(const s of this.inner.parseTokens(e,t,o))n.push(s),yield s}}}class C extends N{constructor(){super(!1),this.providers=[],this.illegalProviders=[],this.cache=null,this.cacheQueryID=null,this.hasCacheable=!1}pushProviders(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.hasCacheable)for(const t of e)if(t.shouldCache){this.hasCacheable=!0;break}t?this.providers.push(...e):this.illegalProviders.push(...e)}*parseTokens(e,t,o){if(!this.hasCacheable){for(const n of this.providers)yield*n.parseTokens(e,t,o);return}if(this.cacheQueryID!==e.id)this.cache=[],this.cacheQueryID=e.id;else{const n=this.cache[t];if(n){const s=n.tokenCaches,r=n.providerCaches;for(let n=0;n<s.length;n++){const i=s[n],a=r[n];for(const n of a)yield*n.parseTokens(e,t,o);yield*i}return}}let n=[],s=[];const r=[n],i=[s];this.cache[t]={tokenCaches:r,providerCaches:i};for(const a of this.providers)if(a.shouldCache)for(const s of a.parseTokens(e,t,o))n.push(s),yield s;else 0!==n.length&&(n=[],s=[],r.push(n),i.push(s)),s.push(a),yield*a.parseTokens(e,t,o);for(const s of this.illegalProviders)for(let r of s.parseTokens(e,t,o))r=T(T({},r),{},{isLegal:!1}),n.push(r),yield r}}class D extends N{constructor(){if(super(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])),this.constructor===D)throw new Error("Abstract classes can't be instantiated.");this.isConstant=!1}createBlockValue(e,t){return e.value}createText(e,t,o){throw new Error("Sub-class must override abstract method.")}getSubtokens(e,t){}}class _ extends D{constructor(){super(),this.isConstant=!0}*parseTokens(e,t,o){yield this.createToken(t)}createToken(e){return new M(e,e,this,null)}createText(e,t){return""}}x(_,"INSTANCE",new _);class E extends D{constructor(e){super(),this.isConstant=1===e.length,this.values=[];for(const t of e){let e=t.string.toLowerCase();const o=[];{let t=0;for(let n=0;n<=e.length;n++){const s=e[n];-1===W.IGNORABLE_CHARS.indexOf(s)&&s||(o.push(e.substring(t,n)),n=W.skipIgnorable(e,n),t=n)}}this.values.push({lower:e,parts:o,value:t})}}*parseTokens(e,t,o){for(let o=0;o<this.values.length;o++){const n=this.values[o];let s=!1;const r=e.length-t,i=e.lowercase.substring(t);let a=!O.isValidNumber(i);if(r<n.lower.length){if(n.lower.startsWith(i)){const o=r<0?0:e.length;yield new M(t,o,this,n,{isTruncated:!0,isDefiningFeature:a}),s=!0}}else e.lowercase.startsWith(n.lower,t)&&(yield new M(t,t+n.lower.length,this,n,{isDefiningFeature:a}),s=!0)}}createBlockValue(e,t){return e.value.value}createText(e,t,o){return e?e.value.lower:this.values[0].lower}}class A extends D{static isTerminator(e){return this.TERMINATORS.includes(e)}*parseTokens(e,t,o){let n=-1;if('"'===e.str[t]||"'"===e.str[t]){const o=e.str[t];let s="",r=t+1;for(let i=t+1;i<=e.length;i++)if("\\"===e.str[i])s+=e.str.substring(r,i),r=++i;else if(e.str[i]===o){yield new M(t,i+1,this,s+e.str.substring(r,i)),n=i+1;break}}let s=!1,r=!1;for(let o=t;o<=e.length;o++){const i=A.isTerminator(e.str[o]),a=W.IGNORABLE_CHARS.includes(e.str[o]);if((s!==i||o==e.length)&&!r&&o!==t&&o!==n){const n=e.str.substring(t,o);yield new M(t,o,this,n)}s=i,r=a}}createText(e,t,o){return t.str.substring(e.start,e.end)}}x(A,"TERMINATORS",[void 0," ","+","-","*","/","=","<",">",")"]);class O extends D{static isValidNumber(e){return!isNaN(+e)||!isNaN(parseFloat(+e))}*parseTokens(e,t,o){for(let o=t;o<=e.length;o++)if(A.isTerminator(e.str[o])&&o!==t){const n=e.str.substring(t,o);if(O.isValidNumber(n)){yield new M(t,o,this,n);break}}}createText(e,t,o){return t.str.substring(e.start,e.end)}}class j extends D{*parseTokens(e,t,o){if(e.str.startsWith("#",t)){for(let o=0;o<6;o++)if(-1===j.HEX_CHARS.indexOf(e.lowercase[t+o+1]))return;yield new M(t,t+7,this,e.str.substring(t,t+7))}}createText(e,t,o){return t.query.substring(e.start,e.end)}}x(j,"INSTANCE",new L(new j)),x(j,"HEX_CHARS",["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]);class z extends D{constructor(e){super(),this.tokenProvider=e}*parseTokens(e,t,o){const n=t;if("("===e.str[t++]){t=e.skipIgnorable(t);for(const r of this.tokenProvider.parseTokens(e,t,o)){if(r.type instanceof _)continue;var s=e.skipIgnorable(r.end);let t=r.isTruncated;if(!t)if(s===e.length)t=!0;else{if(")"!==e.str[s])continue;++s}const o=new M(n,s,this,r.value,{precedence:0,isTruncated:t,isLegal:r.isLegal});o.innerToken=r,yield o}}}createBlockValue(e,t){return e.innerToken.createBlockValue(e.innerToken,t)}createText(e,t,o){let n="(";return n+=t.str.substring(e.start+1,e.innerToken.start),n+=e.innerToken.type.createText(e.innerToken,t,o),e.innerToken.end!==e.end&&(n+=t.str.substring(e.innerToken.end,e.end-1)),n+=")",n}getSubtokens(e,t){return[e.innerToken]}}class B extends D{constructor(e,t){var o;super(),o=this,this.block=t,this.hasSubTokens=!0,this.fullTokenProviders=[];for(const o of t.parts){let t;if("string"==typeof o)t=new E([{value:null,string:o}]);else switch(o.type){case l:if(t=new E(o.values),o.isRound){const o=new C;o.pushProviders([t,e.tokenGroupRoundBlocks]),t=o}break;case r:t=e.tokenGroupString;break;case i:t=e.tokenGroupNumber;break;case c:t=j.INSTANCE;break;case a:t=e.tokenGroupBoolean;break;case d:t=e.tokenGroupStack}this.fullTokenProviders.push(t)}this.stringForms=[];const n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(;e<t.parts.length;e++){let o=t.parts[e];if("string"==typeof o)i+=o.length,s.push(...o.toLowerCase().split(" "));else{if(o.type===l){for(const t of o.values)n(e+1,[...s,...t.string.toLowerCase().split(" ")],[...r,t],i+t.string.length);return}r.push(null)}}o.stringForms.push({strings:s,inputs:r,length:i})};n()}*parseTokens(e,t,o){if(0!==o&&!e.canCreateMoreNestedBlocks())return;let n=!1;for(const o of this._parseSubtokens(e,t,this.fullTokenProviders)){let s=this._createToken(e,t,this.fullTokenProviders,o);s&&(yield s,n=!0)}if(!n)e:for(const o of this.stringForms){let n=-1,s=t,r=!1;for(;;){s=e.skipIgnorable(s);const i=e.skipUnignorable(s);if(i===s){r&&(yield new M(t,i,this,{stringForm:o,lastPartIdx:-1},{isProper:!1}));break}{const a=e.lowercase.substring(s,i);let c=-1;for(let e=n+1;e<o.strings.length;e++){if(o.strings[e].startsWith(a)){c=e;break}}if(-1===c)continue e;n=c,r||(r=!O.isValidNumber(a)),e.skipIgnorable(i)<e.length&&r&&(yield new M(t,i,this,{stringForm:o,lastPartIdx:n,i:s},{isProper:!1})),s=i}}}}_createToken(e,t,o,n){n.reverse();let s=!0,r=n.length<o.length,i=!1;for(const t of n)r|=t.isTruncated,s&&(s=t.isLegal),t.isDefiningFeature&&t.start<e.length&&(i=!0);if(!i)return null;const a=e.skipIgnorable(n[n.length-1].end);return new M(t,a,this,{subtokens:n},{precedence:this.block.precedence,isTruncated:r,isLegal:s})}_parseSubtokens(e,t,o,n){var s=this;let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return function*(){t=e.skipIgnorable(t);let a=o[r];for(const c of a.parseTokens(e,t,n+1)){if(++e.tokenCount,!e.canCreateMoreTokens())break;if(0!==n&&!e.canCreateMoreNestedBlocks())break;if(-1!==s.block.precedence){if(c.precedence>s.block.precedence&&(0===r||!(c.type instanceof B)||"operator_not"!==c.type.block.id))continue;if(c.precedence===s.block.precedence){if(0!==s.block.parts[r].inputIdx)continue}}if(i&&c.isLegal&&r!==o.length-1)for(const t of s._parseSubtokens(e,c.end,o,n,r+1,!c.isTruncated))t.push(c),yield t;else yield[c]}}()}createBlockValue(e,t){if(!e.isLegal)throw new Error("Cannot create a block from an illegal token.");let o;if(e.value.stringForm)o=e.value.stringForm.inputs;else{const n=e.value.subtokens;o=[];for(let e=0;e<n.length;e++){"string"!=typeof this.block.parts[e]&&o.push(n[e].createBlockValue(t))}for(;o.length<this.block.inputs.length;)o.push(null)}return this.block.createBlock(...o)}createText(e,t,o){if(e.value.stringForm)return o?-1===e.value.lastPartIdx||e.end<=t.length?t.str.substring(e.start,e.end):t.str.substring(e.start,e.end)+e.value.stringForm.strings[e.value.lastPartIdx].substring(e.end-e.value.i)+" "+e.value.stringForm.strings.slice(e.value.lastPartIdx+1).join(" "):e.value.stringForm.strings.join(" ");if(!e.isTruncated&&o)return t.str.substring(e.start,e.end);const n=e.value.subtokens;let s,r="";for(e.start!==n[0].start&&(r+=t.str.substring(e.start,n[0].start)),s=0;s<n.length;s++){var i;const a=n[s];if(!e.isLegal&&a.start>=t.length)break;const c=null!==(i=a.type.createText(a,t,o))&&void 0!==i?i:"";if(r+=c,s!==n.length-1){const e=n[s+1].start;e!==a.end?r+=t.str.substring(a.end,e):(!o||e>=t.length)&&0!==c.length&&-1===W.IGNORABLE_CHARS.indexOf(c.at(-1))&&(r+=" ")}}return r}getSubtokens(e,t){return e.value.subtokens}}class R{constructor(e,t){this.query=e,this.token=t}get isTruncated(){return this.token.isTruncated}toText(e){var t;return null!==(t=this.token.type.createText(this.token,this.query,e))&&void 0!==t?t:""}getBlock(){return this.block||(this.block=this.token.createBlockValue(this.query)),this.block}getLengths(){if(this.lengths)return this.lengths;let e=0,t=0;const o=n=>{let s=0;for(const r of n.typeInfo.parts)if(++t,"string"==typeof r)e+=r.length;else{const t=n.inputs[s++];t instanceof k?o(t):r instanceof b?e+=t.string.length:r instanceof h&&t!==r.defaultValue?e+=100*(""+t).length:null!=t&&(e+=(""+t).length)}e+=n.typeInfo.parts.length-1};return o(this.getBlock()),this.lengths={stringLength:e,tokenLength:t}}}class W{constructor(e,t,o){this.querier=e,this.str=t.replaceAll(String.fromCharCode(160)," "),this.lowercase=this.str.toLowerCase(),this.id=o,this.tokenCount=0,this.resultCount=0}static skipIgnorable(e,t){for(;-1!==W.IGNORABLE_CHARS.indexOf(e[t]);)++t;return t}skipIgnorable(e){return W.skipIgnorable(this.lowercase,e)}static skipUnignorable(e,t){for(;-1===W.IGNORABLE_CHARS.indexOf(e[t])&&t<e.length;)++t;return t}skipUnignorable(e){return W.skipUnignorable(this.lowercase,e)}get length(){return this.str.length}canCreateMoreTokens(){return this.tokenCount<Z.MAX_TOKENS}canCreateMoreNestedBlocks(){return this.canCreateMoreTokens()&&this.resultCount<Z.MAX_RESULTS}}x(W,"IGNORABLE_CHARS",[" "]);class Z{indexWorkspace(e){this._queryCounter=0,this._createTokenGroups(),this._populateTokenGroups(e),this.workspaceIndexed=!0}queryWorkspace(e){if(!this.workspaceIndexed)throw new Error("A workspace must be indexed before it can be queried!");if(0===e.trim().length)return{results:[],illegalResult:null,limited:!1};const t=new W(this,e,this._queryCounter++),o=[];let n=!1,s=null,r="";for(const i of this.tokenGroupBlocks.parseTokens(t,0,0)){if(i.end>=e.length)if(i.isLegal)o.push(new R(t,i));else{const e=i.type.createText(i,t,!0);(!s||e.length<e)&&(s=new R(t,i),r=e)}if(++t.resultCount,!n&&t.resultCount>=Z.MAX_RESULTS&&(console.log("Warning: Workspace query exceeded maximum result count."),n=!0),!t.canCreateMoreTokens()){console.log("Warning: Workspace query exceeded maximum token count."),n=!0;break}}const i=Array(e.length).fill(!0);function a(e){const o=e.type.getSubtokens(e,t);if(o)for(const e of o)a(e);else if(!(e.type instanceof A)&&e.isProper&&!e.isTruncated)for(let t=e.start;t<e.end;t++)i[t]=!1}for(const e of o)a(e.token);function c(e){const o=e.type.getSubtokens(e,t);if(o){for(const e of o)if(!c(e))return!1}else if(e.type instanceof A&&!O.isValidNumber(e.value))for(let t=e.start;t<e.end;t++)if(!i[t])return!1;return!0}let l=[];for(const e of o)c(e.token)&&l.push(e);return l=l.sort(((e,t)=>{const o=e.getLengths(),n=t.getLengths();return o.stringLength!=n.stringLength?o.stringLength-n.stringLength:o.tokenLength-n.tokenLength})),{results:l,illegalResult:0===l.length?s:null,limited:n}}_createTokenGroups(){this.tokenTypeStringLiteral=new S(new A),this.tokenTypeNumberLiteral=new S(new O),this.tokenGroupRoundBlocks=new C,this.tokenGroupBooleanBlocks=new C,this.tokenGroupStackBlocks=new C,this.tokenGroupHatBlocks=new C,this.tokenGroupBoolean=new L(new C),this.tokenGroupBoolean.inner.pushProviders([this.tokenGroupBooleanBlocks,new z(this.tokenGroupBoolean)]),this.tokenGroupBoolean.inner.pushProviders([this.tokenGroupRoundBlocks],!1),this.tokenGroupNumber=new L(new C),this.tokenGroupNumber.inner.pushProviders([this.tokenTypeNumberLiteral,this.tokenGroupRoundBlocks,this.tokenGroupBooleanBlocks,new z(this.tokenGroupNumber)]),this.tokenGroupString=new L(new C),this.tokenGroupString.inner.pushProviders([this.tokenTypeStringLiteral,this.tokenGroupRoundBlocks,this.tokenGroupBooleanBlocks,new z(this.tokenGroupString)]),this.tokenGroupStack=new L(this.tokenGroupStackBlocks),this.tokenGroupBlocks=new C,this.tokenGroupBlocks.pushProviders([this.tokenGroupStackBlocks,this.tokenGroupBooleanBlocks,this.tokenGroupRoundBlocks,this.tokenGroupHatBlocks])}_populateTokenGroups(e){for(const t of e)t.precedence=Z.ORDER_OF_OPERATIONS.indexOf(t.id);for(let t=e.length-1;t>=0;t--){const o=e[t];if(-1!==o.precedence){const n=e.length-(Z.ORDER_OF_OPERATIONS.length-(o.precedence-1));if(t!==n){const s=e[n];e[n]=o,e[t]=s}}}for(const t of e){const e=new B(this,t);switch(t.shape){case v.Round:this.tokenGroupRoundBlocks.pushProviders([e]);break;case v.Boolean:this.tokenGroupBooleanBlocks.pushProviders([e]);break;case v.Stack:case v.End:this.tokenGroupStackBlocks.pushProviders([e]);break;case v.Hat:this.tokenGroupHatBlocks.pushProviders([e])}}}clearWorkspaceIndex(){this.workspaceIndexed=!1,this._destroyTokenGroups()}_destroyTokenGroups(){this.tokenTypeStringLiteral=null,this.tokenTypeNumberLiteral=null,this.tokenGroupBooleanBlocks=null,this.tokenGroupRoundBlocks=null,this.tokenGroupStackBlocks=null,this.tokenGroupHatBlocks=null,this.tokenGroupBoolean=null,this.tokenGroupNumber=null,this.tokenGroupString=null,this.tokenGroupStack=null,this.tokenGroupBlocks=null}}x(Z,"ORDER_OF_OPERATIONS",[null,"operator_join","operator_round","operator_mathop","operator_mod","operator_divide","operator_multiply","operator_subtract","operator_add","operator_equals","operator_lt","operator_gt","operator_or","operator_and","operator_not"]),x(Z,"MAX_RESULTS",2e3),x(Z,"MAX_TOKENS",1e4);var G=o(1652);const P="http://www.w3.org/2000/svg",U={Round:{padding:12,minWidth:20,backgroundPath:e=>"m -12 -20 m 20 0 h ".concat(e-16," a 20 20 0 0 1 0 40 H 8 a 20 20 0 0 1 0 -40 z"),snugglePadding:0,get snuggleWith(){return[U.Round]}},Boolean:{padding:20,minWidth:20,backgroundPath:e=>"m -20 -20 m 20 0 h ".concat(e," l 20 20 l -20 20 H 0 l -20 -20 l 20 -20 z"),snugglePadding:0,get snuggleWith(){return[U.Boolean]}},SquareInput:{padding:8,minWidth:20,backgroundPath:e=>"m -2 -16 h ".concat(e+4," a 4 4 0 0 1 4 4 V 12 a 4 4 0 0 1 -4 4 H -2 a 4 4 0 0 1 -4 -4 V -12 a 4 4 0 0 1 4 -4")},Stack:{padding:8,minWidth:60,backgroundPath:e=>"m -8 -20 A 4 4 0 0 1 -4 -24 H 4 c 2 0 3 1 4 2 l 4 4 c 1 1 2 2 4 2 h 12 c 2 0 3 -1 4 -2 l 4 -4 C 37 -23 38 -24 40 -24 H ".concat(e," a 4 4 0 0 1 4 4 v 40 a 4 4 0 0 1 -4 4 H 40 c -2 0 -3 1 -4 2 l -4 4 c -1 1 -2 2 -4 2 h -12 c -2 0 -3 -1 -4 -2 l -4 -4 c -1 -1 -2 -2 -4 -2 H -4 a 4 4 0 0 1 -4 -4 z")},Hat:{padding:8,minWidth:60,backgroundPath:e=>"m -8 -20 A 4 4 0 0 1 -4 -24 H ".concat(e," a 4 4 0 0 1 4 4 v 40 a 4 4 0 0 1 -4 4 H 40 c -2 0 -3 1 -4 2 l -4 4 c -1 1 -2 2 -4 2 h -12 c -2 0 -3 -1 -4 -2 l -4 -4 c -1 -1 -2 -2 -4 -2 H -4 a 4 4 0 0 1 -4 -4 z")},End:{padding:8,minWidth:60,backgroundPath:e=>"m -8 -20 A 4 4 0 0 1 -4 -24 H 4 c 2 0 3 1 4 2 l 4 4 c 1 1 2 2 4 2 h 12 c 2 0 3 -1 4 -2 l 4 -4 C 37 -23 38 -24 40 -24 H ".concat(e," a 4 4 0 0 1 4 4 v 40 a 4 4 0 0 1 -4 4 H -4 a 4 4 0 0 1 -4 -4 z")},TextInput:{padding:12,minWidth:16,backgroundPath:e=>"m -12 -16 m 16 0 h ".concat(e-8," a 16 16 0 0 1 0 32 H 4 a 16 16 0 0 1 0 -32 z"),snugglePadding:4,get snuggleWith(){return[U.Round]}},BooleanInput:{padding:16,minWidth:16,backgroundPath:e=>"m 0 -16 h ".concat(e," l 16 16 l -16 16 h -16 l -16 -16 l 16 -16 z"),snugglePadding:6,get snuggleWith(){return[U.Boolean]}},HorizontalBlock:{padding:16,minWidth:45,backgroundPath:e=>"M -4 -20 a 4 4 0 0 1 4 -4 H ".concat(e+8," a 4 4 0 0 1 4 4 v 2 c 0 2 -1 3 -2 4 l -4 4 c -1 1 -2 2 -2 4 v 12 c 0 2 1 3 2 4 l 4 4 c 1 1 2 2 2 4 v 2 a 4 4 0 0 1 -4 4 H 0 a 4 4 0 0 1 -4 -4 v -2 c 0 -2 -1 -3 -2 -4 l -4 -4 c -1 -1 -2 -2 -2 -4 v -12 c 0 -2 1 -3 2 -4 l 4 -4 c 1 -1 2 -2 2 -4 z")},HorizontalBlockEnd:{padding:16,minWidth:45,backgroundPath:e=>"M -4 -20 a 4 4 0 0 1 4 -4 H ".concat(e+8," a 4 4 0 0 1 4 4 V 20 a 4 4 0 0 1 -4 4 H 0 a 4 4 0 0 1 -4 -4 v -2 c 0 -2 -1 -3 -2 -4 l -4 -4 c -1 -1 -2 -2 -2 -4 v -12 c 0 -2 1 -3 2 -4 l 4 -4 c 1 -1 2 -2 2 -4 z")}};function H(e){switch(e.typeInfo.shape){case v.End:case v.Hat:case v.Stack:return 62;case v.Boolean:case v.Round:return 48}return 0}const Y=8;class V{constructor(e,t,o,n,s){this.dom=e,this.padding=t,this.width=o,this.snuggleWith=n,this.snugglePadding=s}}function F(e,t,o){let n=o.appendChild(document.createElementNS(P,"text"));return n.setAttribute("class","blocklyText"),n.style.fill="var(".concat(t,")"),n.setAttribute("dominant-baseline","middle"),n.setAttribute("dy",1),n.appendChild(document.createTextNode(e)),new V(n,0,Object(G.b)(n))}function X(){let e=document.createElementNS(P,"g"),t=document.createElementNS(P,"path");return t.setAttribute("class","blocklyPath"),e.appendChild(t),e}function J(e,t,o,n,s,r){r<t.minWidth&&(r=t.minWidth),e.classList.add("sa-block-color"),o&&e.classList.add(o);const i=e.children[0];let a="";return n&&(a+="fill: var(".concat(n,");")),s&&(a+="stroke: var(".concat(s,");")),i.setAttribute("style",a),i.setAttribute("d",t.backgroundPath(r)),new V(e,t.padding,r+2*t.padding,t.snuggleWith,t.snugglePadding)}function Q(e,t,o,n,s,r,i){const a=X();t.appendChild(a);const c=F(e,i,a);c.width<o.minWidth&&c.dom.setAttribute("x",(o.minWidth-c.width)/2);return J(a,o,n,s,r,c.width)}function K(e,t){var o=q(e,t,e.typeInfo.category,!0);return o.dom.classList.add("sa-block-color"),o.dom.setAttribute("transform","translate(".concat(o.padding,", 0)")),o}function q(e,t,o,n){const s=t.appendChild(X()),r=function(e,t){if(e===v.Round)return U.Round;if(e===v.Boolean)return U.Boolean;if(e===v.Stack)return t?U.Stack:U.HorizontalBlock;if(e===v.Hat)return U.Hat;if(e===v.End)return t?U.End:U.HorizontalBlockEnd;throw new Error(e)}(e.typeInfo.shape,n),i=e.typeInfo.category,a=["motion","looks","sounds","events","control","sensing","operators","data","data-lists","list","more","pen","addon-custom-block"].includes(i.name)?"sa-block-color-"+i.name:null;let c=0,l=0;for(let t=0;t<e.typeInfo.parts.length;t++){const o=e.typeInfo.parts[t];let n;if("string"==typeof o)n=F(o,"--sa-block-text",s);else{const t=e.inputs[l++];if(t instanceof k)n=q(t,s,e.typeInfo.category,!1);else if(o instanceof b)n=o.isRound?Q(t.string,s,U.TextInput,a,"--sa-block-background-secondary, ".concat(i.colorSecondary),"--sa-block-background-tertiary, ".concat(i.colorTertiary),"--sa-block-text"):Q(t.string,s,U.SquareInput,a,"--sa-block-background-primary, ".concat(i.colorPrimary),"--sa-block-background-tertiary, ".concat(i.colorTertiary),"--sa-block-text");else if(o instanceof m)n=Q("",s,U.BooleanInput,a,"--sa-block-field-background, ".concat(i.colorTertiary),"--sa-block-field-background, ".concat(i.colorTertiary),"--sa-block-text");else if(o instanceof y)n=Q("",s,U.HorizontalBlock,a,"--sa-block-field-background, ".concat(i.colorTertiary),"--sa-block-field-background, ".concat(i.colorTertiary),"--sa-block-text");else{var d,u;n=Q(null!==(d=null!==(u=null==t?void 0:t.toString())&&void 0!==u?u:o.defaultValue)&&void 0!==d?d:"",s,U.TextInput,a,"--sa-block-input-color, ".concat(i.colorColor),"--sa-block-background-tertiary, ".concat(i.colorTertiary),"--sa-block-input-text"),n.dom.classList.add("blocklyNonEditableText")}}let p=c+n.padding;if((0===t||t===e.typeInfo.parts.length-1)&&n.snuggleWith&&-1!==n.snuggleWith.indexOf(r)){const e=n.snugglePadding-n.padding;n.width+=e,0===t&&(p+=e)}n.dom.setAttribute("transform","translate(".concat(p,", 0)")),c+=Y+n.width}return J(s,r,a,"--sa-block-background-primary, ".concat(i.colorPrimary),"--sa-block-background-tertiary, ".concat(i.colorTertiary),c-Y)}var $=o(1704);const ee={"userscript.js":async function(e){let{addon:t,msg:o,console:n}=e;const s=await t.tab.traps.getBlockly(),r=t.tab.traps.vm,i=50,a=document.body.appendChild(document.createElement("div"));a.classList.add("sa-mcp-root"),a.dir=t.tab.direction,a.style.display="none";const c=a.appendChild(document.createElement("div"));c.classList.add("sa-mcp-container");const l=c.appendChild(document.createElement("div"));l.classList.add(t.tab.scratchClass("input_input-form")),l.classList.add("sa-mcp-input-wrapper");const d=l.appendChild(document.createElement("input"));d.classList.add("sa-mcp-input-suggestion");const u=l.appendChild(document.createElement("input"));u.classList.add("sa-mcp-input"),u.setAttribute("autocomplete","off");const p=c.appendChild(document.createElement("div"));p.classList.add("sa-mcp-preview-container");const h=c.appendChild(document.createElementNS("http://www.w3.org/2000/svg","svg"));h.classList.add("sa-mcp-preview-scrollbar","blocklyScrollbarVertical","blocklyMainWorkspaceScrollbar"),h.style.display="none";const g=h.appendChild(document.createElementNS("http://www.w3.org/2000/svg","rect"));g.setAttribute("width","11"),g.classList.add("blocklyScrollbarBackground");const m=h.appendChild(document.createElementNS("http://www.w3.org/2000/svg","rect"));m.setAttribute("rx","3"),m.setAttribute("ry","3"),m.setAttribute("width","6"),m.setAttribute("x","2.5"),m.classList.add("blocklyScrollbarHandle");const f=p.appendChild(document.createElementNS("http://www.w3.org/2000/svg","svg"));f.classList.add("sa-mcp-preview-blocks");const b=new Z;let y={x:0,y:0};document.addEventListener("mousemove",(e=>{y={x:e.clientX,y:e.clientY}})),document.addEventListener("mousedown",(e=>{y={x:e.clientX,y:e.clientY}}),{capture:!0}),Object(G.c)(O);let k=[],v=null,I=0,T=null,x=!1,M=!0,N=null,L=null,S=0,C=0,D=0,_=0,E=0;function A(){t.self.disabled||"editor"===t.tab.editorMode&&0===t.tab.redux.state.scratchGui.editorTab.activeTabIndex&&(T=w.getBlocks(s,r,s.getMainWorkspace(),o),b.indexWorkspace([...T]),T.sort(((e,t)=>{const o=e=>["operators","data"].indexOf(e.category.name)-e.id.startsWith("data_");return o(t)-o(e)})),D=5e-5*window.innerWidth+t.settings.get("popup_scale")/100,S=window.innerWidth*t.settings.get("popup_width")/100,E=window.innerHeight*t.settings.get("popup_max_height")/100,c.style.width=S+"px",L={x:y.x,y:y.y},a.style.display="",u.value="",u.focus(),j())}function O(){M&&(L=null,N=null,a.style.display="none",T=null,b.clearWorkspaceIndex())}function j(){const e=[];if(0===u.value.trim().length){if(v=null,T)for(const t of T)e.push({block:t.createBlock()});x=!1}else{const t=b.queryWorkspace(u.value),o=t.results;v=t.illegalResult,x=t.limited,o.length>i&&(o.length=i);for(const t of o)e.push({block:t.getBlock(),autocompleteFactory:e=>t.toText(e)})}for(;f.firstChild;)f.removeChild(f.lastChild);k.length=0;let t=0;for(let n=0;n<e.length;n++){var o;const s=e[n],r=()=>{z(n)},i=e=>{e.stopPropagation(),e.preventDefault(),z(n),M=!e.shiftKey,W(),M=!0,e.shiftKey&&u.focus()},a=f.appendChild(document.createElementNS("http://www.w3.org/2000/svg","rect")),c=H(s.block);a.setAttribute("transform","translate(0, ".concat((t+c/10)*D,")")),a.setAttribute("height",c*D+"px"),a.classList.add("sa-mcp-preview-block-bg"),a.addEventListener("mousemove",r),a.addEventListener("mousedown",i);const l=f.appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));l.addEventListener("mousemove",r),l.addEventListener("mousedown",i),l.classList.add("sa-mcp-preview-block");const d=K(s.block,l);k.push({block:s.block,autocompleteFactory:null!==(o=s.autocompleteFactory)&&void 0!==o?o:null,renderedBlock:d,svgBlock:l,svgBackground:a}),t+=c}const n=(t+8)*D;C=n<_?_:n>E?E:n,f.setAttribute("height","".concat(n,"px")),p.style.height=C+"px",h.style.height=C+"px",g.setAttribute("height",""+C),l.dataset.error=""+x,N={x:L.x+16,y:L.y-8};const s=c.getBoundingClientRect().height,r=N.y+s;r>window.innerHeight&&(N.y-=r-window.innerHeight),a.style.top=N.y+"px",a.style.left=N.x+"px",I=-1,z(0),B(),R()}function z(e){if(I===e)return;const t=k[I];if(t&&(t.svgBackground.classList.remove("sa-mcp-preview-block-bg-selection"),t.svgBlock.classList.remove("sa-mcp-preview-block-selection")),0===k.length&&v)return void(d.value=u.value+v.toText(!0).substring(u.value.length));const o=k[e];o&&o.autocompleteFactory?(o.svgBackground.classList.add("sa-mcp-preview-block-bg-selection"),o.svgBlock.classList.add("sa-mcp-preview-block-selection"),o.svgBackground.scrollIntoView({block:"nearest",behavior:Math.abs(e-I)>1?"smooth":"auto"}),d.value=u.value+o.autocompleteFactory(!0).substring(u.value.length)):d.value="",I=e}function B(){var e;const t=null!==(e=u.selectionStart)&&void 0!==e?e:0,o=0===u.value.length?0:t/u.value.length;let n=0;for(let e=0;e<k.length;e++){const t=k[e];var s=5;s+t.renderedBlock.width>S/D&&(s+=(S/D-s-t.renderedBlock.width)*D*o);var r=(n+30)*D;t.svgBlock.setAttribute("transform","translate(".concat(s,", ").concat(r,") scale(").concat(D,")")),n+=H(t.block)}d.scrollLeft=u.scrollLeft}function R(){const e=p.scrollTop,t=p.scrollHeight;if(t<=C)return void(h.style.display="none");const o=C/t*C,n=e/t*C;h.style.display="",m.setAttribute("height",""+o),m.setAttribute("y",""+n)}function W(){const e=k[I];if(!e)return;const t=s.getMainWorkspace();let o;t.setResizesEnabled(!1),s.Events.disable();try{if(o=e.block.createWorkspaceForm(),s.scratchBlocksUtils.changeObscuredShadowIds(o),!o.getSvgRoot())throw new Error("newBlock is not rendered.");let n=o.svgPath_.getBoundingClientRect(),r=Math.floor((y.x-(n.left+n.right)/2)/t.scale),i=Math.floor((y.y-(n.top+n.bottom)/2)/t.scale);o.moveBy(r,i)}finally{s.Events.enable()}s.Events.isEnabled()&&s.Events.fire(new s.Events.BlockCreate(o));let n={clientX:y.x,clientY:y.y,type:"mousedown",stopPropagation:function(){},preventDefault:function(){},target:e.svgBlock};t.getGesture(n)&&t.startDragWithFakeEvent(n,o)}u.addEventListener("input",j),document.addEventListener("selectionchange",B),p.addEventListener("scroll",R),u.addEventListener("keydown",(e=>{switch(e.key){case"Escape":u.value.length>0?(u.value="",j()):O(),e.stopPropagation(),e.preventDefault();break;case"Tab":!function(){let e;e=k[I]?k[I].autocompleteFactory:()=>d.value,0!==d.value.length&&e&&(u.value=e(!1),u.selectionStart=u.value.length+1,j())}(),e.stopPropagation(),e.preventDefault();break;case"Enter":W(),O(),e.stopPropagation(),e.preventDefault();break;case"ArrowDown":I+1>=k.length?z(0):z(I+1),e.stopPropagation(),e.preventDefault();break;case"ArrowUp":z(I-1<0?k.length-1:I-1),e.stopPropagation(),e.preventDefault()}})),u.addEventListener("focusout",O),document.addEventListener("keydown",(e=>{" "===e.key&&(e.ctrlKey||e.metaKey)&&(A(),e.preventDefault(),e.stopPropagation())}));const P=s.Gesture.prototype.doWorkspaceClick_;s.Gesture.prototype.doWorkspaceClick_=function(){(1===this.mostRecentEvent_.button||this.mostRecentEvent_.shiftKey)&&A(),y={x:this.mostRecentEvent_.clientX,y:this.mostRecentEvent_.clientY},P.call(this)};const U=s.WorkspaceSvg.prototype.isDeleteArea;s.WorkspaceSvg.prototype.isDeleteArea=function(e){return N&&e.clientX>N.x&&e.clientX<N.x+S&&e.clientY>N.y&&e.clientY<N.y+C?s.DELETE_AREA_TOOLBOX:U.call(this,e)}},"userstyle.css":o.n($).a}},1804:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return a}));class n{constructor(e,t,o,n){this.cls=e,this.procCode=t,this.labelID=o,this.y=n,this.lower=t.toLowerCase(),this.clones=null,this.eventName=null}matchesID(e){if(this.labelID===e)return!0;if(this.clones)for(const t of this.clones)if(t===e)return!0;return!1}}var s=o(1662),r=o(1660),i=o(1703);const a={"userscript.js":async function(e){let{addon:t,msg:o,console:i}=e;const a=await t.tab.traps.getBlockly();class c{constructor(e){this.utils=e,this.el=null,this.items=[],this.selected=null,this.carousel=new l(this.utils)}get workspace(){return a.getMainWorkspace()}createDom(){return this.el=document.createElement("ul"),this.el.className="sa-find-dropdown",this.el}inputKeyDown(e){return"ArrowUp"===e.key?(this.navigateFilter(-1),void e.preventDefault()):"ArrowDown"===e.key?(this.navigateFilter(1),void e.preventDefault()):"Enter"===e.key?(this.selected&&this.navigateFilter(1),void e.preventDefault()):void this.carousel.inputKeyDown(e)}navigateFilter(e){let t;for(this.selected&&"none"!==this.selected.style.display?t=-1===e?this.selected.previousSibling:this.selected.nextSibling:(t=this.items[0],e=1);t&&"none"===t.style.display;)t=-1===e?t.previousSibling:t.nextSibling;t&&(t.scrollIntoView({block:"nearest"}),this.onItemClick(t))}addItem(e){const t=document.createElement("li");t.innerText=e.procCode,t.data=e;const o={receive:"events",event:"events",define:"more",var:"data",VAR:"data",list:"data-lists",LIST:"data-lists",costume:"looks",sound:"sounds"};if("flag"===e.cls)t.className="sa-find-flag";else{const n=o[e.cls];t.className="sa-block-color sa-block-color-".concat(n)}return t.addEventListener("mousedown",(e=>(this.onItemClick(t),e.preventDefault(),e.cancelBubble=!0,!1))),this.items.push(t),this.el.appendChild(t),t}onItemClick(e,o){this.selected&&this.selected!==e&&(this.selected.classList.remove("sel"),this.selected=null),this.selected!==e&&(e.classList.add("sel"),this.selected=e);let n=e.data.cls;if("costume"===n||"sound"===n){const o=document.querySelector("[class^=asset-panel_wrapper]");if(o){o[t.tab.traps.getInternalKey(o)].child.stateNode.props.onItemClick(e.data.y);o.firstChild.firstChild.children[e.data.y].scrollIntoView({behavior:"auto",block:"center",inline:"start"}),o.closest("div[class*=gui_flex-wrapper]").scrollTop=0}}else if("var"===n||"VAR"===n||"list"===n||"LIST"===n){let t=this.getVariableUsesById(e.data.labelID);this.carousel.build(e,t,o)}else if("define"===n){let t=this.getCallsToProcedureById(e.data.labelID);this.carousel.build(e,t,o)}else if("receive"===n){let t=this.getCallsToEventsByName(e.data.eventName);if(!o){const e=this.utils.getEditingTarget().id;for(const n of t)if(n.targetId===e){o=n;break}}this.carousel.build(e,t,o)}else if(e.data.clones){let t=[this.workspace.getBlockById(e.data.labelID)];for(const o of e.data.clones)t.push(this.workspace.getBlockById(o));this.carousel.build(e,t,o)}else this.utils.scrollBlockIntoView(e.data.labelID),this.carousel.remove()}getVariableUsesById(e){let t=[],o=this.workspace.getTopBlocks();for(const n of o){let o=n.getDescendants();for(const n of o){let o=n.getVarModels();if(o)for(const s of o)s.getId()===e&&t.push(n)}}return t}getCallsToProcedureById(e){let t=this.workspace.getBlockById(e),o=t.getChildren()[0].getProcCode(),n=[t],s=this.workspace.getTopBlocks();for(const e of s){let t=e.getDescendants();for(const e of t)"procedures_call"===e.type&&e.getProcCode()===o&&n.push(e)}return n}getCallsToEventsByName(e){let n=[];const r=t.tab.traps.vm.runtime.targets;for(const t of r){if(!t.isOriginal)continue;const r=t.blocks;if(r._blocks)for(const i of Object.keys(r._blocks)){const a=r._blocks[i];if("event_whenbroadcastreceived"===a.opcode&&a.fields.BROADCAST_OPTION.value===e)n.push(new s.a(t,a));else if("event_broadcast"===a.opcode||"event_broadcastandwait"===a.opcode){const i=a.inputs.BROADCAST_INPUT.block,c=r._blocks[i];if(c){let r;r="event_broadcast_menu"===c.opcode?c.fields.BROADCAST_OPTION.value:o("complex-broadcast"),r===e&&n.push(new s.a(t,a))}}}}return n}empty(){for(const e of this.items)this.el.contains(e)&&this.el.removeChild(e);this.items=[],this.selected=null}}class l{constructor(e){this.utils=e,this.el=null,this.count=null,this.blocks=[],this.idx=0}build(e,t,o){if(this.el&&this.el.parentNode===e)this.navRight();else{if(this.remove(),this.blocks=t,e.appendChild(this.createDom()),this.idx=0,o)for(const e of Object.keys(this.blocks)){if(this.blocks[e].id===o.id){this.idx=Number(e);break}}this.idx<this.blocks.length&&this.utils.scrollBlockIntoView(this.blocks[this.idx])}}createDom(){this.el=document.createElement("span"),this.el.className="sa-find-carousel";const e=this.el.appendChild(document.createElement("span"));e.className="sa-find-carousel-control",e.textContent="â—€",e.addEventListener("mousedown",(e=>this.navLeft(e))),this.count=this.el.appendChild(document.createElement("span")),this.count.innerText=this.blocks.length>0?this.idx+1+" / "+this.blocks.length:"0";const t=this.el.appendChild(document.createElement("span"));return t.className="sa-find-carousel-control",t.textContent="â–¶",t.addEventListener("mousedown",(e=>this.navRight(e))),this.el}inputKeyDown(e){"ArrowLeft"===e.key&&this.el&&this.blocks&&this.navLeft(e),"ArrowRight"===e.key&&this.el&&this.blocks&&this.navRight(e)}navLeft(e){return this.navSideways(e,-1)}navRight(e){return this.navSideways(e,1)}navSideways(e,t){this.blocks.length>0&&(this.idx=(this.idx+t+this.blocks.length)%this.blocks.length,this.count.innerText=this.idx+1+" / "+this.blocks.length,this.utils.scrollBlockIntoView(this.blocks[this.idx])),e&&(e.cancelBubble=!0,e.preventDefault())}remove(){this.el&&(this.el.remove(),this.blocks=[],this.idx=0)}}const d=new class{constructor(){this.utils=new r.a(t),this.prevValue="",this.findBarOuter=null,this.findWrapper=null,this.findInput=null,this.dropdownOut=null,this.dropdown=new c(this.utils),document.addEventListener("keydown",(e=>this.eventKeyDown(e)),!0)}get workspace(){return a.getMainWorkspace()}createDom(e){this.findBarOuter=document.createElement("div"),this.findBarOuter.className="sa-find-bar",t.tab.displayNoneWhileDisabled(this.findBarOuter,{display:"flex"}),e.appendChild(this.findBarOuter),this.findWrapper=this.findBarOuter.appendChild(document.createElement("span")),this.findWrapper.className="sa-find-wrapper",this.dropdownOut=this.findWrapper.appendChild(document.createElement("label")),this.dropdownOut.className="sa-find-dropdown-out",this.findInput=this.dropdownOut.appendChild(document.createElement("input")),this.findInput.className=t.tab.scratchClass("input_input-form",{others:"sa-find-input"}),this.findInput.id="sa-find-input",this.findInput.type="search",this.findInput.placeholder=o("find-placeholder"),this.findInput.autocomplete="off",this.dropdownOut.appendChild(this.dropdown.createDom()),this.bindEvents(),this.tabChanged()}bindEvents(){this.findInput.addEventListener("focus",(()=>this.inputChange())),this.findInput.addEventListener("keydown",(e=>this.inputKeyDown(e))),this.findInput.addEventListener("keyup",(()=>this.inputChange())),this.findInput.addEventListener("focusout",(()=>this.hideDropDown()))}tabChanged(){if(!this.findBarOuter)return;const e=t.tab.redux.state.scratchGui.editorTab.activeTabIndex,o=0===e||1===e||2===e;this.findBarOuter.hidden=!o}inputChange(){this.showDropDown();let e=(this.findInput.value||"").toLowerCase();if(e===this.prevValue)return;this.prevValue=e,this.dropdown.blocks=null;let t=this.dropdown.items;for(const o of t){let t=o.data.procCode,n=o.data.lower.indexOf(e);if(n>=0){for(o.style.display="block";o.firstChild;)o.removeChild(o.firstChild);n>0&&o.appendChild(document.createTextNode(t.substring(0,n)));let s=document.createElement("b");s.appendChild(document.createTextNode(t.substr(n,e.length))),o.appendChild(s),n+e.length<t.length&&o.appendChild(document.createTextNode(t.substr(n+e.length)))}else o.style.display="none"}}inputKeyDown(e){if(this.dropdown.inputKeyDown(e),"Enter"!==e.key)return"Escape"===e.key?(this.findInput.value.length>0?(this.findInput.value="",this.inputChange()):this.findInput.blur(),void e.preventDefault()):void 0;this.findInput.blur()}eventKeyDown(e){if(t.self.disabled||!this.findBarOuter)return;let o=e.ctrlKey||e.metaKey;if("f"===e.key.toLowerCase()&&o&&!e.shiftKey)return this.findInput.focus(),this.findInput.select(),e.cancelBubble=!0,e.preventDefault(),!0;if("ArrowLeft"===e.key&&o){if("INPUT"===document.activeElement.tagName)return;if(0===this.selectedTab)return this.utils.navigationHistory.goBack(),e.cancelBubble=!0,e.preventDefault(),!0}if("ArrowRight"===e.key&&o){if("INPUT"===document.activeElement.tagName)return;if(0===this.selectedTab)return this.utils.navigationHistory.goForward(),e.cancelBubble=!0,e.preventDefault(),!0}}showDropDown(e,t){if(!e&&this.dropdownOut.classList.contains("visible"))return;this.prevValue=e?"":null,this.dropdownOut.classList.add("visible");let o=0===this.selectedTab?this.getScratchBlocks():1===this.selectedTab?this.getScratchCostumes():2===this.selectedTab?this.getScratchSounds():[];this.dropdown.empty();for(const n of o){let o=this.dropdown.addItem(n);e&&(n.matchesID(e)?this.dropdown.onItemClick(o,t):o.style.display="none")}this.utils.offsetX=this.dropdownOut.getBoundingClientRect().width+32,this.utils.offsetY=32}hideDropDown(){this.dropdownOut.classList.remove("visible")}get selectedTab(){return t.tab.redux.state.scratchGui.editorTab.activeTabIndex}getScratchBlocks(){let e=[],t={},s=this.workspace.getTopBlocks();function r(o,s,r){let i=r.id?r.id:r.getId?r.getId():null,a=t[s];if(a)return a.clones||(a.clones=[]),a.clones.push(i),a;let c=new n(o,s,i,0);return c.y=r.getRelativeToSurfaceXY?r.getRelativeToSurfaceXY().y:null,e.push(c),t[s]=c,c}function i(e){let t,n=e.inputList[0];for(const e of n.fieldRow)t=t?t+" ":"",e instanceof a.FieldImage&&e.src_.endsWith("green-flag.svg")?t+=o("/_general/blocks/green-flag"):t+=e.getText();return t}for(const e of s)if("procedures_definition"!==e.type)if("event_whenflagclicked"!==e.type)if("event_whenbroadcastreceived"!==e.type)"event_when"!==e.type.substr(0,10)&&"control_start_as_clone"!==e.type||r("event",i(e),e);else{let t=e.inputList[0].fieldRow.find((e=>"BROADCAST_OPTION"===e.name)).getText();r("receive",o("event",{name:t}),e).eventName=t}else r("flag",i(e),e);else{const t=e.getChildren()[0].getProcCode();if(!t)continue;const o=e.inputList.findIndex((e=>e.fieldRow.length>0));if(-1===o)continue;const n=e.inputList[o].fieldRow[0].getText();r("define",0===o?"".concat(n," ").concat(t):"".concat(t," ").concat(n),e)}let c=this.workspace.getVariableMap(),l=c.getVariablesOfType("");for(const e of l)r(e.isLocal?"var":"VAR",e.isLocal?o("var-local",{name:e.name}):o("var-global",{name:e.name}),e);let d=c.getVariablesOfType("list");for(const e of d)r(e.isLocal?"list":"LIST",e.isLocal?o("list-local",{name:e.name}):o("list-global",{name:e.name}),e);const u=this.getCallsToEvents();for(const e of u)r("receive",o("event",{name:e.eventName}),e.block).eventName=e.eventName;const p={flag:0,receive:1,event:2,define:3,var:4,VAR:5,list:6,LIST:7};return e.sort(((e,t)=>{let o=p[e.cls]-p[t.cls];return 0!==o?o:e.lower<t.lower?-1:e.lower>t.lower?1:e.y-t.y})),e}getScratchCostumes(){let e=this.utils.getEditingTarget().getCostumes(),t=[],o=0;for(const s of e){let e=new n("costume",s.name,s.assetId,o);t.push(e),o++}return t}getScratchSounds(){let e=this.utils.getEditingTarget().getSounds(),t=[],o=0;for(const s of e){let e=new n("sound",s.name,s.assetId,o);t.push(e),o++}return t}getCallsToEvents(){const e=[],t=new Set;for(const n of this.workspace.getAllBlocks()){if("event_broadcast"!==n.type&&"event_broadcastandwait"!==n.type)continue;const s=n.getChildren()[0];if(!s)continue;let r="";r="event_broadcast_menu"===s.type?s.inputList[0].fieldRow[0].getText():o("complex-broadcast"),t.has(r)||(t.add(r),e.push({eventName:r,block:n}))}return e}},u=a.Gesture.prototype.doBlockClick_;for(a.Gesture.prototype.doBlockClick_=function(){if(!t.self.disabled&&(1===this.mostRecentEvent_.button||this.mostRecentEvent_.shiftKey)){let e=this.startBlock_;for(;e;e=e.getSurroundParent()){if("procedures_definition"===e.type||!this.jumpToDef&&"procedures_call"===e.type){let t=e.id?e.id:e.getId?e.getId():null;return d.findInput.focus(),void d.showDropDown(t)}if("data_variable"===e.type||"data_changevariableby"===e.type||"data_setvariableto"===e.type){let t=e.getVars()[0];return d.findInput.focus(),d.showDropDown(t,e),void(d.selVarID=t)}if("event_whenbroadcastreceived"===e.type||"event_broadcastandwait"===e.type||"event_broadcast"===e.type){let t=e.id;return d.findInput.focus(),d.showDropDown(t,e),void(d.selVarID=t)}}}u.call(this)},t.tab.redux.initialize(),t.tab.redux.addEventListener("statechanged",(e=>{"scratch-gui/navigation/ACTIVATE_TAB"===e.detail.action.type&&d.tabChanged()}));;){const e=await t.tab.waitForElement("ul[class*=gui_tab-list_]",{markAsSeen:!0,reduxEvents:["scratch-gui/mode/SET_PLAYER","fontsLoaded/SET_FONTS_LOADED","scratch-gui/locales/SELECT_LOCALE"],reduxCondition:e=>!e.scratchGui.mode.isPlayerOnly});d.createDom(e)}},"userstyle.css":o.n(i).a}},1805:function(e,t,o){"use strict";function n(e){var t=this.procCode_.split(/(?=[^\\]%[nbsl])/);t=t.map((function(e){return e.trim()}));for(var o,n=0,s=0;o=t[s];s++){var r;if("%"==o.substring(0,1)&&"l"!==o.substring(1,2)){var i=o.substring(1,2);if("n"!=i&&"b"!=i&&"s"!=i)throw new Error("Found an custom procedure with an invalid type: "+i);r=o.substring(2).trim();var a=this.argumentIds_[n],c=this.appendValueInput(a);"b"==i&&c.setCheck("Boolean"),this.populateArgument_(i,n,e,a,c),n++}else r="%l"==o?" ":o.replace("%l","").trim();this.addProcedureLabel_(r.replace(/\\%/,"%"))}this.procCode_=this.procCode_.replaceAll("%l ","")}function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.procCode_="",this.displayNames_=[],this.argumentIds_=[];for(var t=0;t<this.inputList.length;t++){0!=t&&(this.procCode_+=" ");var o=this.inputList[t];if(5==o.type)this.procCode_+=(e?"%l ":"")+o.fieldRow[0].getValue();else{if(1!=o.type)throw new Error("Unexpected input type on a procedure mutator root: "+o.type);var n=o.connection.targetBlock();this.displayNames_.push(n.getFieldValue("TEXT")),this.argumentIds_.push(o.name),"argument_editor_boolean"==n.type?this.procCode_+="%b":this.procCode_+="%s"}}}o.r(t),o.d(t,"resources",(function(){return i}));var r=o(1705);const i={"userscript.js":async function(e){let{addon:t,console:o}=e;function r(e,t){const o="left"===e?"M 17 13 L 9 21 L 17 30":"M 9 13 L 17 21 L 9 30";m.WidgetDiv.DIV.insertAdjacentHTML("beforeend",'\n            <svg width="20px" height="40px" \n                 style="left: '.concat("left"===e?"calc(50% - 20px)":"calc(50% + 20px)",'" \n                 class="blocklyTextShiftArrow">\n                <path d="').concat(o,'" fill="none" stroke="#FF661A" stroke-width="2"></path>\n            </svg>')),m.WidgetDiv.DIV.lastChild.addEventListener("click",t)}function i(e){if(1!==this.inputList.length){for(var t=null,o=0;o<this.inputList.length;o++){var n=this.inputList[o];if(n.connection)n.connection.targetBlock().getField(e.name)==e&&(t=n.name);else for(var s=0;s<n.fieldRow.length;s++)n.fieldRow[s]==e&&(t=n.name)}t&&(m.WidgetDiv.hide(!0),this.removeInput(t),this.onChangeFn(!0),this.updateDisplay_())}}function a(e,o){return function(){var n;const s=null===(n=w)||void 0===n?void 0:n.sourceBlock_,r=s?s.parentBlock_?s.parentBlock_:s:this;if("addLabelExternal"===o){const e=r.inputList[r.inputList.length-1];e.type===m.DUMMY_INPUT&&e.fieldRow[0].setValue(e.fieldRow[0].getValue()+" %l")}if(r.onChangeFn(!0),null==s||!t.settings.get("InsertInputsAfter"))return e.call(this,...arguments);let i=c(w,r.inputList).index+1;e.call(r,...arguments);l(r,r.inputList[r.inputList.length-1].name,i)}}function c(e,t){for(const[n,s]of t.entries()){var o;if(s.connection?(null===(o=s.connection.targetBlock())||void 0===o?void 0:o.getField(e.name))===e:s.fieldRow.includes(e))return{name:s.name,index:n}}}function l(e,t,o){const n=e.inputList.length;if(!(t&&o>=0&&o<=n))return!1;const s=e.inputList.findIndex((e=>e.name===t)),r=e.inputList.splice(s,1)[0];e.inputList.splice(o,0,r),m.Events.disable();try{e.onChangeFn(!0),e.updateDisplay_()}finally{m.Events.enable()}!function(e){if(!e)return;if(e.type===m.DUMMY_INPUT)e.fieldRow[0].showEditor_();else if(e.type===m.INPUT_VALUE){e.connection.targetBlock().getField("TEXT").showEditor_()}}(e.inputList[o])}function d(e,t,o){const n=e.parentBlock_?e.parentBlock_:e;if(n.inputList.length<=1)return;const{name:s,index:r}=c(t,n.inputList);l(n,s,"left"===o?r-1:r+1)}function u(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.createAllInputs_=n,e.onChangeFn=s,e.removeFieldCallback=i;for(const o of["addLabelExternal","addBooleanExternal","addStringNumberExternal"])t&&(v[o]=e[o]),e[o]=a(e[o],o)}function p(e){e.createAllInputs_=f,e.onChangeFn=b,e.removeFieldCallback=y;for(const[t,o]of Object.entries(v))e[t]=o}function h(){return m.getMainWorkspace().getAllBlocks().find((e=>"procedures_declaration"===e.type))}function g(){u(m.Blocks.procedures_declaration),t.tab.redux.state.scratchGui.customProcedures.active&&u(h(),!1),m.FieldTextInputRemovable.prototype.showEditor_=function(){k.call(this),r("left",(()=>d(this.sourceBlock_,this,"left"))),r("right",(()=>d(this.sourceBlock_,this,"right"))),w=this}}const m=await t.tab.traps.getBlockly(),f=m.Blocks.procedures_declaration.createAllInputs_,b=m.Blocks.procedures_declaration.onChangeFn,y=m.Blocks.procedures_declaration.removeFieldCallback,k=m.FieldTextInputRemovable.prototype.showEditor_;let v={},w=null;t.self.addEventListener("disabled",(function(){p(m.Blocks.procedures_declaration),t.tab.redux.state.scratchGui.customProcedures.active&&p(h()),m.FieldTextInputRemovable.prototype.showEditor_=k,m.WidgetDiv.DIV.querySelectorAll(".blocklyTextShiftArrow").forEach((e=>e.remove()))})),t.self.addEventListener("reenabled",g),g()},"arrows.css":o.n(r).a}},1806:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return a}));var n=o(1657),s=o(1658),r=async e=>{let{addon:t,console:o,msg:r}=e;const i=new s.a(250),a=(e,o)=>{if(e=Object(n.b)(e),!t.tab.redux.state||!t.tab.redux.state.scratchGui)return;const s=e=>{let{detail:o}=e;"scratch-gui/color-picker/DEACTIVATE_COLOR_PICKER"===o.action.type&&(t.tab.redux.removeEventListener("statechanged",s),setTimeout((()=>{document.body.classList.remove("sa-hide-eye-dropper-background")}),50))},r=o=>{let{detail:n}=o;"scratch-gui/color-picker/ACTIVATE_COLOR_PICKER"===n.action.type&&(t.tab.redux.removeEventListener("statechanged",r),t.tab.redux.addEventListener("statechanged",s),setTimeout((()=>{t.tab.redux.dispatch({type:"scratch-gui/color-picker/DEACTIVATE_COLOR_PICKER",color:e})}),50))};t.tab.redux.addEventListener("statechanged",r),document.body.classList.add("sa-hide-eye-dropper-background"),o.click()},c=await t.tab.traps.getBlockly(),l=c.FieldColourSlider.prototype.showEditor_;c.FieldColourSlider.prototype.showEditor_=function(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];const c=l.call(this,...o);return(e=>{const o=document.querySelector("button.scratchEyedropper");i.abort(!1),t.tab.redux.initialize();const s=e.getValue(),c=Object.assign(document.createElement("div"),{className:"sa-color-picker sa-color-picker-code"});t.tab.displayNoneWhileDisabled(c,{display:"flex"});const l=Object.assign(document.createElement("input"),{className:"sa-color-picker-color sa-color-picker-code-color",type:"color",value:s||"#000000"}),d=Object.assign(document.createElement("input"),{className:t.tab.scratchClass("input_input-form",{others:"sa-color-picker-text sa-color-picker-code-text"}),type:"text",pattern:"^#?([0-9a-fA-F]{3}){1,2}$",placeholder:r("hex"),value:s||""});l.addEventListener("input",(()=>i.limit((()=>a(d.value=l.value,o))))),d.addEventListener("change",(()=>{const{value:e}=d;Object(n.a)().test(e)&&a(l.value=Object(n.b)(e),o)})),c.appendChild(l),c.appendChild(d),o.parentElement.insertBefore(c,o)})(this),c};const d=c.FieldColourSlider.prototype.sliderCallbackFactory_;c.FieldColourSlider.prototype.sliderCallbackFactory_=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const n=d.call(this,...t);return e=>{const t=n(e),o=c.DropDownDiv.getContentDiv();if(o){const e=o.querySelector(".sa-color-picker-color.sa-color-picker-code-color"),n=o.querySelector(".sa-color-picker-text.sa-color-picker-code-text");if(!e||!n)return t;const s=this.getValue();e.value=s||"#000000",n.value=s||""}return t}}},i=o(1734);const a={"userscript.js":async e=>{r(e)},"style.css":o.n(i).a}},1808:function(e,t,o){"use strict";function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o.r(t),o.d(t,"resources",(function(){return b}));const i="//",a=e=>{const t=e.indexOf(i);return-1===t||0===t?null:e.substr(0,t)},c=e=>{const t=e.indexOf(i);return-1===t||0===t?e:e.substr(t+2)},l=(e,t)=>{const o=c(e);return t?"".concat(t).concat(i).concat(o):o},d=e=>!e.includes(i)&&!e.endsWith("/"),u=["_mouse_","_stage_","_edge_","_myself_","_random_"],p=e=>""===e?"2":u.includes(e)?"".concat(e,"2"):e;let h=null,g=null;const m=e=>{e&&null!==g&&"string"!=typeof a(e.name)&&(e.name=l(e.name,g))};var f=o(1763);const b={"userscript.js":async function(e){let{addon:t,console:o,msg:n}=e;let r,i,u,f;const b=e=>{const t=e.closest("[class*='sprite-selector_sprite-selector']");if(t)return t[i].child.sibling.child.stateNode;const o=e.closest('[class*="asset-panel_wrapper"]');if(o)return o[i].child.child.stateNode;throw new Error("cannot find SortableHOC")},y=(e,t,o)=>Math.min(Math.max(e,t),o),k=e=>e&&e.name&&"object"==typeof e.name?e.name:null,v={assetId:"&__sa_folders_folder",encodeDataURI:()=>t.self.getResource("/folder.svg")},w="data:image/svg+xml;base64,".concat(btoa('<?xml version="1.0" encoding="UTF-8"?>\n<svg width="100px" height="100px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="Sound" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M12.4785058,12.6666667 C12.3144947,12.6666667 12.1458852,12.6272044 11.9926038,12.5440517 C11.537358,12.2960031 11.3856094,11.7562156 11.6553847,11.3376335 C12.1688774,10.5371131 12.1688774,9.54491867 11.6553847,8.74580756 C11.3856094,8.32581618 11.537358,7.78602861 11.9926038,7.53798001 C12.452448,7.29275014 13.0379829,7.43086811 13.3046926,7.84804076 C14.1737981,9.20103311 14.1737981,10.8809986 13.3046926,12.233991 C13.1268862,12.5130457 12.806528,12.6666667 12.4785058,12.6666667 Z M15.3806784,13.8333333 C15.2408902,13.8333333 15.0958763,13.796281 14.9665396,13.7182064 C14.5785295,13.485306 14.4491928,12.9784829 14.6791247,12.5854634 C15.5949331,11.0160321 15.5949331,9.065491 14.6791247,7.49738299 C14.4491928,7.10436352 14.5785295,6.59621712 14.9665396,6.36331669 C15.3558562,6.13438616 15.8549129,6.26274605 16.0848448,6.65444223 C17.3050517,8.74260632 17.3050517,11.3389168 16.0848448,13.4270809 C15.9319924,13.6890939 15.6602547,13.8333333 15.3806784,13.8333333 Z M10.3043478,5.62501557 L10.3043478,13.873675 C10.3043478,14.850934 9.10969849,15.3625101 8.36478311,14.7038052 L6.7566013,13.2797607 C6.18712394,12.7762834 5.44499329,12.4968737 4.67362297,12.4968737 L4.3923652,12.4968737 C3.62377961,12.4968737 3,11.8935108 3,11.1470686 L3,8.36646989 C3,7.62137743 3.62377961,7.01666471 4.3923652,7.01666471 L4.65830695,7.01666471 C5.42967727,7.01666471 6.17180792,6.73725504 6.74128529,6.23377771 L8.36478311,4.79623519 C9.10969849,4.13753026 10.3043478,4.64910643 10.3043478,5.62501557 Z" id="Combined-Shape" fill="#575E75"></path>\n    </g>\n</svg>'));let I=null;const T=Object.create(null),x=e=>{const t=e=>{const t=(e=>{let t=0;for(let o=0;o<e.length;o++)t=31*t+e.charCodeAt(o),t|=0;return t})(e),o=(n=t,function(){var e=n+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296});var n;return o(),o(),o(),o(),o()};if(!T[e]){I||(I=document.createElement("style"),document.head.appendChild(I));const o=360*t(e),n="hsla(".concat(o,"deg, 100%, 85%, 0.5)"),s=Object.keys(T).length,r="sa-folders-color-".concat(s);T[e]=r,I.textContent+=".".concat(r,"{background-color:").concat(n," !important;}"),I.textContent+=".".concat(r,'[class*="sprite-selector_raised"]:not([class*="sa-folders-folder"]){background-color:hsla(').concat(o,"deg, 100%, 77%, 1) !important;}")}return T[e]},M=e=>{const t=Object.create(null),o=[];for(const n of e){const e=n.getName?n.getName():n.name,s=a(e);"string"==typeof s?(t[s]||(t[s]=[],o.push(t[s])),t[s].push(n)):o.push(n)}const n=o.flat();for(let t=0;t<e.length;t++)if(o[t]!==e[t])return{items:n,changed:!0};return{items:n,changed:!1}},N=()=>{const{items:e,changed:t}=M(r.runtime.targets);t&&(r.runtime.targets=e,r.emitTargetsUpdate())},L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.editingTarget;const{items:t,changed:o}=M(e.sprite.costumes);o&&(e.sprite.costumes=t,r.emitTargetsUpdate())},S=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.editingTarget;const{items:t,changed:o}=M(e.sprite.sounds);o&&(e.sprite.sounds=t,r.emitTargetsUpdate())},C=e=>{const t=e.constructor;if(!Array.isArray(e.props.items)||"string"!=typeof e.props.selectedId&&"number"!=typeof e.props.selectedItemIndex||void 0===e.containerBox||void 0!==t.prototype.componentDidMount||void 0!==t.prototype.componentDidUpdate||"function"!=typeof t.prototype.handleAddSortable||"function"!=typeof t.prototype.handleRemoveSortable||"function"!=typeof t.prototype.setRef)throw new Error("Can not comprehend SortableHOC")};class D{constructor(){this.cache=new Map,this.usedThisTick=new Set}has(e){return this.cache.has(e)}get(e){return this.usedThisTick.add(e),this.cache.get(e)}set(e,t){this.usedThisTick.add(e),this.cache.set(e,t)}startTick(){this.usedThisTick.clear()}endTick(){for(const e of Array.from(this.cache.keys()))this.usedThisTick.has(e)||this.cache.delete(e)}clear(){this.usedThisTick.clear(),this.cache.clear()}}const _=(e,t)=>{const o=new D,n=new D,r=new D,i=80,c=[[0,0],[40,0],[0,40],[40,40]],l=e=>{let t='data:image/svg+xml;,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(i,'" height="').concat(i,'">');for(let o=0;o<Math.min(c.length,e.length);o++){const n=e[o],s=40,r=40,[i,a]=c[o];let l;n.asset?l=n.asset.encodeDataURI():n.costume&&n.costume.asset?l=n.costume.asset.encodeDataURI():n.url&&(l=w),l&&(t+='<image width="'.concat(s,'" height="').concat(r,'" x="').concat(i,'" y="').concat(a,'" href="').concat(l,'"/>'))}return t+="</svg>",t},d=e=>{let t="sa_folder&&";for(let o=0;o<Math.min(c.length,e.length);o++){const n=e[o];n.asset?t+=n.asset.assetId:n.costume&&n.costume.asset?t+=n.costume.asset.assetId:n.url&&(t+=n.url),t+="&&"}return t},p=e=>{if(1===t){return e.props.items.find((t=>t.id===e.props.selectedId))}if(2===t){return e.props.items[e.props.selectedItemIndex]}return null};e.prototype.saInitialSetup=function(){o.clear(),n.clear(),r.clear();const e=[],s=p(this);if(s&&!s.isStage){const o=a(s.name);e.push(o),1===t?h=o:2===t&&(g=o)}this.setState({folders:e})},e.prototype.componentDidMount=function(){const e=p(this);if(e){const o=a(e.name);1===t?h=o:2===t&&(g=o)}this.saInitialSetup()},e.prototype.componentDidUpdate=function(e,o){const n=p(this);if(n){const o=a(n.name),s=this.state.folders.includes(o)?o:null;let r;1===t?h=s:2===t&&(g=s),r=this.props.selectedId?this.props.selectedId!==e.selectedId:this.props.items[this.props.selectedItemIndex]&&e.items[e.selectedItemIndex]&&this.props.items[this.props.selectedItemIndex].name!==e.items[e.selectedItemIndex].name,r&&(n.isStage||"string"!=typeof o||this.state.folders.includes(o)||this.setState((e=>({folders:[...e.folders,o]}))))}};const m=e.prototype.render;e.prototype.render=function(){const e=this.props;this.props=s(s({},this.props),((e,s)=>{const i=e=>{const t=e.name;let n,s;o.has(t)?(n=o.get(t),s=n.name):(s={toString:()=>"_".concat(e.name)},n={},o.set(t,n));const r=a(e.name);return Object.assign(n,e),s.realName=e.name,s.realIndex=h,s.inFolder=r,n.name=s,{newItem:n,itemData:s}};o.startTick(),n.startTick(),r.startTick();const c=new Map,u=[],p={items:u};let h=0;for(;h<s.items.length;){const o=s.items[h],g=a(o.name);if(null===g)u.push(i(o).newItem),2===t&&s.selectedItemIndex===h&&(p.selectedItemIndex=u.length-1);else{const o=-1!==e.indexOf(g),m=[];for(;h<s.items.length;){const e=s.items[h],n=i(e);if(a(e.name)!==g)break;m.push(n.newItem),2===t&&s.selectedItemIndex===h&&(p.selectedItemIndex=o?u.length+m.length:-1),h++}h--;const f=c.get(g)||0;c.set(g,f+1);const b=d(m),y="".concat(o,"&").concat(f,"&").concat(g,"&").concat(b,"&"),k="&__".concat(f,"_").concat(g),w=b;let I,T,x;if(n.has(y)?(I=n.get(y),T=I.name):(I={id:{toString:()=>k}},T={toString:()=>k},n.set(y,I)),T.folder=g,T.folderOpen=o,I.items=m,I.name=T,o?x=v:r.has(w)?x=r.get(w):(x={assetId:w,encodeDataURI:()=>l(m)},r.set(w,x)),1===t?(I.costume||(I.costume={}),I.costume.asset=x,I.id||(I.id={}),I.id.sa_folder_items=m,I.id.toString=()=>k):(I.asset=x,I.dragPayload||(I.dragPayload={}),I.dragPayload.sa_folder_items=m),u.push(I),o)for(const e of m)u.push(e)}h++}return o.endTick(),n.endTick(),r.endTick(),p})(this.state&&this.state.folders||[],this.props)),1===t?u=this.props.items:2===t&&(f=this.props.items);const i=m.call(this);return this.props=e,i}},E=(e,t)=>{const o=b(e.ref);return(o.state&&o.state.folders||[]).includes(t)},A=(e,t,o)=>{b(e.ref).setState((e=>{let n=e&&e.folders||[];return n=n.filter((e=>e!==t)),o?{folders:[...n,t]}:{folders:n}}))};await t.tab.scratchClassReady(),t.tab.createEditorContextMenu(((e,o)=>{if("sprite"!==e&&"costume"!==e&&"sound"!==e)return;const s=o.target[t.tab.traps.getInternalKey(o.target)].return.return.return.stateNode,i=k(s.props);if(i){if("string"==typeof i.folder){o.target.setAttribute("sa-folders-context-type","folder");const e=e=>{const t=E(s,i.folder);if(A(s,i.folder,!1),t&&"string"==typeof e&&A(s,e,!0),"SPRITE"===s.props.dragType){for(const t of r.runtime.targets)t.isOriginal&&a(t.getName())===i.folder&&r.renameSprite(t.id,p(l(t.getName(),e)));r.emitWorkspaceUpdate(),N()}else if("COSTUME"===s.props.dragType){for(let t=0;t<r.editingTarget.sprite.costumes.length;t++){const o=r.editingTarget.sprite.costumes[t];a(o.name)===i.folder&&r.renameCostume(t,l(o.name,e))}L()}else if("SOUND"===s.props.dragType){for(let t=0;t<r.editingTarget.sprite.sounds.length;t++){const o=r.editingTarget.sprite.sounds[t];a(o.name)===i.folder&&r.renameSound(t,l(o.name,e))}S()}},c=async()=>{let o=await t.tab.prompt(n("rename-folder-prompt-title"),n("rename-folder-prompt"),i.folder,{useEditorClasses:!0});null!==o&&(d(o)?(o||(o=null),e(o)):alert(n("name-not-allowed")))},u=()=>{e(null)};return[{className:"sa-folders-rename-folder",label:n("rename-folder"),callback:c,position:"assetContextMenuAfterDelete",order:10},{className:"sa-folders-remove-folder",label:n("remove-folder"),callback:u,position:"assetContextMenuAfterDelete",order:11}]}{o.target.setAttribute("sa-folders-context-type","asset");const e=e=>{if("SPRITE"===s.props.dragType){const t=r.runtime.getTargetById(s.props.id);r.renameSprite(s.props.id,p(l(t.getName(),e))),N(),r.emitWorkspaceUpdate()}else if("COSTUME"===s.props.dragType){const t=k(s.props).realIndex,o=r.editingTarget.sprite.costumes[t];r.renameCostume(r.editingTarget.sprite.costumes.indexOf(o),l(o.name,e)),L()}else if("SOUND"===s.props.dragType){const t=k(s.props).realIndex,o=r.editingTarget.sprite.sounds[t];r.renameSound(r.editingTarget.sprite.sounds.indexOf(o),l(o.name,e)),S()}},a=async()=>{const o=await t.tab.prompt(n("name-prompt-title"),n("name-prompt"),c(i.realName),{useEditorClasses:!0});null!==o&&(d(o)?e(o):alert(n("name-not-allowed")))},h=[{border:!0,className:"sa-folders-create-folder",label:n("create-folder"),callback:a,position:"assetContextMenuAfterDelete",order:13}],g=i.inFolder;return"string"==typeof g&&h.push({className:"sa-folders-remove-from-folder",label:n("remove-from-folder"),callback:()=>e(null),position:"assetContextMenuAfterDelete",order:14}),h.concat((e=>{const t=new Set;let o;o="SPRITE"===e.props.dragType?u:f;for(const e of o){const o=k(e);"string"==typeof o.folder&&t.add(o.folder)}return Array.from(t)})(s).filter((e=>e!==g)).map(((t,o)=>({className:"sa-folders-add-to-folder",label:n("add-to-folder",{folder:t}),callback:()=>e(t),position:"assetContextMenuAfterDelete",order:20+o}))))}}}));const O=e=>{for(const t of["handleDelete","handleDuplicate","handleExport"]){const o=e.prototype[t];e.prototype[t]=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("number"==typeof this.props.id){const e=k(this.props);if(e){const n=this.props;this.props=s(s({},n),{},{id:e.realIndex});const r=o.call(this,...t);return this.props=n,r}}return o.call(this,...t)}}const o=e.prototype.handleDragEnd;e.prototype.handleDragEnd=function(){const e=k(this.props);if(e&&"number"==typeof e.realIndex&&this.props.dragging){const o=this.props.index,n=e.realIndex;if(o!==n){const e=t.tab.redux.state.scratchGui.assetDrag.currentOffset,s=b(this.ref);e&&s&&null===s.getMouseOverIndex()&&(this.props.index=n,this.handleDrag(e),this.props.index=o)}}for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return o.call(this,...s)};const r=e.prototype.handleClick;e.prototype.handleClick=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const n=t[0];if(n&&!this.noClick){const e=k(this.props);if(e){if("string"==typeof e.folder)return n.preventDefault(),void A(this,e.folder,!E(this,e.folder));if("number"==typeof this.props.number&&"number"==typeof e.realIndex)return n.preventDefault(),void(this.props.onClick&&this.props.onClick(e.realIndex))}}return r.call(this,...t)};const i=e.prototype.render;e.prototype.render=function(){const e=k(this.props);if(e){const t=this.props;this.props=s({},this.props),"string"==typeof e.realName&&(this.props.name=c(e.realName)),"number"==typeof this.props.number&&"number"==typeof e.realIndex&&(this.props.number=e.realIndex+1),"string"==typeof e.folder&&(this.props.name=e.folder,e.folderOpen?this.props.details=n("open-folder"):this.props.details=n("closed-folder"),this.props.selected=!1,this.props.number=null,this.props.className+=" ".concat(x(e.folder)," sa-folders-folder")),"string"==typeof e.inFolder&&(this.props.className+=" ".concat(x(e.inFolder)));const o=i.call(this);return this.props=t,o}return i.call(this)}},j=()=>{const e=r.runtime.targets[0].constructor,t=r.installTargets;r.installTargets=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];if(null!==h){const e=o[0],t=o[2];if(Array.isArray(e)&&!t)for(const t of e)t.sprite&&(t.sprite.name=l(t.sprite.name,h))}return t.call(this,...o).then((e=>(N(),e)))};const n=r.duplicateSprite;r.duplicateSprite=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.call(this,...t).then((e=>(N(),e)))};const s=e.prototype.addCostume;e.prototype.addCostume=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];m(t[0]);const n=s.call(this,...t);return L(this),n};const i=e.prototype.addSound;e.prototype.addSound=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];m(t[0]);const n=i.call(this,...t);return S(this),n};const a=(e,t,n)=>{let{guiItems:s,getAll:r,set:i,rename:a,getVMItemFromGUIItem:c,zeroIndexed:d,onFolderChanged:u}=e;if((t=y(t,d?0:1,d?s.length-1:s.length))===(n=y(n,d?0:1,d?s.length-1:s.length)))return!1;let p=r();const h=r(),g=s[t-(d?0:1)],m=s[n-(d?0:1)],f=k(g),b=k(m);if(!f||!b)return o.warn("should never happen"),!1;const v=("string"==typeof f.folder?g.items:[g]).map((e=>c(e,p))).filter((e=>e));if("number"==typeof b.realIndex){const e=c(m,p);if(!e||v.includes(e))return!1}let w,I=null;if(p=p.filter((e=>!v.includes(e))),n===(d?0:1))w=d?0:1;else if(n===s.length-(d?1:0))w=p.length;else if("number"==typeof b.realIndex){I="string"==typeof b.inFolder?b.inFolder:null;let e=c(m,p);if(!e)return o.warn("should never happen"),!1;w=p.indexOf(e),n>t&&w++}else{if("string"!=typeof b.folder)return o.warn("should never happen"),!1;{let e,s=0;n<t?e=m.items[0]:b.folderOpen?(e=m.items[0],I=b.folder):(e=m.items[m.items.length-1],s=1);let r=c(e,p);if(r)w=p.indexOf(r)+s;else{if(r=c(e,h),!r)return o.warn("should never happen"),!1;w=h.indexOf(r)+s}}}if("string"!=typeof f.folder||null===I){if(w<(d?0:1)||w>p.length)return o.warn("should never happen"),!1;if(p.splice(w,0,...v),i(p),"string"!=typeof f.folder&&f.inFolder!==I){for(const e of v){const t=e.getName?e.getName():e.name;a(e,l(t,I))}u&&u()}return!0}};r.constructor.prototype.reorderTarget=function(e,t){return a({getAll:()=>this.runtime.targets,set:e=>{this.runtime.targets=e,this.emitTargetsUpdate()},rename:(e,t)=>{this.renameSprite(e.id,p(t))},getVMItemFromGUIItem:(e,t)=>t.find((t=>t.id===e.id)),onFolderChanged:()=>{this.emitWorkspaceUpdate()},guiItems:u,zeroIndexed:!1},e,t)},e.prototype.reorderCostume=function(e,t){return a({getAll:()=>this.sprite.costumes,set:e=>{this.sprite.costumes=e},rename:(e,t)=>{this.renameCostume(this.sprite.costumes.indexOf(e),t)},getVMItemFromGUIItem:(e,t)=>{const o=k(e);return t.find((e=>e.name===o.realName))},guiItems:f,zeroIndexed:!0},e,t)},e.prototype.reorderSound=function(e,t){return a({getAll:()=>this.sprite.sounds,set:e=>{this.sprite.sounds=e},rename:(e,t)=>{this.renameSound(this.sprite.sounds.indexOf(e),t)},getVMItemFromGUIItem:(e,t)=>{const o=k(e);return t.find((e=>e.name===o.realName))},guiItems:f,zeroIndexed:!0},e,t)};const c=r.shareSoundToTarget;r.shareSoundToTarget=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.runtime.getTargetById(t[1])?c.call(this,...t):Promise.reject(new Error("Dropping sound into folder is not supported"))}},z=e=>{const o=e.constructor;o.prototype.sa_loadNextItem=function(){if(!this.sa_queuedItems)return;const e=this.sa_queuedItems.pop();if(e){let t,o;e.dragPayload?(o=e.url?"SOUND":"COSTUME",t=e.dragPayload):e.id&&(o="SPRITE",t=e.id),o&&t&&s.call(this,{dragType:o,payload:t})}},o.prototype.componentDidUpdate=function(e,t){this.state.loading||!t.loading||this.state.error||this.sa_loadNextItem()};const s=o.prototype.handleDrop;o.prototype.handleDrop=function(){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];const i=o[0],a=i&&i.payload&&i.payload.sa_folder_items;if(!Array.isArray(a))return s.call(this,...o);t.tab.confirm("",n("confirm-backpack-folder"),{useEditorClasses:!0}).then((e=>{e&&(this.sa_queuedItems=a,this.sa_loadNextItem())}))},e.handleDrop=o.prototype.handleDrop.bind(e)};{const e=t=>{t.target.closest('[class*="backpack_backpack-header_"]')&&setTimeout((()=>{const t=document.querySelector("[class^='backpack_backpack-list_']");if(!t)return;document.removeEventListener("click",e);const o=(e=>{const t=e.closest('[class*="gui_editor-wrapper"]');if(!t)throw new Error("cannot find Backpack");return t[i].child.sibling.child.child.stateNode})(t);(e=>{const t=e.constructor;if("function"!=typeof t.prototype.handleDrop||void 0!==t.prototype.componentDidUpdate)throw new Error("Can not comprehend Backpack")})(o),z(o)}))};document.addEventListener("click",e,!0)}{const e=await t.tab.waitForElement("[class^='sprite-selector_sprite-wrapper']",{reduxCondition:e=>!e.scratchGui.mode.isPlayerOnly});r=t.tab.traps.vm,i=Object.keys(e).find((e=>e.startsWith("__reactInternalInstance$")));const o=b(e),n=e[i].child.child.child.stateNode;C(o),(e=>{const t=e.constructor;if("object"!=typeof e.props.asset||"string"!=typeof e.props.name||"string"!=typeof e.props.dragType||"function"!=typeof t.prototype.handleClick||"function"!=typeof t.prototype.setRef||"function"!=typeof t.prototype.handleDrag||"function"!=typeof t.prototype.handleDragEnd||"function"!=typeof t.prototype.handleDelete||"function"!=typeof t.prototype.handleDuplicate||"function"!=typeof t.prototype.handleExport)throw new Error("Can not comprehend SpriteSelectorItem")})(n),(e=>{const t=e.runtime.targets[0];if("function"!=typeof e.installTargets||"function"!=typeof e.reorderTarget||"function"!=typeof t.reorderCostume||"function"!=typeof t.reorderSound||"function"!=typeof t.addCostume||"function"!=typeof t.addSound)throw new Error("Can not comprehend VM")})(r),_(o.constructor,1),O(n.constructor),o.saInitialSetup(),j()}{const e=await t.tab.waitForElement("[class*='selector_list-item']",{reduxCondition:e=>0!==e.scratchGui.editorTab.activeTabIndex&&!e.scratchGui.mode.isPlayerOnly}),o=b(e);C(o),_(o.constructor,2),o.saInitialSetup()}},"style.css":o.n(f).a,"folder.svg":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMCA0SDRjLTEuMSAwLTEuOTkuOS0xLjk5IDJMMiAxOGMwIDEuMS45IDIgMiAyaDE2YzEuMSAwIDItLjkgMi0yVjhjMC0xLjEtLjktMi0yLTJoLThsLTItMnoiLz48L3N2Zz4="}},1814:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return s}));var n=o(1706);const s={"userscript.js":async function(e){let{addon:t,console:o,msg:n}=e;const s=await t.tab.traps.getBlockly(),r=t.tab.traps.vm,i=["RENAME_VARIABLE_ID","DELETE_VARIABLE_ID","NEW_BROADCAST_MESSAGE_ID","RENAME_BROADCAST_MESSAGE_ID"],a=(e,t)=>!r.runtime.getAllVarNamesOfType(t).includes(e),c=(e,t)=>!r.editingTarget.lookupVariableByNameAndType(e,t),l={createGlobalVariable:{enabled:e=>a(e,""),createVariable:(e,t)=>e.createVariable(t)},createLocalVariable:{enabled:e=>c(e,""),createVariable:(e,t)=>e.createVariable(t,"",null,!0)},createGlobalList:{enabled:e=>a(e,"list"),createVariable:(e,t)=>e.createVariable(t,"list")},createLocalList:{enabled:e=>c(e,"list"),createVariable:(e,t)=>e.createVariable(t,"list",null,!0)},createBroadcast:{enabled:e=>a(e,"broadcast_msg"),createVariable:(e,t)=>e.createVariable(t,"broadcast_msg")}};let d=null,u=null,p=null,h=[],g=[],m=[],f=[];const b=s.DropDownDiv.show;s.DropDownDiv.show=function(){u=document.querySelector(".blocklyDropdownMenu");for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];if(!u)return b.call(this,...o);u.focus=()=>{},p=document.createElement("input"),t.tab.displayNoneWhileDisabled(p,{display:"flex"}),p.type="text",p.addEventListener("input",I),p.addEventListener("keydown",T),p.classList.add("u-dropdown-searchbar"),u.insertBefore(p,u.firstChild),h=Array.from(u.children).filter((e=>"INPUT"!==e.tagName)).map((e=>({element:e,text:e.textContent}))),m=f,I();const r=b.call(this,...o);return d=s.DropDownDiv.getContentDiv(),d.style.width=getComputedStyle(d).width,d.style.height=getComputedStyle(d).height,u.insertBefore(p,u.firstChild),p.focus(),r};const y=s.DropDownDiv.clearContent;s.DropDownDiv.clearContent=function(){y.call(this),h=[],g=[],s.DropDownDiv.content_.style.height=""};const k=s.FieldDropdown.prototype.getOptions;s.FieldDropdown.prototype.getOptions=function(){const e=k.call(this),t=this.sourceBlock_,o=r.editingTarget&&r.editingTarget.isStage;return t&&("data"===t.category_?(e.push(x("createGlobalVariable")),o||e.push(x("createLocalVariable"))):"data-lists"===t.category_?(e.push(x("createGlobalList")),o||e.push(x("createLocalList"))):"event_broadcast_menu"!==t.type&&"event_whenbroadcastreceived"!==t.type||e.push(x("createBroadcast"))),f=e,e};const v=s.FieldVariable.prototype.onItemSelected;function w(e,t){e.dispatchEvent(new MouseEvent("mousedown",{relatedTarget:e,bubbles:!0})),t&&e.dispatchEvent(new MouseEvent("mouseup",{relatedTarget:e,bubbles:!0}));const o=e.offsetTop,n=o+e.offsetHeight,s=d.scrollTop,r=d.offsetHeight,i=s+r;s>o?d.scrollTop=o:n>i&&(d.scrollTop=n-r)}function I(){const e=g;g=function(){const e=p.value.trim(),t=e.trim().toLowerCase(),o=(o,n)=>{const s=m[n][1];if(i.includes(s))return t?-1:0;if(Object.prototype.hasOwnProperty.call(l,s))return t&&l[s].enabled(e)?(o.element.lastChild.lastChild.textContent=x(s)[0],0):-1;const r=o.text.toLowerCase();return t===r?2:r.startsWith(t)?1:r.includes(t)?0:-1};return h.map(((e,t)=>({item:e,score:o(e,t)}))).sort(((e,t)=>{let{score:o}=e,{score:n}=t;return Math.max(0,n)-Math.max(0,o)}))}();let t=e.length!==g.length;if(!t)for(let o=0;o<g.length;o++)if(g[o].item!==e[o].item){t=!0;break}if(t&&e.length>0){for(const{item:t}of e)t.element.remove();for(const{item:e}of g)u.appendChild(e.element)}for(const{item:e,score:t}of g)e.element.hidden=t<0}function T(e){if("Enter"===e.key){e.stopPropagation(),e.preventDefault();const t=document.querySelector(".goog-menuitem-highlight");if(t&&!t.hidden)return void w(t,!0);const o=s.selected;if(""===p.value&&o&&("event_broadcast"===o.type||"event_broadcastandwait"===o.type||"event_whenbroadcastreceived"===o.type))return void s.DropDownDiv.hide();for(const{item:e}of g)if(!e.element.hidden){w(e.element,!0);break}}else if("Escape"===e.key)s.DropDownDiv.hide();else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault(),e.stopPropagation();const t=g.filter((e=>e.score>=0)).map((e=>e.item));if(0===t.length)return;let o=-1;for(let e=0;e<t.length;e++)if(t[e].element.classList.contains("goog-menuitem-highlight")){o=e;break}const n=t.length-1;let s=0;s="ArrowDown"===e.key?-1===o||o===n?0:o+1:-1===o||0===o?n:o-1,w(t[s].element,!1)}}function x(e){var t;return[n(e,{name:(null===(t=p)||void 0===t?void 0:t.value.trim())||""}),e]}s.FieldVariable.prototype.onItemSelected=function(e,t){const o=this.sourceBlock_;if(o&&o.workspace&&0!==p.value.length){const e=o.workspace,n=t.getValue();if(Object.prototype.hasOwnProperty.call(l,n)){const t=l[n];s.Events.setGroup(!0);const o=t.createVariable(e,p.value.trim());return this.sourceBlock_&&this.setValue(o.getId()),void s.Events.setGroup(!1)}}return v.call(this,e,t)}},"userscript.css":o.n(n).a}},1821:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return n}));const n={"userscript.js":async e=>{let{addon:t,console:o}=e;if(!t.tab.redux.state)return o.warn("Redux is not available!");t.tab.redux.initialize(),t.tab.redux.addEventListener("statechanged",(e=>{let{detail:n}=e;if(t.self.disabled)return;const s=n;if(!s.action||"scratch-paint/clipboard/SET"!==s.action.type)return;const r=s.next.scratchPaint.clipboard.items;if(1!==r.length)return;const i=r[0];if(!Array.isArray(i)||"Raster"!==i[0])return o.log("copied element is vector");const a=i[1].source;t.tab.copyImage(a).then((()=>o.log("Image successfully copied"))).catch((e=>o.error("Image could not be copied: ".concat(e))))}))}}},1822:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return s}));var n=o(1659);const s={"userscript.js":async function(e){let{addon:t}=e;const o=await t.tab.traps.getPaper(),s=function(){var e,s;if(!o.tool||!o.tool.boundingBoxTool)return;const r=null===(e=o.tool.boundingBoxTool._modeMap)||void 0===e||null===(s=e.SCALE)||void 0===s?void 0:s.constructor;if(!r||r.hasSkew)return;r.hasSkew=!0;const i=r.prototype.onMouseDown;r.prototype.onMouseDown=function(e,t,o){this.active||(this.index=e.item.data.index,i.call(this,e,t,o),this.skewCenter=!1,this.lastSkx=0,this.lastSky=0,this.skewBounds=this.itemGroup.bounds.clone())},n.a.paintSkew=function(e,n){if(!this.active)return;if(t.self.disabled)return n();const s=this.skewBounds,r=(e,t)=>{if(0===e&&0===t)return;let n;if(!this.skewCenter)switch(this._getRectCornerNameByIndex(this.index)){case"topCenter":case"leftCenter":n=this.itemGroup.position.add(new o.Point(s.width/2,s.height/2));break;case"bottomCenter":case"rightCenter":n=this.itemGroup.position.subtract(new o.Point(s.width/2,s.height/2))}const r=this.skewCenter?this.itemGroup.position:n,i=this.skewCenter?2:1,a=e/s.height*i,c=t/s.width*i;this.itemGroup.shear(a,c,r),this.selectionAnchor&&this.selectionAnchor.shear(-a,-c)};r(-this.lastSkx,-this.lastSky),this.skewCenter=e.modifiers.alt;let i=0,a=0;if(this.lastSkx=0,this.lastSky=0,!e.modifiers.control&&!e.modifiers.command||this.isCorner)n();else{this.centered=!1,this.itemGroup.scale(1/this.lastSx,1/this.lastSy,this.pivot),this.selectionAnchor&&this.selectionAnchor.scale(this.lastSx,this.lastSy),this.lastSx=1,this.lastSy=1;const t=e.point.subtract(this.pivot);switch(this._getRectCornerNameByIndex(this.index)){case"topCenter":t.x*=-1,t.y=0;break;case"bottomCenter":t.y=0;break;case"leftCenter":t.y*=-1,t.x=0;break;case"rightCenter":t.x=0;break;default:t.x=0,t.y=0}i=t.x,a=t.y,r(i,a)}this.lastSkx=i,this.lastSky=a},Object(n.b)(o,r)};t.tab.redux.initialize(),t.tab.redux.addEventListener("statechanged",(e=>{const t=e.detail.action;"scratch-paint/modes/CHANGE_MODE"!==t.type||"BIT_SELECT"!==t.mode&&"SELECT"!==t.mode||s()})),s()}}},1823:function(e,t,o){"use strict";function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o.r(t),o.d(t,"resources",(function(){return a}));var i=o(1739);const a={"userscript.js":async function(e){let{addon:t,msg:o,console:n}=e;const r=Symbol(),i=e=>document.body.classList.toggle("sa-stage-color-picker-picking",e);let a=!1;document.addEventListener("click",(e=>{a=e.isTrusted}),{capture:!0}),t.tab.redux.initialize(),t.tab.redux.addEventListener("statechanged",(e=>{const o=e.detail.action;o[r]||(!t.self.disabled&&a&&"scratch-paint/eye-dropper/ACTIVATE_COLOR_PICKER"===o.type&&(i(!0),t.tab.redux.dispatch({type:"scratch-gui/color-picker/ACTIVATE_COLOR_PICKER",callback:e=>{queueMicrotask((()=>{t.tab.redux.dispatch(s(s({},o),{},{[r]:!0})),o.callback(e),o.previousMode&&o.previousMode.activate(),t.tab.redux.dispatch({type:"scratch-paint/eye-dropper/DEACTIVATE_COLOR_PICKER",[r]:!0}),i(!1)}))}})),"scratch-paint/eye-dropper/DEACTIVATE_COLOR_PICKER"===o.type&&(i(!1),t.tab.redux.state.scratchGui.colorPicker.active&&t.tab.redux.dispatch({type:"scratch-gui/color-picker/DEACTIVATE_COLOR_PICKER",[r]:!0})))}))},"style.css":o.n(i).a}},1832:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return n}));const n={"userscript.js":async function(e){let{addon:t,console:o,msg:n}=e;const s=await t.tab.traps.getBlockly(),r=t.tab.traps.vm;let i={},a={};const c={isNoop:!0},l=()=>{const e=Math.floor(256*Math.random()*256*256);return"#".concat(e.toString(16).padStart(6,"0"))},d=()=>{if(i={},a={},t.settings.get("motion")&&(i.motion_turnright=[c,{opcode:"motion_turnleft"}],i.motion_turnleft=[{opcode:"motion_turnright"},c],i.motion_setx=[c,{opcode:"motion_changexby",remapInputName:{X:"DX"}},{opcode:"motion_sety",remapInputName:{X:"Y"}},{opcode:"motion_changeyby",remapInputName:{X:"DY"}}],i.motion_changexby=[{opcode:"motion_setx",remapInputName:{DX:"X"}},c,{opcode:"motion_sety",remapInputName:{DX:"Y"}},{opcode:"motion_changeyby",remapInputName:{DX:"DY"}}],i.motion_sety=[{opcode:"motion_setx",remapInputName:{Y:"X"}},{opcode:"motion_changexby",remapInputName:{Y:"DX"}},c,{opcode:"motion_changeyby",remapInputName:{Y:"DY"}}],i.motion_changeyby=[{opcode:"motion_setx",remapInputName:{DY:"X"}},{opcode:"motion_changexby",remapInputName:{DY:"DX"}},{opcode:"motion_sety",remapInputName:{DY:"Y"}},c],i.motion_xposition=[c,{opcode:"motion_yposition"}],i.motion_yposition=[{opcode:"motion_xposition"},c]),t.settings.get("looks")&&(i.looks_seteffectto=[c,{opcode:"looks_changeeffectby",remapInputName:{VALUE:"CHANGE"}}],i.looks_changeeffectby=[{opcode:"looks_seteffectto",remapInputName:{CHANGE:"VALUE"}},c],i.looks_setsizeto=[c,{opcode:"looks_changesizeby",remapInputName:{SIZE:"CHANGE"}}],i.looks_changesizeby=[{opcode:"looks_setsizeto",remapInputName:{CHANGE:"SIZE"}},c],i.looks_costumenumbername=[c,{opcode:"looks_backdropnumbername"}],i.looks_backdropnumbername=[{opcode:"looks_costumenumbername"},c],i.looks_show=[c,{opcode:"looks_hide"}],i.looks_hide=[{opcode:"looks_show"},c],i.looks_nextcostume=[c,{opcode:"looks_nextbackdrop"}],i.looks_nextbackdrop=[{opcode:"looks_nextcostume"},c],i.looks_say=[c,{opcode:"looks_sayforsecs",createInputs:{SECS:{shadowType:"math_number",value:"2"}}},{opcode:"looks_think"},{opcode:"looks_thinkforsecs",createInputs:{SECS:{shadowType:"math_number",value:"2"}}}],i.looks_think=[{opcode:"looks_say"},{opcode:"looks_sayforsecs",createInputs:{SECS:{shadowType:"math_number",value:"2"}}},c,{opcode:"looks_thinkforsecs",createInputs:{SECS:{shadowType:"math_number",value:"2"}}}],i.looks_sayforsecs=[{opcode:"looks_say",splitInputs:["SECS"]},{opcode:"looks_think",splitInputs:["SECS"]},c,{opcode:"looks_thinkforsecs"}],i.looks_thinkforsecs=[{opcode:"looks_say",splitInputs:["SECS"]},{opcode:"looks_think",splitInputs:["SECS"]},{opcode:"looks_sayforsecs"},c],i.looks_switchbackdropto=[c,{opcode:"looks_switchbackdroptoandwait"}],i.looks_switchbackdroptoandwait=[{opcode:"looks_switchbackdropto"},c],i.looks_gotofrontback=[c,{opcode:"looks_goforwardbackwardlayers",remapInputName:{FRONT_BACK:"FORWARD_BACKWARD"},mapFieldValues:{FRONT_BACK:{front:"forward",back:"backward"}},createInputs:{NUM:{shadowType:"math_integer",value:"1"}}}],i.looks_goforwardbackwardlayers=[{opcode:"looks_gotofrontback",splitInputs:["NUM"],remapInputName:{FORWARD_BACKWARD:"FRONT_BACK"},mapFieldValues:{FORWARD_BACKWARD:{forward:"front",backward:"back"}}},c]),t.settings.get("sound")&&(i.sound_play=[c,{opcode:"sound_playuntildone"}],i.sound_playuntildone=[{opcode:"sound_play"},c],i.sound_seteffectto=[c,{opcode:"sound_changeeffectby"}],i.sound_changeeffectby=[{opcode:"sound_seteffectto"},c],i.sound_setvolumeto=[c,{opcode:"sound_changevolumeby"}],i.sound_changevolumeby=[{opcode:"sound_setvolumeto"},c]),t.settings.get("event")&&(i.event_broadcast=[c,{opcode:"event_broadcastandwait"}],i.event_broadcastandwait=[{opcode:"event_broadcast"},c]),t.settings.get("control")&&(i.control_if=[c,{opcode:"control_if_else"}],i.control_if_else=[{opcode:"control_if",splitInputs:["SUBSTACK2"]},c],i.control_repeat_until=[c,{opcode:"control_wait_until",splitInputs:["SUBSTACK"]},{opcode:"control_forever",splitInputs:["CONDITION"]}],i.control_forever=[{opcode:"control_repeat_until"},c],i.control_wait_until=[{opcode:"control_repeat_until"},c]),t.settings.get("operator")&&(i.operator_equals=[{opcode:"operator_gt"},c,{opcode:"operator_lt"}],i.operator_gt=[c,{opcode:"operator_equals"},{opcode:"operator_lt"}],i.operator_lt=[{opcode:"operator_gt"},{opcode:"operator_equals"},c],i.operator_add=[c,{opcode:"operator_subtract"},{opcode:"operator_multiply"},{opcode:"operator_divide"},{opcode:"operator_mod"}],i.operator_subtract=[{opcode:"operator_add"},c,{opcode:"operator_multiply"},{opcode:"operator_divide"},{opcode:"operator_mod"}],i.operator_multiply=[{opcode:"operator_add"},{opcode:"operator_subtract"},c,{opcode:"operator_divide"},{opcode:"operator_mod"}],i.operator_divide=[{opcode:"operator_add"},{opcode:"operator_subtract"},{opcode:"operator_multiply"},c,{opcode:"operator_mod"}],i.operator_mod=[{opcode:"operator_add"},{opcode:"operator_subtract"},{opcode:"operator_multiply"},{opcode:"operator_divide"},c],i.operator_and=[c,{opcode:"operator_or"}],i.operator_or=[{opcode:"operator_and"},c]),t.settings.get("sensing")&&(i.sensing_mousex=[c,{opcode:"sensing_mousey"}],i.sensing_mousey=[{opcode:"sensing_mousex"},c],i.sensing_touchingcolor=[c,{opcode:"sensing_coloristouchingcolor",createInputs:{COLOR2:{shadowType:"colour_picker",value:l}}}],i.sensing_coloristouchingcolor=[{opcode:"sensing_touchingcolor",splitInputs:["COLOR2"]},c]),t.settings.get("data")&&(i.data_setvariableto=[c,{opcode:"data_changevariableby",remapShadowType:{VALUE:"math_number"}}],i.data_changevariableby=[{opcode:"data_setvariableto",remapShadowType:{VALUE:"text"}},c],i.data_showvariable=[c,{opcode:"data_hidevariable"}],i.data_hidevariable=[{opcode:"data_showvariable"},c],i.data_showlist=[c,{opcode:"data_hidelist"}],i.data_hidelist=[{opcode:"data_showlist"},c],i.data_replaceitemoflist=[c,{opcode:"data_insertatlist"}],i.data_insertatlist=[{opcode:"data_replaceitemoflist"},c],i.data_deleteoflist=[c,{opcode:"data_deletealloflist",splitInputs:["INDEX"]}],i.data_deletealloflist=[{opcode:"data_deleteoflist",createInputs:{INDEX:{shadowType:"math_integer",value:"1"}}},c]),t.settings.get("extension")&&(i.pen_penDown=[c,{opcode:"pen_penUp"}],i.pen_penUp=[{opcode:"pen_penDown"},c],i.pen_setPenColorParamTo=[c,{opcode:"pen_changePenColorParamBy"}],i.pen_changePenColorParamBy=[{opcode:"pen_setPenColorParamTo"},c],i.pen_setPenHueToNumber=[c,{opcode:"pen_changePenHueBy"}],i.pen_changePenHueBy=[{opcode:"pen_setPenHueToNumber"},c],i.pen_setPenShadeToNumber=[c,{opcode:"pen_changePenShadeBy"}],i.pen_changePenShadeBy=[{opcode:"pen_setPenShadeToNumber"},c],i.pen_setPenSizeTo=[c,{opcode:"pen_changePenSizeBy"}],i.pen_changePenSizeBy=[{opcode:"pen_setPenSizeTo"},c],i.music_setTempo=[c,{opcode:"music_changeTempo"}],i.music_changeTempo=[{opcode:"music_setTempo"},c]),t.settings.get("sa")){const e="â€‹â€‹logâ€‹â€‹ %s",t="â€‹â€‹warnâ€‹â€‹ %s",o="â€‹â€‹errorâ€‹â€‹ %s",s=n("debugger_log"),r=n("debugger_warn"),i=n("debugger_error"),c={mutate:{proccode:e},msg:s},l={mutate:{proccode:t},msg:r},d={mutate:{proccode:o},msg:i};a[e]=[{msg:s,isNoop:!0},l,d],a[t]=[c,{msg:r,isNoop:!0},d],a[o]=[c,l,{msg:i,isNoop:!0}]}i.data_variable=[],i.data_listcontents=[]};d(),t.settings.addEventListener("change",d);const u=e=>"text"===e?"TEXT":"colour_picker"===e?"COLOUR":"NUM",p=(e,t)=>()=>{var o;if(!t.isNoop)if(t.fieldValue)e.setFieldValue(t.fieldValue,"VALUE");else try{s.Events.setGroup(!0);const n=e.workspace,r=[];if(t.splitInputs)for(const o of t.splitInputs){const t=e.getInput(o);if(!t)continue;const n=t.connection;if(n&&n.isConnected()){const e=n.targetBlock();e.isShadow()||(n.disconnect(),r.push(e))}}const i=s.Xml.blockToDom(e),a=e.getRelativeToSurfaceXY();i.setAttribute("x",a.x),i.setAttribute("y",a.y),t.opcode&&i.setAttribute("type",t.opcode);const c=e.getParent();let l,d;if(c){l=c.getConnections_().find((t=>t.targetConnection&&t.targetConnection.sourceBlock_===e));const t=e.getConnections_().find((e=>e.targetConnection&&e.targetConnection.sourceBlock_===c));d=t.type}for(const e of Array.from(i.children)){const o=e.getAttribute("name");if(t.splitInputs&&t.splitInputs.includes(o)){i.removeChild(e);continue}const n=t.remapInputName&&t.remapInputName[o];n&&e.setAttribute("name",n);const s=t.remapShadowType&&t.remapShadowType[o];if(s){const t=e.firstChild,o=t.firstChild;t.setAttribute("type",s),o.setAttribute("name",u(s))}const r=t.mapFieldValues&&t.mapFieldValues[o];if(r&&"FIELD"===e.tagName){const t=r[e.innerText];"string"==typeof t&&(e.innerText=t)}}if(t.mutate){const e=i.querySelector("mutation");for(const[o,n]of Object.entries(t.mutate))e.setAttribute(o,n)}if(t.createInputs)for(const[e,n]of Object.entries(t.createInputs)){const t=document.createElement("value");t.setAttribute("name",e);const s=document.createElement("shadow");s.setAttribute("type",n.shadowType);const r=document.createElement("field");r.setAttribute("name",u(n.shadowType)),r.innerText="function"==typeof(o=n.value)?o():o,s.appendChild(r),t.appendChild(s),i.appendChild(t)}e.dispose();const p=((e,t)=>{const o=s.Xml.domToBlock(t,e),n=+t.getAttribute("x"),r=+t.getAttribute("y");return o.moveBy(n,r),o})(n,i);if(l){const e=p.getConnections_();e.find((e=>e.type===d)).connect(l)}for(const e of r){const t=e.getSvgRoot();t.parentNode.appendChild(t)}}finally{s.Events.setGroup(!1)}};t.tab.createBlockContextMenu(((e,o)=>{if(!t.self.disabled){const c=o.type;let l=i[o.type]||[];const d=t.settings.get("customargs")?t.settings.get("customargsmode"):"off";if("off"!==d&&["argument_reporter_boolean","argument_reporter_string_number"].includes(c)&&!o.isShadow()){const t=h();if("all"===d)switch(c){case"argument_reporter_string_number":l=Object.values(t).map((e=>e.stringArgs)).flat(1);break;case"argument_reporter_boolean":l=Object.values(t).map((e=>e.boolArgs)).flat(1)}else if("defOnly"===d){const n=o.getRootBlock();if("procedures_definition"!==n.type)return e;const s=t[n.getChildren(!0)[0].getProcCode()];switch(c){case"argument_reporter_string_number":l=s.stringArgs;break;case"argument_reporter_boolean":l=s.boolArgs}}const n=o.getFieldValue("VALUE");l=(r=l,[...new Set(r)]).map((e=>({isNoop:e===n,fieldValue:e,msg:e})))}if("procedures_call"===o.type){const e=o.getProcCode();a[e]&&(l=a[e])}if(t.settings.get("noop")||(l=l.filter((e=>!e.isNoop))),l.forEach(((t,s)=>{const r=e.findIndex((e=>e._isDevtoolsFirstItem)),i=-1!==r?r:e.length,a=t.msg?t.msg:t.opcode?n(t.opcode):n(o.type);e.splice(i,0,{enabled:!0,text:a,callback:p(o,t),separator:0===s})})),"data_variable"===o.type||"data_listcontents"===o.type){const t=e.findIndex((e=>e.text===s.Msg.DELETE_BLOCK)),o=e[t+1];o&&(o.separator=!0)}}var r;return e}),{blocks:!0});const h=()=>{const e={},t=r.editingTarget;return Object.values(t.blocks._blocks).filter((e=>"procedures_prototype"===e.opcode)).forEach((t=>{const o=t.mutation.proccode,n=JSON.parse(t.mutation.argumentnames),s=o.split(/(?=[^\\]%[nbs])/g).map((e=>e.trim())).filter((e=>"%"===e.charAt(0))).map((e=>e.substring(0,2)));const r=[],i=[];for(let e=0;e<n.length;e++)"%b"===s[e]?i.push(n[e]):r.push(n[e]);e[o]={stringArgs:r,boolArgs:i}})),e}}}},1838:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return s}));var n=o(1664);const s={"userscript.js":async function(e){let{addon:t,console:o}=e;const s=()=>{n.b(!t.self.disabled,t.settings.get("invertDrag"))};t.self.addEventListener("disabled",s),t.self.addEventListener("reenabled",s),t.settings.addEventListener("change",s),s(),n.a(t)}}},1843:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return n}));const n={"userscript.js":async e=>{let{addon:t,console:o,msg:n}=e;const s=["sound","costume"];t.tab.createEditorContextMenu((e=>{const o=t.tab.traps.vm.editingTarget;"sound"===e.type?o.reorderSound(e.index,0):o.reorderCostume(e.index,0),queueMicrotask((()=>{t.tab.traps.vm.emitTargetsUpdate(),t.tab.traps.vm.runtime.emitProjectChanged(),e.target.click()}))}),{types:s,position:"assetContextMenuAfterExport",order:1,label:n("top"),condition:e=>0!==e.index}),t.tab.createEditorContextMenu((e=>{const o=t.tab.traps.vm.editingTarget;"sound"===e.type?o.reorderSound(e.index,1/0):o.reorderCostume(e.index,1/0),queueMicrotask((()=>{t.tab.traps.vm.emitTargetsUpdate(),t.tab.traps.vm.runtime.emitProjectChanged(),e.target.click()}))}),{types:s,position:"assetContextMenuAfterExport",order:2,label:n("bottom"),condition:e=>e.index!==e.target.parentNode.parentNode.childElementCount-1})}}},1846:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return s}));var n=o(1664);const s={"userscript.js":async function(e){let{addon:t,console:o}=e;const s=()=>{n.c(!t.self.disabled)};t.self.addEventListener("disabled",s),t.self.addEventListener("reenabled",s),s(),n.a(t)}}},1847:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return n}));const n={"userscript.js":async function(e){let{addon:t,msg:o,console:n}=e;const s=t.tab.traps.vm,r=await t.tab.traps.getBlockly(),i="RENAME_BROADCAST_MESSAGE_ID",a=r.BROADCAST_MESSAGE_VARIABLE_TYPE,c=r.FieldVariable.dropdownCreate;r.FieldVariable.dropdownCreate=function(){const e=c.call(this);return!t.self.disabled&&this.defaultType_===a&&this.sourceBlock_.workspace.getVariableTypes().includes("broadcast_msg")&&e.push([o("RENAME_BROADCAST"),i]),e};const l=r.FieldVariable.prototype.onItemSelected;r.FieldVariable.prototype.onItemSelected=function(e,t){const o=this.sourceBlock_.workspace;if(!this.sourceBlock_||!o||t.getValue()!==i)return l.call(this,e,t);h(o,this.variable_)};const d=()=>{const e=new Set(s.runtime.targets.map((e=>e.blocks)));for(const t of e)t.resetCache()},u=e=>{const t=r.Events.FIRE_QUEUE_[0],o=t.run;t.run=function(t){o.call(this,t),e(t)}},p=(e,t)=>{const o=s.runtime.getTargetForStage().variables[e];o.name=t,o.value=t;const n=new Set(s.runtime.targets.map((e=>e.blocks)));for(const o of n)for(const n of Object.values(o._blocks)){const o=n.fields&&n.fields.BROADCAST_OPTION;o&&o.id===e&&(o.value=t)}d()},h=(e,t)=>{const n=o("RENAME_BROADCAST_MODAL_TITLE"),i=t.name,c=t.getId(),l=o("RENAME_BROADCAST_TITLE",{name:i}),h=i;r.prompt(l,h,(function(t){if(!(t=r.Variables.trimName_(t)))return;!!e.getVariable(t,a)?((e,t,o,n)=>{const i=s.runtime.getTargetForStage().lookupBroadcastByInputValue(n).id;r.Events.setGroup(!0);for(const o of e.getAllBlocks())for(const e of o.inputList)for(const o of e.fieldRow)"BROADCAST_OPTION"===o.name&&o.getValue()===t&&o.setValue(i);e.deleteVariableById(t),r.Events.setGroup(!1);const a=[],c=new Set(s.runtime.targets.map((e=>e.blocks)));for(const e of c)for(const o of Object.values(e._blocks)){const e=o.fields&&o.fields.BROADCAST_OPTION;e&&e.id===t&&a.push(o)}const l=e=>{const s=e?i:t,r=e?n:o;for(const e of a){const t=e.fields.BROADCAST_OPTION;t.id=s,t.value=r}d()};l(!0),u((e=>{l(e)}))})(e,c,i,t):((e,t,o,n)=>{e.renameVariableById(t,n),p(t,n),u((e=>{p(t,e?n:o)}))})(e,c,i,t)}),n,a)};(()=>{const e=r.getMainWorkspace(),t=e&&e.getFlyout();if(e&&t){const o=[...e.getAllBlocks(),...t.getWorkspace().getAllBlocks()];for(const e of o)for(const t of e.inputList)for(const e of t.fieldRow)e instanceof r.FieldVariable&&(e.menuGenerator_=r.FieldVariable.dropdownCreate)}})()}}},1849:function(e,t,o){"use strict";o.r(t),o.d(t,"resources",(function(){return s}));var n=o(1775);const s={"userscript.js":async function(e){let{addon:t,console:o}=e;const n=t.tab.traps.vm,s=()=>{u.classList.toggle("sa-comment-preview-delay","none"!==t.settings.get("delay")),u.classList.toggle("sa-comment-preview-reduce-transparency",t.settings.get("reduce-transparency")),u.classList.toggle("sa-comment-preview-fade",!t.settings.get("reduce-animation"))};let r=null,i=null,a=0,c=0,l=!1;const d=document.createElement("div");d.classList.add("sa-comment-preview-outer");const u=document.createElement("div");u.classList.add("sa-comment-preview-inner"),u.classList.add("sa-comment-preview-hidden"),s(),t.settings.addEventListener("change",s),t.tab.displayNoneWhileDisabled(d),d.appendChild(u),document.body.appendChild(d);const p=e=>n.editingTarget.blocks.getBlock(e)||n.runtime.flyoutBlocks.getBlock(e),h=e=>e&&e.comment&&n.editingTarget.comments[e.comment],g=()=>{d.style.transform="translate(".concat(a+8,"px, ").concat(c+8,"px)")},m=()=>{r&&(r=null,u.classList.add("sa-comment-preview-hidden"))};document.addEventListener("mouseover",(e=>{if(t.self.disabled)return;if(clearTimeout(i),l)return;const o=e.target.closest(".blocklyBubbleCanvas > g, .blocklyBlockCanvas .blocklyDraggable[data-id]");if(o===r)return;if(!o)return void m();let s=null;if(t.settings.get("hover-view")&&e.target.closest(".blocklyBubbleCanvas > g")&&!e.target.closest("line")){if("none"!==o.querySelector("text.scratchCommentText").getAttribute("display")){const e=o.querySelector("textarea");s=e.value}}else if(e.target.closest(".blocklyBlockCanvas .blocklyDraggable[data-id]")){const e=o.dataset.id,r=p(e),i=h(r);if(t.settings.get("hover-view-block")&&i)s=i.text;else if(r&&"procedures_call"===r.opcode&&t.settings.get("hover-view-procedure")){const e=(e=>{const t=Object.values(n.editingTarget.blocks._blocks).find((t=>"procedures_prototype"===t.opcode&&t.mutation.proccode===e));if(t){if(t.parent)return p(t.parent);const e=t.id;return Object.values(n.editingTarget.blocks._blocks).find((t=>"procedures_definition"===t.opcode&&t.inputs.custom_block&&t.inputs.custom_block.block===e))}return null})(r.mutation.proccode),t=h(e);t&&(s=t.text)}}null!==s&&""!==s.trim()?i=(e=>{if(!u.classList.contains("sa-comment-preview-hidden"))return void e();const o=t.settings.get("delay");return"long"===o?setTimeout(e,500):"short"===o?setTimeout(e,300):void e()})((()=>{r=o,(e=>{u.innerText=e,u.classList.remove("sa-comment-preview-hidden"),g()})(s)})):m()})),document.addEventListener("mousemove",(e=>{a=e.clientX,c=e.clientY,l=!1,t.settings.get("follow-mouse")&&!u.classList.contains("sa-comment-preview-hidden")&&g()})),document.addEventListener("mousedown",(()=>{m(),l=!0}),{capture:!0})},"userstyle.css":o.n(n).a}}}]);