(window.webpackJsonpGUI=window.webpackJsonpGUI||[]).push([[18],{1625:function(t,e,s){"use strict";s.r(e),s.d(e,"resources",(function(){return r}));const r={"userscript.js":async function(t){let{addon:e,global:s,console:r,msg:i}=t;await e.tab.traps.getPaper();const n=t=>Math.round(+t).toString(16).toUpperCase().padStart(2,"0"),o=t=>{if(null===t)return null;if("string"==typeof t){if(t.startsWith("#"))return t.substring(0,9).toUpperCase();const e=t.match(/^rgb\((\d+)\s*,(\d+)\s*,(\d+)\)$/);if(e){const[t,s,r,i]=e;return"#".concat(n(s)).concat(n(r)).concat(n(i))}const s=t.match(/^rgba\((\d+)\s*,(\d+)\s*,(\d+),([\d.]+)\)$/);if(s){const[t,e,r,i,o]=s;return"#".concat(n(e)).concat(n(r)).concat(n(i)).concat(n(255*o))}}return r.log("Could not normalize color",t),null},a=t=>t===c?c:o(t),c="scratch-paint/style-path/mixed",l=o("#9966FF"),p=o("#000000"),d=Object.assign(Object.create(null),{BRUSH:{resetsFill:!0},ERASER:{},LINE:{resetsStroke:!0,requiresNonZeroStrokeWidth:!0,supportsGradient:!0},FILL:{resetsFill:!0,supportsGradient:!0},SELECT:{supportsGradient:!0},RESHAPE:{supportsGradient:!0},OVAL:{resetsFill:!0,resetsStroke:!0,supportsGradient:!0},RECT:{resetsFill:!0,resetsStroke:!0,supportsGradient:!0},TEXT:{resetsFill:!0,resetsStroke:!0},BIT_BRUSH:{resetsFill:!0},BIT_LINE:{resetsFill:!0,requiresNonZeroStrokeWidth:!0},BIT_OVAL:{resetsFill:!0,resetsStroke:!0,supportsGradient:!0},BIT_RECT:{resetsFill:!0,resetsStroke:!0,supportsGradient:!0},BIT_TEXT:{resetsFill:!0,resetsStroke:!0},BIT_FILL:{resetsFill:!0,supportsGradient:!0},BIT_ERASER:{},BIT_SELECT:{supportsGradient:!0}}),u=()=>d[e.tab.redux.state.scratchPaint.mode];class g{constructor(t,e,s,r){this.reduxPropertyName=t,this.primaryAction=e,this.secondaryAction=s,this.gradientTypeAction=r}get(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.tab.redux.state).scratchPaint.color[this.reduxPropertyName]}set(t){const s=this.get(),r=a(t.primary);s.primary!==r&&e.tab.redux.dispatch({type:this.primaryAction,color:r});const i=u();if(i&&i.supportsGradient){const r=a(t.secondary);s.secondary!==r&&e.tab.redux.dispatch({type:this.secondaryAction,color:r}),s.gradientType!==t.gradientType&&e.tab.redux.dispatch({type:this.gradientTypeAction,gradientType:t.gradientType})}}}const h=new g("fillColor","scratch-paint/fill-style/CHANGE_FILL_COLOR","scratch-paint/fill-style/CHANGE_FILL_COLOR_2","scratch-paint/fill-style/CHANGE_FILL_GRADIENT_TYPE"),y=new g("strokeColor","scratch-paint/stroke-style/CHANGE_STROKE_COLOR","scratch-paint/stroke-style/CHANGE_STROKE_COLOR_2","scratch-paint/stroke-style/CHANGE_STROKE_GRADIENT_TYPE"),E=t=>({primary:t,secondary:null,gradientType:"SOLID"});let T,_,S;const k=()=>{T=E(o(e.settings.get("fill"))),_=E(o(e.settings.get("stroke"))),S=e.settings.get("strokeSize")};k();const f=()=>{h.set(T)},m=()=>{y.set(_)},G=t=>{let s=S;0===s&&t&&(s=1),e.tab.redux.state.scratchPaint.color.strokeWidth!==s&&e.tab.redux.dispatch({type:"scratch-paint/stroke-width/CHANGE_STROKE_WIDTH",strokeWidth:s})};e.self.disabled||(f(),m(),G(!1)),e.settings.addEventListener("change",()=>{e.settings.get("persistence")||k()});const L=t=>null!==t.primary&&t.primary!==c;let b=!1;e.tab.redux.initialize(),e.tab.redux.addEventListener("statechanged",t=>{let{detail:s}=t;if(e.self.disabled)return;const i=s.action;if(!b&&e.settings.get("persistence")){const t=h.get();h.get(s.prev)!==t&&L(t)&&(T=t);const e=y.get();y.get(s.prev)!==e&&L(e)&&(_=e);const r=s.next.scratchPaint.color.strokeWidth;"number"==typeof r&&(S=r)}"scratch-paint/modes/CHANGE_MODE"===i.type&&(b=!0,queueMicrotask(()=>{if(b=!1,e.settings.get("persistence")){const t=u();if(!t)return void r.warn("unknown tool",e.tab.redux.state.scratchPaint.mode);t.resetsFill&&f(),t.resetsStroke&&(G(!!t.requiresNonZeroStrokeWidth),m())}else{const t=h.get(s.prev);if(null===t.primary||t.primary===c){h.get().primary===l&&f()}const e=y.get(s.prev);if(null===e.primary||e.primary===c){y.get().primary===p&&(G(!0),m())}}}))})}}}}]);