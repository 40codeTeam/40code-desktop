(window.webpackJsonpGUI=window.webpackJsonpGUI||[]).push([[17],{1497:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));class s{constructor(e,t){this.targetId=e.id,this.id=t.id}}},1499:function(e,t,n){"use strict";t.a=(e,t)=>{const n=document.createElement("a");if(document.body.appendChild(n),navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t,e);else if("download"in HTMLAnchorElement.prototype){const s=window.URL.createObjectURL(t);n.href=s,n.download=e,n.type=t.type,n.click(),window.setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(s)},1e3)}else{let e=window.open("","_blank");const n=new FileReader;n.onloadend=function(){e.location.href=n.result,e=null},n.readAsDataURL(t)}}},1500:function(e,t,n){"use strict";const s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg");o.style.position="fixed",o.style.top="-999999px",o.style.width="0",o.style.height="0",document.body.appendChild(o);let a=0;const i=new WeakMap,r=e=>(i.get(e)||i.set(e,new Set),i.get(e)),c=(e,t)=>{let n;for(const e of t)(!n||e.priority>n.priority)&&(n=e);e.style.filter=n?n.filter:""},g=(e,t)=>{const n=r(e);n.add(t),c(e,n)},d=(e,t)=>{const n=r(e);n.delete(t),c(e,n)};t.a=class{constructor(e,t){this.priority=e;const n="sa_glower_filter".concat(a++);this.filter='url("#'.concat(n,'")'),this.previousElements=new Set;const i=document.createElementNS(s,"filter");i.id=n,i.setAttribute("width","180%"),i.setAttribute("height","160%"),i.setAttribute("x","-40%"),i.setAttribute("y","-30%");const r=document.createElementNS(s,"feGaussianBlur");r.setAttribute("in","SourceGraphic"),r.setAttribute("stdDeviation","4"),i.appendChild(r);const c=document.createElementNS(s,"feComponentTransfer");c.setAttribute("result","outBlur"),i.appendChild(c);const g=document.createElementNS(s,"feFuncA");g.setAttribute("type","table"),g.setAttribute("tableValues","0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"),c.appendChild(g);const d=document.createElementNS(s,"feFlood");d.setAttribute("flood-opacity","1"),d.setAttribute("result","outColor"),i.appendChild(d),this.filterFlood=d;const l=document.createElementNS(s,"feComposite");l.setAttribute("in","outColor"),l.setAttribute("in2","outBlur"),l.setAttribute("operator","in"),l.setAttribute("result","outGlow"),i.appendChild(l);const u=document.createElementNS(s,"feComposite");u.setAttribute("in","SourceGraphic"),u.setAttribute("in2","outGlow"),u.setAttribute("operator","over"),i.appendChild(u),o.appendChild(i),this.setColor(t)}setColor(e){this.filterFlood.setAttribute("flood-color",e)}setGlowingThreads(e){const t=new Set,n=Blockly.getMainWorkspace();if(n)for(const s of e)s.stack.forEach(e=>{const o=n.getBlockById(e);if(!o)return;if(!s.stack.find(e=>{let t=o;for(;t.childBlocks_.length;)if(t=t.childBlocks_[t.childBlocks_.length-1],e===t.id)return!0;return!1})&&o.svgPath_){const e=o.svgPath_;t.add(e)}});for(const e of this.previousElements)t.has(e)||d(e,this);for(const e of t)this.previousElements.has(e)||g(e,this);this.previousElements=t}}},1504:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n(1497);const o={block:null,timerID:null};class a{constructor(e){this.addon=e,this.addon.tab.traps.getBlockly().then(e=>{this.blockly=e}),this.vm=this.addon.tab.traps.vm,this.offsetX=32,this.offsetY=32,this.navigationHistory=new i(this),this._workspace=null}getEditingTarget(){return this.vm.runtime.getEditingTarget()}setEditingTarget(e){this.getEditingTarget().id!==e&&this.vm.setEditingTarget(e)}getWorkspace(){const e=Blockly.getMainWorkspace();return e.getToolbox()&&(this._workspace=e),this._workspace}scrollBlockIntoView(e){var t;let n,a=this.getWorkspace();if(e instanceof s.a?(this.setEditingTarget(e.targetId),n=a.getBlockById(e.id)):n=e&&e.id?e:a.getBlockById(e),!n)return;let i=n.getRootBlock(),r=this.getTopOfStackFor(n).getRelativeToSurfaceXY(),c=i.getRelativeToSurfaceXY(),g=a.scale,d=c.x*g,l=r.y*g,u=n.width+d,h=n.height+l,m=a.getMetrics();if(d<m.viewLeft+this.offsetX-4||u>m.viewLeft+m.viewWidth||l<m.viewTop+this.offsetY-4||h>m.viewTop+m.viewHeight){let e=d-m.contentLeft-this.offsetX,t=l-m.contentTop-this.offsetY;this.navigationHistory.storeView(this.navigationHistory.peek(),64),a.scrollbar.set(e,t),this.navigationHistory.storeView({left:e,top:t},64)}null===(t=this.blockly)||void 0===t||t.hideChaff(),class{static flash(e){o.timerID>0&&(clearTimeout(o.timerID),o.block.svgPath_&&(o.block.svgPath_.style.fill=""));let t=4,n=!0;o.block=e,function e(){o.block.svgPath_&&(o.block.svgPath_.style.fill=n?"#ffff80":""),n=!n,t--,t>0?o.timerID=setTimeout(e,200):(o.timerID=0,o.block=null)}()}}.flash(n)}getTopOfStackFor(e){let t=e;for(;t.getOutputShape()&&t.getSurroundParent();)t=t.getSurroundParent();return t}}class i{constructor(e){this.utils=e,this.views=[],this.forward=[]}storeView(e,t){this.forward=[];let n=this.utils.getWorkspace().getMetrics(),s={left:n.viewLeft,top:n.viewTop};(!e||r(s,e)>t)&&this.views.push(s)}peek(){return this.views.length>0?this.views[this.views.length-1]:null}goBack(){const e=this.utils.getWorkspace(),t=e.getMetrics();let n={left:t.viewLeft,top:t.viewTop},s=this.peek();if(!s)return;if(r(n,s)<64&&this.views.length>1&&(this.views.pop(),this.forward.push(s)),s=this.peek(),!s)return;let o=s.left-t.contentLeft,a=s.top-t.contentTop;e.scrollbar.set(o,a)}goForward(){let e=this.forward.pop();if(!e)return;this.views.push(e);let t=this.utils.getWorkspace(),n=t.getMetrics(),s=e.left-n.contentLeft,o=e.top-n.contentTop;t.scrollbar.set(s,o)}}function r(e,t){return Math.sqrt(Math.pow(e.left-t.left,2)+Math.pow(e.top-t.top,2))}},1557:function(e,t,n){var s=n(209);(e.exports=n(9)(!1)).push([e.i,'[dir="ltr"] .sa-debugger-container {\n  margin-right: 0.2rem;\n}\n\n[dir="rtl"] .sa-debugger-container {\n  margin-left: 0.2rem;\n}\n\n.sa-debugger-small .sa-debugger-container {\n  display: none !important;\n}\n\n.sa-debugger-interface {\n  display: none;\n  position: absolute;\n  z-index: 492;\n  background-color: white;\n  width: 565px;\n  height: 25rem;\n}\n[theme="dark"] .sa-debugger-interface {\n  background: var(--ui-primary);\n}\n\n.sa-debugger-interface h1 {\n  padding: 10px;\n  z-index: 10;\n  width: calc(100% - 20px);\n  font-size: 20px;\n}\n\n.sa-debugger-tabs {\n  margin: 0;\n  display: flex;\n  align-items: center;\n  padding: 0 15px;\n  font-size: 0.75rem;\n}\n.sa-debugger-tabs li {\n  margin: 0;\n  display: flex;\n  align-items: center;\n  padding: 0.5em 1em;\n  background-color: rgba(0, 0, 0, 0.1);\n  border: 1px solid rgba(0, 0, 0, 0.15);\n  border-radius: 1rem;\n  color: white;\n  cursor: pointer;\n}\n.sa-debugger-tabs li + li {\n  margin-inline-start: 10px;\n}\n.sa-debugger-tabs li:hover {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n.sa-debugger-tabs li.sa-debugger-tab-selected {\n  background-color: white;\n  background-clip: padding-box;\n  border-color: rgba(0, 0, 0, 0.25);\n  color: #4d97ff;\n}\n.sa-debugger-tabs li img {\n  margin: 0;\n  margin-right: 0.25rem;\n  width: 1rem;\n  filter: brightness(0) invert(1);\n}\n.sa-debugger-tabs li.sa-debugger-tab-selected img {\n  filter: none;\n}\n\n.sa-debugger-header-buttons img {\n  width: 20px;\n  height: 20px;\n}\n\n.sa-debugger-unpause {\n  animation: saDebuggerUnpause 2s infinite alternate;\n}\n\n@keyframes saDebuggerUnpause {\n  0% {\n    background-color: rgba(0, 0, 0, 0.15);\n  }\n  100% {\n    background-color: rgba(0, 0, 0, 0);\n  }\n}\n\n.sa-debugger-tab-content {\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n  cursor: auto;\n}\n\n.sa-debugger-chart {\n  width: 100%;\n  height: 100%;\n}\n\n.sa-performance-tab-content {\n  padding: 15px;\n}\n\n.sa-debugger-log-outer {\n  height: 100%;\n}\n\n.sa-debugger-log-inner {\n  position: relative;\n  overflow-y: auto;\n  font-size: 12px;\n  line-height: 1.2;\n  height: 100%;\n  contain: strict;\n}\n\n.sa-debugger-log-empty {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  font-size: 20px;\n  font-style: italic;\n}\n\n.sa-debugger-log-end {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 1px;\n}\n\n.sa-debugger-log {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 20px;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.15);\n  padding-left: 4px;\n  font-family: monospace;\n  color: #000;\n}\n[theme="dark"] .sa-debugger-log {\n  color: var(--text-primary);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n.sa-debugger-log[data-type="warn"] {\n  border-color: hsl(50deg, 100%, 75%);\n  color: hsl(39deg 100% 18%);\n  background-color: hsl(50deg 100% 95%);\n}\n.sa-debugger-log[data-type="error"] {\n  border-color: hsl(0deg 100% 92%);\n  color: red;\n  background-color: hsl(0deg 100% 95%);\n}\n[theme="dark"] .sa-debugger-log[data-type="warn"] {\n  border-color: hsl(50deg, 100%, 15%);\n  color: hsl(39deg 100% 90%);\n  background-color: hsl(50deg 100% 10%);\n}\n[theme="dark"] .sa-debugger-log[data-type="error"] {\n  border-color: hsl(0deg 100% 15%);\n  color: hsl(0deg 100% 77%);\n  background-color: hsl(0deg 100% 10%);\n}\n\n.sa-debugger-log-repeats {\n  background-color: hsla(163, 85%, 40%, 1);\n  color: white;\n  border-radius: 100px;\n  padding: 1px 6px;\n  margin-right: 4px;\n}\n[theme="dark"] .sa-debugger-log-repeats {\n  color: var(--ui-primary);\n}\n\n.sa-debugger-log-icon {\n  width: 16px;\n  height: 16px;\n  margin-right: 4px;\n}\n[data-type="warn"] .sa-debugger-log-icon {\n  background-image: url('+s(n(1558))+');\n}\n[data-type="error"] .sa-debugger-log-icon {\n  background-image: url('+s(n(1559))+");\n}\n.sa-debugger-threads .sa-debugger-log-icon {\n  background-image: url("+s(n(1560))+');\n}\n\n.sa-debugger-log-link {\n  color: inherit;\n  cursor: pointer;\n  opacity: 0.5;\n  text-decoration: underline;\n  float: right;\n  text-align: right;\n  max-width: 100%;\n  padding-left: 4px;\n  margin-right: 4px;\n  margin-left: auto;\n}\n[theme="dark"] .sa-debugger-log-link {\n  color: inherit;\n}\n.sa-debugger-log-link:hover {\n  text-decoration: underline;\n  color: #4d97ff;\n  opacity: 1;\n}\n.sa-debugger-log-link-unknown {\n  pointer-events: none;\n}\n\n.sa-debugger-log-text {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: pre;\n}\n.sa-debugger-log-text-empty {\n  font-style: italic;\n}\n.sa-debugger-log-internal .sa-debugger-log-text {\n  font-style: italic;\n}\n\n.sa-debugger-thread-indent {\n  width: calc(16px * var(--level));\n  margin-right: 4px;\n}\n.sa-debugger-thread-title .sa-debugger-thread-indent {\n  margin: 0;\n}\n.sa-debugger-thread-target-name {\n  font-weight: bold;\n  margin-right: 8px;\n}\n.sa-debugger-thread-running {\n  background-color: rgba(255, 187, 0, 0.233);\n  font-weight: bold;\n}\n\n.sa-debugger-block-preview {\n  color: white;\n  padding: 1px 6px;\n  margin-right: 4px;\n}\n.sa-debugger-block-preview[data-shape="round"] {\n  border-radius: 100px;\n}\n.sa-debugger-block-preview[data-shape="stacked"] {\n  border-radius: 3px;\n}\n\n.sa-debugger-thread-compiled {\n  font-style: italic;\n}\n\n.sa-debugger-compiler-warning {\n  position: relative;\n  display: block;\n  text-align: center;\n  height: 24px;\n  color: #2121bf;\n}\n.sa-debugger-compiler-warning[hidden] {\n  display: none;\n}\n[theme="dark"] .sa-debugger-compiler-warning {\n  color: #bdbdf9;\n}\n',""])},1558:function(e,t,n){e.exports=n.p+"static/assets/0e009d6e684951615b31a267baa37636.svg"},1559:function(e,t,n){e.exports=n.p+"static/assets/76b6cb627b95d79705c0b41664064f0e.svg"},1560:function(e,t,n){e.exports=n.p+"static/assets/c846a442121113b1d04f6b9d50912038.svg"},1602:function(e,t,n){"use strict";n.r(t),n.d(t,"resources",(function(){return C}));var s="data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcuNDggNy40OCIgc3R5bGU9InRyYW5zZm9ybTpyb3RhdGUoNDVkZWcpIj48cGF0aCBkPSJNMy43NCA2LjQ4VjFNMSAzLjc0aDUuNDgiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNmZmY7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS13aWR0aDoycHgiLz48L3N2Zz4=",o="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgc3Ryb2tlPSIjNEM5N0ZGIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MTtwYWludC1vcmRlcjptYXJrZXJzIHN0cm9rZSBmaWxsIiBkPSJNNCAzLjVjLS44MzEgMC0xLjUuNjY5LTEuNSAxLjV2MTBjMCAuODMxLjY2OSAxLjUgMS41IDEuNWgxMmMuODMxIDAgMS41LS42NjkgMS41LTEuNVY1YzAtLjgzMS0uNjY5LTEuNS0xLjUtMS41Wm0wIDFoMTJjLjI3NyAwIC41LjIyMy41LjV2MTBjMCAuMjc3LS4yMjMuNS0uNS41SDRhLjQ5OS40OTkgMCAwIDEtLjUtLjVWNWMwLS4yNzcuMjIzLS41LjUtLjVaIiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJtNS40MTcgNy41IDMuNzUgMi41LTMuNzUgMi41bTUgMGg0LjE2NiIgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzhmOGY4ZjtzdHJva2Utd2lkdGg6MTtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIi8+PC9nPjxjaXJjbGUgZmlsbD0iIzRDOTdGRiIgY3g9IjE2IiBjeT0iNCIgcj0iMyIvPjwvc3ZnPg==",a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgc3Ryb2tlPSIjNEM5N0ZGIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggc3R5bGU9ImZpbGw6IzU3NWU3NTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MTtwYWludC1vcmRlcjptYXJrZXJzIHN0cm9rZSBmaWxsIiBkPSJNNCAzLjVjLS44MzEgMC0xLjUuNjY5LTEuNSAxLjV2MTBjMCAuODMxLjY2OSAxLjUgMS41IDEuNWgxMmMuODMxIDAgMS41LS42NjkgMS41LTEuNVY1YzAtLjgzMS0uNjY5LTEuNS0xLjUtMS41Wm0wIDFoMTJjLjI3NyAwIC41LjIyMy41LjV2MTBjMCAuMjc3LS4yMjMuNS0uNS41SDRhLjQ5OS40OTkgMCAwIDEtLjUtLjVWNWMwLS4yNzcuMjIzLS41LjUtLjVaIiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJtNS40MTcgNy41IDMuNzUgMi41LTMuNzUgMi41bTUgMGg0LjE2NiIgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzhmOGY4ZjtzdHJva2Utd2lkdGg6MTtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIi8+PC9nPjwvc3ZnPg==",i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik00LjU0OCA3aDEwLjkwNGEuNS41IDAgMCAxIC40OTguNTQ1bC0uNzg1IDguNjM1QTIgMiAwIDAgMSAxMy4xNzQgMThINi44MjdhMiAyIDAgMCAxLTEuOTkyLTEuODJMNC4wNSA3LjU0NkEuNS41IDAgMCAxIDQuNTQ4IDd6bTIuNzg1LTMgLjU1My0xLjY1OEEuNS41IDAgMCAxIDguMzYgMmgzLjI4YS41LjUgMCAwIDEgLjQ3NC4zNDJMMTIuNjY3IDRIMTYuNWEuNS41IDAgMCAxIC41LjV2MWEuNS41IDAgMCAxLS41LjVoLTEzYS41LjUgMCAwIDEtLjUtLjV2LTFhLjUuNSAwIDAgMSAuNS0uNWgzLjgzM3ptMS4wNTQgMGgzLjIyNmwtLjMzNC0xSDguNzIxbC0uMzM0IDF6TTEwIDExLjcybDEuNTk1LTEuNTk1YS41LjUgMCAwIDEgLjcwNyAwbC4wNzMuMDczYS41LjUgMCAwIDEgMCAuNzA3TDEwLjc4IDEyLjVsMS41OTUgMS41OTVhLjUuNSAwIDAgMSAwIC43MDdsLS4wNzMuMDczYS41LjUgMCAwIDEtLjcwNyAwTDEwIDEzLjI4bC0xLjU5NSAxLjU5NWEuNS41IDAgMCAxLS43MDcgMGwtLjA3My0uMDczYS41LjUgMCAwIDEgMC0uNzA3TDkuMjIgMTIuNWwtMS41OTUtMS41OTVhLjUuNSAwIDAgMSAwLS43MDdsLjA3My0uMDczYS41LjUgMCAwIDEgLjcwNyAwTDEwIDExLjcyeiIgaWQ9ImEiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48ZyBtYXNrPSJ1cmwoI2IpIiBmaWxsPSIjRkZGIj48cGF0aCBkPSJNMCAwaDIwdjIwSDB6Ii8+PC9nPjwvZz48L3N2Zz4=",r="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTE0LjczIDguNzc5LTQuMjUzIDQuMjY0YS42MTkuNjE5IDAgMCAxLS44OSAwTDUuMzM2IDguNzc5QS42My42MyAwIDAgMSA1Ljc4OCA3LjdoMi4xMTdsMS4yNjMtNS4wMTZhLjkxMi45MTIgMCAwIDEgMS4xMDYtLjY1Ni44OS44OSAwIDAgMSAuNjY4LjY1NkwxMi4yMDYgNy43aDIuMDcyYy41NTkgMCAuODU2LjY3LjQ1MSAxLjA3OHpNMTggMTEuODEydjIuNTc5QzE4IDE2LjM3NSAxNi4zOTUgMTggMTQuNDE3IDE4SDUuNkEzLjYwNyAzLjYwNyAwIDAgMSAyIDE0LjM5di0yLjU3OGExLjE3IDEuMTcgMCAxIDEgMi4zMzcgMHYyLjU3OUExLjI3IDEuMjcgMCAwIDAgNS42IDE1LjY1Nmg4LjgxN2MuNjg2IDAgMS4yNDYtLjU3OCAxLjI0Ni0xLjI2NXYtMi41NzljMC0uNjU2LjUzLTEuMTcyIDEuMTY5LTEuMTcyLjY1NCAwIDEuMTY4LjUxNiAxLjE2OCAxLjE3MnoiIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==",c="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTEyIDE0YTEuMjUgMS4yNSAwIDEgMCAxLjI1IDEuMjVBMS4yNSAxLjI1IDAgMCAwIDEyIDE0em0wLTEuNWExIDEgMCAwIDAgMS0xdi0zYTEgMSAwIDAgMC0yIDB2M2ExIDEgMCAwIDAgMSAxek0xMiAyYTEwIDEwIDAgMSAwIDEwIDEwQTEwLjAxMSAxMC4wMTEgMCAwIDAgMTIgMnptMCAxOGE4IDggMCAxIDEgOC04IDguMDEgOC4wMSAwIDAgMS04IDh6IiBmaWxsPSJyZWQiLz48L3N2Zz4=",g="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTMgN2gxOGExIDEgMCAwIDAgMC0ySDNhMSAxIDAgMCAwIDAgMnptMCA0aDE0YTEgMSAwIDAgMCAwLTJIM2ExIDEgMCAwIDAgMCAyem0xOCAySDNhMSAxIDAgMCAwIDAgMmgxOGExIDEgMCAwIDAgMC0yem0tNCA0SDNhMSAxIDAgMCAwIDAgMmgxNGExIDEgMCAwIDAgMC0yeiIgZmlsbD0iIzRjOTdmZiIvPjwvc3ZnPg==",d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyNCAyNCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiPjxwYXRoIHN0cm9rZT0iIzRjOTdmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik05IDE5di02YTIgMiAwIDAgMC0yLTJINWEyIDIgMCAwIDAtMiAydjZhMiAyIDAgMCAwIDIgMmgyYTIgMiAwIDAgMCAyLTJ6bTAgMFY5YTIgMiAwIDAgMSAyLTJoMmEyIDIgMCAwIDEgMiAydjEwbS02IDBhMiAyIDAgMCAwIDIgMmgyYTIgMiAwIDAgMCAyLTJtMCAwVjVhMiAyIDAgMCAxIDItMmgyYTIgMiAwIDAgMSAyIDJ2MTRhMiAyIDAgMCAxLTIgMmgtMmEyIDIgMCAwIDEtMi0yeiIvPjwvc3ZnPg==",l="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDkiIGhlaWdodD0iNTIiIHZpZXdCb3g9Ii01IDAgNDkgNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik0xNy4yMjEgOC4zNDVjMi41NTYtNC4yNTkgNi43MDItNC4yNTIgOS4yNTQgMGwxMy42NzcgMjIuNzk2YzIuNTU1IDQuMjU4LjU5NyA3LjcxLTQuMzggNy43MUg3LjkyNGMtNC45NzMgMC02LjkzLTMuNDU4LTQuMzgtNy43MUwxNy4yMjIgOC4zNDV6IiBpZD0iYSIvPjwvZGVmcz48dXNlIHN0cm9rZT0iI0ZGRiIgZmlsbD0iI0ZGRiIgeGxpbms6aHJlZj0iI2EiIHRyYW5zZm9ybT0icm90YXRlKDkwIDIwLjg1IDIzLjAwMykiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==",u="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkiIGhlaWdodD0iMTkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjIuNjggMTIuMmExLjYgMS42IDAgMCAxLTEuMjcuNjNoLTcuNjlhMS41OSAxLjU5IDAgMCAxLTEuMTYtMi41OGwxLjEyLTEuNDFhNC44MiA0LjgyIDAgMCAwLTMuMTQtLjc3IDQuMzEgNC4zMSAwIDAgMC0yIC44QTQuMjUgNC4yNSAwIDAgMCA3LjIgMTAuNmE1LjA2IDUuMDYgMCAwIDAgLjU0IDQuNjJBNS41OCA1LjU4IDAgMCAwIDEyIDE3Ljc0YTIuMjYgMi4yNiAwIDAgMS0uMTYgNC41MkExMC4yNSAxMC4yNSAwIDAgMSAzLjc0IDE4YTEwLjE0IDEwLjE0IDAgMCAxLTEuNDktOS4yMiA5LjcgOS43IDAgMCAxIDIuODMtNC4xNEE5LjkyIDkuOTIgMCAwIDEgOS42NiAyLjVhMTAuNjYgMTAuNjYgMCAwIDEgNy43MiAxLjY4bDEuMDgtMS4zNWExLjU3IDEuNTcgMCAwIDEgMS4yNC0uNiAxLjYgMS42IDAgMCAxIDEuNTQgMS4yMWwxLjcgNy4zN2ExLjU3IDEuNTcgMCAwIDEtLjI2IDEuMzlaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTIxLjM4IDExLjgzaC03LjYxYS41OS41OSAwIDAgMS0uNDMtMWwxLjc1LTIuMTlhNS45IDUuOSAwIDAgMC00LjctMS41OCA1LjA3IDUuMDcgMCAwIDAtNC4xMSAzLjE3QTYgNiAwIDAgMCA3IDE1Ljc3YTYuNTEgNi41MSAwIDAgMCA1IDIuOTIgMS4zMSAxLjMxIDAgMCAxLS4wOCAyLjYyIDkuMyA5LjMgMCAwIDEtNy4zNS0zLjgyIDkuMTYgOS4xNiAwIDAgMS0xLjQtOC4zN0E4LjUxIDguNTEgMCAwIDEgNS43MSA1LjRhOC43NiA4Ljc2IDAgMCAxIDQuMTEtMS45MiA5LjcxIDkuNzEgMCAwIDEgNy43NSAyLjA3bDEuNjctMi4xYS41OS41OSAwIDAgMSAxIC4yMUwyMiAxMS4wOGEuNTkuNTkgMCAwIDEtLjYyLjc1WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjwvc3ZnPg==",h="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTIwLjkyIDEyLjYyYTEgMSAwIDAgMC0uMjEtLjMzbC0zLTNhMSAxIDAgMCAwLTEuNDIgMS40MmwxLjMgMS4yOUg4YTEgMSAwIDAgMS0xLTFWN2ExIDEgMCAwIDAtMiAwdjRhMyAzIDAgMCAwIDMgM2g5LjU5bC0xLjMgMS4yOWExIDEgMCAwIDAgMCAxLjQyIDEgMSAwIDAgMCAxLjQyIDBsMy0zYTEgMSAwIDAgMCAuMjEtLjMzIDEgMSAwIDAgMCAwLS43NnoiIGZpbGw9ImdyYXkiLz48L3N2Zz4=",m="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTE5IDJIOWEzIDMgMCAwIDAtMyAzdjFINWEzIDMgMCAwIDAtMyAzdjEwYTMgMyAwIDAgMCAzIDNoMTBhMyAzIDAgMCAwIDMtM3YtMWgxYTMgMyAwIDAgMCAzLTNWNWEzIDMgMCAwIDAtMy0zem0tMyAxN2ExIDEgMCAwIDEtMSAxSDVhMSAxIDAgMCAxLTEtMXYtN2gxMnptMC05SDRWOWExIDEgMCAwIDEgMS0xaDEwYTEgMSAwIDAgMSAxIDF6bTQgNWExIDEgMCAwIDEtMSAxaC0xVjlhMyAzIDAgMCAwLS4xOC0xSDIwem0wLTlIOFY1YTEgMSAwIDAgMSAxLTFoMTBhMSAxIDAgMCAxIDEgMXoiIGZpbGw9IiM0Yzk3ZmYiLz48L3N2Zz4=",M="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSItbXMtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKSI+PHBhdGggZD0iTTEyIDE2YTEgMSAwIDEgMCAxIDEgMSAxIDAgMCAwLTEtMXptMTAuNjcgMS40Ny04LjA1LTE0YTMgMyAwIDAgMC01LjI0IDBsLTggMTRBMyAzIDAgMCAwIDMuOTQgMjJoMTYuMTJhMyAzIDAgMCAwIDIuNjEtNC41M3ptLTEuNzMgMmExIDEgMCAwIDEtLjg4LjUxSDMuOTRhMSAxIDAgMCAxLS44OC0uNTEgMSAxIDAgMCAxIDAtMWw4LTE0YTEgMSAwIDAgMSAxLjc4IDBsOC4wNSAxNGExIDEgMCAwIDEgLjA1IDEuMDJ6TTEyIDhhMSAxIDAgMCAwLTEgMXY0YTEgMSAwIDAgMCAyIDBWOWExIDEgMCAwIDAtMS0xeiIgZmlsbD0iI2UwYmIwMCIvPjwvc3ZnPg==",I=n(1496),b=n(1499);const p=(e,t,n)=>Math.max(t,Math.min(n,e)),w=(e,t)=>{const n=+t.dataset.index;let s=!1;for(const o of e.children){if(+o.dataset.index>n){s=!0,e.insertBefore(t,o);break}}s||e.appendChild(t)};var A=class{constructor(){this.rows=[],this.canAutoScrollToEnd=!0,this.rowHeight=20,this.outerElement=document.createElement("div"),this.outerElement.className="sa-debugger-log-outer",this.innerElement=document.createElement("div"),this.innerElement.className="sa-debugger-log-inner",this.outerElement.appendChild(this.innerElement),this.innerElement.addEventListener("scroll",this._handleScroll.bind(this),{passive:!0}),this.innerElement.addEventListener("wheel",this._handleWheel.bind(this),{passive:!0}),this.endElement=document.createElement("div"),this.endElement.className="sa-debugger-log-end",this.endElement.dataset.index="-1",this.innerElement.appendChild(this.endElement),this.placeholderElement=document.createElement("div"),this.placeholderElement.className="sa-debugger-log-empty",this.visible=!1,this.isScrolledToEnd=!0,this.scrollTopWhenHidden="end",this.scrollTop=0,this.updateContentQueued=!1,this.scrollToEndQueued=!1,this.oldLength=-1,this.rowToMetadata=new Map}append(e){this.queueUpdateContent(),this._queueScrollToEnd(),this.rows.push(e);for(;this.rows.length>2e5;)this.rows.shift()}clear(){this.rows.length=0,this.scrollTop=0,this.isScrolledToEnd=!0,this.queueUpdateContent()}show(){this.visible=!0,this.height=this.innerElement.offsetHeight,this.queueUpdateContent(),"end"===this.scrollTopWhenHidden?this._queueScrollToEnd():this.innerElement.scrollTop=this.scrollTopWhenHidden}hide(){this.visible=!1,this.scrollTopWhenHidden=this.isScrolledToEnd?"end":this.scrollTop}_handleScroll(e){this.scrollTop=e.target.scrollTop,this.isScrolledToEnd=e.target.scrollTop+5>=e.target.scrollHeight-e.target.clientHeight,this.queueUpdateContent()}_handleWheel(e){e.deltaY<0&&(this.isScrolledToEnd=!1)}scrollIntoView(e){const t=e*this.rowHeight,n=this.scrollTop,s=this.scrollTop+this.height;t>n&&t<s||(this.scrollTop=t,this.innerElement.scrollTop=t)}_queueScrollToEnd(){this.visible&&this.canAutoScrollToEnd&&this.isScrolledToEnd&&!this.scrollToEndQueued&&(this.scrollToEndQueued=!0,queueMicrotask(()=>{if(this.scrollToEndQueued=!1,this.isScrolledToEnd){const e=this.innerElement.scrollHeight-this.innerElement.offsetHeight;this.innerElement.scrollTop=e,this.scrollTop=e}}))}queueUpdateContent(){this.visible&&!this.updateContentQueued&&(this.updateContentQueued=!0,queueMicrotask(()=>{this.updateContentQueued=!1,this.updateContent()}))}generateRow(e){}renderRow(e,t){}updateContent(){if(this.rows.length!==this.oldLength){this.oldLength=this.rows.length;const e=this.rows.length*this.rowHeight;if(this.endElement.style.transform="translateY(".concat(e,"px)"),this.rows.length)this.placeholderElement.remove();else{this.innerElement.appendChild(this.placeholderElement);for(const e of this.rowToMetadata.values())e.elements.root.remove();this.rowToMetadata.clear()}}if(0===this.rows.length)return;const e=Math.floor(this.scrollTop/this.rowHeight),t=Math.ceil(this.height/this.rowHeight),n=p(e-5,0,this.rows.length),s=p(e+t+5,0,this.rows.length),o=new Set,a=[];for(let e=n;e<s;e++){const t=this.rows[e];o.add(t);let n=this.rowToMetadata.get(t);if(!n){const e=this.generateRow(t);a.push(e.root),n={stringify:null,elements:e},this.rowToMetadata.set(t,n)}const s=JSON.stringify(t);s!==n.stringify&&(n.stringify=s,this.renderRow(n.elements,t));const i=n.elements.root;i.style.transform="translateY(".concat(e*this.rowHeight,"px)"),i.dataset.index=e}for(const[e,t]of this.rowToMetadata.entries())o.has(e)||(t.elements.root.remove(),this.rowToMetadata.delete(e));for(const e of a)w(this.innerElement,e)}};const y=e=>{if("/icons/close.svg"===e)return s;if("/icons/debug-unread.svg"===e)return o;if("/icons/debug.svg"===e)return a;if("/icons/delete.svg"===e)return i;if("/icons/download-white.svg"===e)return r;if("/icons/error.svg"===e)return c;if("/icons/logs.svg"===e)return g;if("/icons/performance.svg"===e)return d;if("/icons/play.svg"===e)return l;if("/icons/step.svg"===e)return u;if("/icons/subthread.svg"===e)return h;if("/icons/threads.svg"===e)return m;if("/icons/warning.svg"===e)return M;throw new Error("Unknown asset: ".concat(e))};async function D(e){let{debug:t,addon:n,console:s,msg:o}=e;const a=n.tab.traps.vm,i=t.createHeaderTab({text:o("tab-logs"),icon:y("/icons/logs.svg")}),r=new A;r.placeholderElement.textContent=o("no-logs");r.generateRow=e=>{const n=document.createElement("div");n.className="sa-debugger-log",e.internal&&n.classList.add("sa-debugger-log-internal"),n.dataset.type=e.type;const s=document.createElement("div");s.className="sa-debugger-log-icon","warn"!==e.type&&"error"!==e.type||(s.title=o("icon-"+e.type)),n.appendChild(s);const i=document.createElement("div");if(i.className="sa-debugger-log-repeats",i.style.display="none",n.appendChild(i),e.preview&&e.blockId&&e.targetInfo){const s=e.targetInfo.originalId,o=((e,n)=>{var s;const o=a.runtime.getTargetById(e);if(!o)return null;const i=t.getBlock(o,n);return i?null===(s=Object.values(i.inputs)[0])||void 0===s?void 0:s.block:null})(s,e.blockId);if(o){const e=t.createBlockPreview(s,o);e&&n.appendChild(e)}}const r=document.createElement("div");return r.className="sa-debugger-log-text",0===e.text.length?(r.classList.add("sa-debugger-log-text-empty"),r.textContent=o("empty-string")):(r.textContent=e.text,r.title=e.text),n.appendChild(r),e.targetInfo&&e.blockId&&n.appendChild(t.createBlockLink(e.targetInfo,e.blockId)),{root:n,repeats:i}},r.renderRow=(e,t)=>{const{repeats:n}=e;t.count>1&&(n.style.display="",n.textContent=t.count)};const c=t.createHeaderButton({text:o("export"),icon:y("/icons/download-white.svg"),description:o("export-desc")});c.element.addEventListener("click",async e=>{const t=e.shiftKey?await n.tab.prompt(o("export"),o("enter-format"),"{sprite}: {content} ({type})",{useEditorClasses:!0}):"{sprite}: {content} ({type})";if(!t)return;const s=r.rows.map(e=>{let{text:n,targetInfo:s,type:a,count:i}=e;return(t.replace(/\{(sprite|type|content)\}/g,(e,t)=>({sprite:s?s.name:o("unknown-sprite"),type:a,content:n}[t]))+"\n").repeat(i)}).join("");var a,i;a="logs.txt",i=s,Object(b.a)(a,new Blob([i],{type:"text/plain"}))});const g=t.createHeaderButton({text:o("clear"),icon:y("/icons/delete.svg")});g.element.addEventListener("click",()=>{d()});const d=()=>{r.clear()};return{tab:i,content:r.outerElement,buttons:[c,g],show:()=>{r.show(),t.setHasUnreadMessage(!1)},hide:()=>{r.hide()},addLog:(e,n,s)=>{const o={text:e,type:s,count:1,preview:!0};if(n){o.blockId=n.peekStack();const e=n.target.id;o.targetId=e,o.targetInfo=t.getTargetInfoById(e)}"internal"===s&&(o.internal=!0,o.preview=!1,o.type="log"),"internal-warn"===s&&(o.internal=!0,o.type="warn");const a=r.rows[r.rows.length-1];var i,c;a&&(c=a,(i=o).text===c.text&&i.type===c.type&&i.internal===c.internal&&i.blockId===c.blockId&&i.targetId===c.targetId)?(a.count++,r.queueUpdateContent()):r.append(o),r.visible||o.internal||t.setHasUnreadMessage(!0)},clearLogs:d}}var N=n(1500);const E=e=>{if("/icons/close.svg"===e)return s;if("/icons/debug-unread.svg"===e)return o;if("/icons/debug.svg"===e)return a;if("/icons/delete.svg"===e)return i;if("/icons/download-white.svg"===e)return r;if("/icons/error.svg"===e)return c;if("/icons/logs.svg"===e)return g;if("/icons/performance.svg"===e)return d;if("/icons/play.svg"===e)return l;if("/icons/step.svg"===e)return u;if("/icons/subthread.svg"===e)return h;if("/icons/threads.svg"===e)return m;if("/icons/warning.svg"===e)return M;throw new Error("Unknown asset: ".concat(e))},L=(e,t)=>{for(const n of t)e.push(n)};async function v(e){let{debug:t,addon:n,console:s,msg:o}=e;const a=n.tab.traps.vm,i=t.createHeaderTab({text:o("tab-threads"),icon:E("/icons/threads.svg")}),r=new A;r.canAutoScrollToEnd=!1,r.outerElement.classList.add("sa-debugger-threads"),r.placeholderElement.textContent=o("no-threads-running");const c=new N.a(10,"#ff0000");r.generateRow=e=>{const n=document.createElement("div");n.className="sa-debugger-log";const s="thread-header"===e.type,a=document.createElement("div");if(a.className="sa-debugger-thread-indent",a.style.setProperty("--level",s?e.depth:e.depth+1),n.appendChild(a),s){if(n.classList.add("sa-debugger-thread-title"),e.depth>0){const e=document.createElement("div");e.className="sa-debugger-log-icon",n.appendChild(e)}const t=document.createElement("div");t.textContent=e.targetName,t.className="sa-debugger-thread-target-name",n.appendChild(t);const s=document.createElement("div");s.className="sa-debugger-thread-id",s.textContent=o("thread",{id:e.id}),n.appendChild(s)}if("thread-stack"===e.type){const s=t.createBlockPreview(e.targetId,e.blockId);s&&n.appendChild(s)}if("compiled"===e.type){const e=document.createElement("div");e.className="sa-debugger-thread-compiled",e.textContent="Compiled threads can't be stepped and have no stack information.",n.appendChild(e)}return e.targetId&&e.blockId&&n.appendChild(t.createBlockLink(t.getTargetInfoById(e.targetId),e.blockId)),{root:n}},r.renderRow=(e,t)=>{const{root:n}=e;n.classList.toggle("sa-debugger-thread-running",!!t.running)};let g=new WeakMap;const d=new WeakMap;let l=1;const u=()=>{if(!r.visible)return;const e=[],n=a.runtime.threads,s=new Set,o=(e,n)=>{if(s.has(e))return[];s.add(e);const a=(e=>(d.has(e)||d.set(e,l++),d.get(e)))(e),i=e.target;g.has(e)||g.set(e,{headerItem:{type:"thread-header",depth:n,targetName:i.getName(),id:a},compiledItem:e.isCompiled?{type:"compiled",depth:1}:null,blockCache:new WeakMap});const r=g.get(e),c=Object(I.a)(),u=(t,s)=>{const a=t.id;if(!t)return;const g=e.stackFrames[s];r.blockCache.has(t)||r.blockCache.set(t,{});const d=r.blockCache.get(t);let l=d[s];l||(l=d[s]={type:"thread-stack",depth:n,targetId:i.id,blockId:a}),l.running=e===c&&(e.isCompiled||a===c.peekStack()&&s===c.stackFrames.length-1);const u=[l];if(g&&g.executionContext&&g.executionContext.startedThreads)for(const e of g.executionContext.startedThreads)L(u,o(e,n+1));return u},h=t.getBlock(e.target,e.topBlock),m=[r.headerItem];if(h){L(m,u(h,0));for(let n=0;n<e.stack.length;n++){const s=e.stack[n];if(s===h.id)continue;const o=t.getBlock(e.target,s);o&&L(m,u(o,n))}}return r.compiledItem&&m.push(r.compiledItem),m};for(let t=0;t<n.length;t++){const s=n[t];s.updateMonitor||L(e,o(s,0))}r.rows=e,r.queueUpdateContent()};t.addAfterStepCallback(()=>{u();const e=Object(I.a)();e?c.setGlowingThreads([e]):c.setGlowingThreads([])});const h=t.createHeaderButton({text:o("step"),icon:E("/icons/step.svg"),description:o("step-desc")});h.element.addEventListener("click",()=>{Object(I.g)()});const m=e=>{h.element.style.display=e?"":"none",u()};m(Object(I.b)()),Object(I.c)(m),Object(I.d)(u);return{tab:i,content:r.outerElement,buttons:[h],show:()=>{r.show(),u()},hide:()=>{r.hide()}}}var x=n(1504);const j=e=>{if("/icons/close.svg"===e)return s;if("/icons/debug-unread.svg"===e)return o;if("/icons/debug.svg"===e)return a;if("/icons/delete.svg"===e)return i;if("/icons/download-white.svg"===e)return r;if("/icons/error.svg"===e)return c;if("/icons/logs.svg"===e)return g;if("/icons/performance.svg"===e)return d;if("/icons/play.svg"===e)return l;if("/icons/step.svg"===e)return u;if("/icons/subthread.svg"===e)return h;if("/icons/threads.svg"===e)return m;if("/icons/warning.svg"===e)return M;throw new Error("Unknown asset: ".concat(e))},f=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)};var T=n(1557);const C={"userscript.js":async function(e){let t,{addon:n,global:s,console:o,msg:a}=e;Object(I.f)(n.tab.traps.vm);const i=[],r=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];t?t.addLog(...n):i.push(n)};let c=!1;n.tab.addBlock("​​breakpoint​​",{args:[],displayName:a("block-breakpoint"),callback:(e,t)=>{n.tab.redux.state.scratchGui.mode.isPlayerOnly?c||(r(a("cannot-pause-player"),t,"error"),c=!0):(Object(I.e)(!0),L(!0))}}),n.tab.addBlock("​​log​​ %s",{args:["content"],displayName:a("block-log"),callback:(e,t)=>{let{content:n}=e;r(n,t,"log")}}),n.tab.addBlock("​​warn​​ %s",{args:["content"],displayName:a("block-warn"),callback:(e,t)=>{let{content:n}=e;r(n,t,"warn")}}),n.tab.addBlock("​​error​​ %s",{args:["content"],displayName:a("block-error"),callback:(e,t)=>{let{content:n}=e;r(n,t,"error")}});const g=n.tab.traps.vm;await new Promise((e,t)=>{if(g.editingTarget)return e();g.runtime.once("PROJECT_LOADED",e)});const d=await n.tab.traps.getBlockly(),l=document.createElement("div");l.className="sa-debugger-container";const u=document.createElement("div");u.className=n.tab.scratchClass("button_outlined-button","stage-header_stage-button");const h=document.createElement("div");h.className=n.tab.scratchClass("button_content");const m=document.createElement("img");m.className=n.tab.scratchClass("stage-header_stage-button-icon"),m.draggable=!1,m.src=j("/icons/debug.svg"),h.appendChild(m),u.appendChild(h),l.appendChild(u),u.addEventListener("click",()=>L(!0));const M=Object.assign(document.createElement("div"),{className:n.tab.scratchClass("card_card",{others:"sa-debugger-interface"})}),b=Object.assign(document.createElement("div"),{className:n.tab.scratchClass("card_header-buttons")}),p=Object.assign(document.createElement("ul"),{className:"sa-debugger-tabs"}),w=Object.assign(document.createElement("div"),{className:n.tab.scratchClass("card_header-buttons-right",{others:"sa-debugger-header-buttons"})}),A=Object.assign(document.createElement("div"),{className:"sa-debugger-tab-content"}),y=document.createElement("a");y.addEventListener("click",()=>{n.tab.redux.dispatch({type:"scratch-gui/modals/OPEN_MODAL",modal:"settingsModal"})}),y.className="sa-debugger-log sa-debugger-compiler-warning",y.textContent="The debugger works best when the compiler is disabled.";const N=()=>{y.hidden=!g.runtime.compilerOptions.enabled};g.on("COMPILER_OPTIONS_CHANGED",N),N();let E=!1;const L=e=>{E=e,M.style.display=E?"flex":"",E?q.show():q.hide()};let T=0,C=0,S=0,k=0;const z=()=>{document.removeEventListener("mouseup",z),document.removeEventListener("mousemove",W)},Z=(e,t)=>{S=e,k=t;const n=(document.documentElement.clientWidth||document.body.clientWidth)-1,s=(document.documentElement.clientHeight||document.body.clientHeight)-1,o=Math.max(0,Math.min(e-T,n-M.offsetWidth)),a=Math.max(0,Math.min(t-C,s-M.offsetHeight));M.style.left=o+"px",M.style.top=a+"px"},W=e=>{e.preventDefault(),Z(e.clientX,e.clientY)};window.addEventListener("resize",()=>{Z(S,k)}),b.addEventListener("mousedown",e=>{e.preventDefault(),T=e.clientX-M.offsetLeft,C=e.clientY-M.offsetTop,S=e.clientX,k=e.clientY,document.addEventListener("mouseup",z),document.addEventListener("mousemove",W)}),b.append(p,w),M.append(b,y,A),document.body.append(M);const O=e=>{let{text:t,icon:s,description:o}=e;const a=Object.assign(document.createElement("div"),{className:n.tab.scratchClass("card_shrink-expand-button"),draggable:!1});o&&(a.title=o);const i=Object.assign(document.createElement("img"),{src:s,draggable:!1}),r=Object.assign(document.createElement("span"),{textContent:t});return a.appendChild(i),a.appendChild(r),{element:a,image:i,text:r}},G=O({text:a("unpause"),icon:j("/icons/play.svg")});G.element.classList.add("sa-debugger-unpause"),G.element.addEventListener("click",()=>Object(I.e)(!1));const Y=e=>{G.element.style.display=e?"":"none"};Y(Object(I.b)()),Object(I.c)(Y);const H=O({text:a("close"),icon:j("/icons/close.svg")});H.element.addEventListener("click",()=>L(!1));const U=g.runtime._step,B=[];g.runtime._step=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=U.call(this,...t);for(const e of B)e();return s};const J=(e,t)=>e.blocks.getBlock(t)||g.runtime.flyoutBlocks.getBlock(t),P=e=>{e!==g.editingTarget.id&&g.runtime.getTargetById(e)&&g.setEditingTarget(e)},R=()=>{const e=n.tab.redux;0!==e.state.scratchGui.editorTab.activeTabIndex&&e.dispatch({type:"scratch-gui/navigation/ACTIVATE_TAB",activeTabIndex:0})},_=e=>{const t=Blockly.getMainWorkspace().getBlockById(e);t&&(t.workspace.isFlyout||new x.a(n).scrollBlockIntoView(e))},Q=e=>e.replace(/%[nbs]/g,"()"),V={debug:{createHeaderButton:O,createHeaderTab:e=>{let{text:t,icon:n}=e;const s=document.createElement("li"),o=Object.assign(document.createElement("img"),{src:n,draggable:!1}),a=Object.assign(document.createElement("span"),{textContent:t});return s.appendChild(o),s.appendChild(a),{element:s,image:o,text:a}},setHasUnreadMessage:e=>{const t=j(e?"/icons/debug-unread.svg":"/icons/debug.svg");m.src!==t&&(m.src=t)},addAfterStepCallback:e=>{B.push(e)},getBlock:J,getTargetInfoById:e=>{const t=g.runtime.getTargetById(e);if(t){let e=t.getName(),n=t;return t.isOriginal||(e=a("clone-of",{sprite:e}),n=t.sprite.clones[0]),{exists:!0,originalId:n.id,name:e}}return{exists:!1,original:null,name:a("unknown-sprite")}},createBlockLink:(e,t)=>{const n=document.createElement("a");n.className="sa-debugger-log-link";const{exists:s,name:o,originalId:a}=e;return n.textContent=o,s?n.addEventListener("mousedown",()=>{P(a),R(),_(t)}):n.classList.add("sa-debugger-log-link-unknown"),n},createBlockPreview:(e,t)=>{const s=g.runtime.getTargetById(e);if(!s)return null;const o=J(s,t);if(!o||"text"===o.opcode)return null;let a,i,r,c;if("data_variable"===o.opcode||"data_listcontents"===o.opcode||"argument_reporter_string_number"===o.opcode||"argument_reporter_boolean"===o.opcode)a=Object.values(o.fields)[0].value,i="data_variable"===o.opcode?"data":"data_listcontents"===o.opcode?"list":"more",r="round";else if("procedures_call"===o.opcode){const e=o.mutation.proccode;a=Q(e);const t=n.tab.getCustomBlock(e);t?(i="addon-custom-block",c=t.color):i="more"}else if("procedures_definition"===o.opcode){const e=o.inputs.custom_block.block,t=J(s,e).mutation.proccode;a=d.ScratchMsgs.translate("PROCEDURES_DEFINITION","define %1").replace("%1",Q(t)),i="more"}else{var l;const e={jsonInit(e){l=e}},t=d.Blocks[o.opcode];if(t)try{t.init.call(e)}catch(e){}if(!l)return null;if(a=(e=>{const t=t=>{const n=e["message".concat(t)],s=e["args".concat(t)];if(!n)return null;const o=n.split(/%\d+/g);let a="";for(let e=0;e<o.length;e++){a+=o[e];const t=s&&s[e];if(t){const e=t.type;if("field_vertical_separator"===e);else if("field_image"===e){const e=t.src;e.endsWith("rotate-left.svg")?a+="↩":e.endsWith("rotate-right.svg")&&(a+="↪")}else a+="()"}}return a},n=[];let s=0;for(;;){const e=t(s);if(!e)break;n.push(e),s++}return n.join(" ")})(l),!a)return null;i=l.category;r=l.extensions&&(l.extensions.includes("shape_statement")||l.extensions.includes("shape_hat")||l.extensions.includes("shape_end"))||"previousStatement"in l||"nextStatement"in l?"stacked":"round"}if(!a||!i)return null;if(!c){const e={"data-lists":"data_lists",list:"data_lists",events:"event"},t=d.Colours[e[i]||i];c=t?t.primary:d.Colours.pen.primary}const u=document.createElement("span");u.className="sa-debugger-block-preview",u.textContent=a,u.style.backgroundColor=c,u.dataset.shape=r;return u.dataset.category={list:"data-lists",more:"custom"}[i]||i,u}},addon:n,msg:a,console:o};t=await D(V);const X=await v(V),F=[t,X];for(const e of i)t.addLog(...e);let q;i.length=0;const K=e=>{if(e===q)return;q&&(q.hide(),q.tab.element.classList.remove("sa-debugger-tab-selected")),e.tab.element.classList.add("sa-debugger-tab-selected"),q=e,f(A),A.appendChild(e.content),f(w),w.appendChild(G.element);for(const t of e.buttons)w.appendChild(t.element);w.appendChild(H.element),E&&q.show()};for(const e of F)e.tab.element.addEventListener("click",()=>{K(e)}),p.appendChild(e.tab.element);K(F[0]),n.tab.redux.state&&"small"===n.tab.redux.state.scratchGui.stageSize.stageSize&&document.body.classList.add("sa-debugger-small"),document.addEventListener("click",e=>{e.target.closest("[class*='stage-header_stage-button-first']")?document.body.classList.add("sa-debugger-small"):e.target.closest("[class*='stage-header_stage-button-last']")&&document.body.classList.remove("sa-debugger-small")},{capture:!0});const $=g.runtime.greenFlag;g.runtime.greenFlag=function(){n.settings.get("log_clear_greenflag")&&t.clearLogs(),n.settings.get("log_greenflag")&&t.addLog(a("log-msg-flag-clicked"),null,"internal");for(var e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];return $.call(this,...s)};const ee=g.runtime.targets[0].constructor.prototype.makeClone;g.runtime.targets[0].constructor.prototype.makeClone=function(){n.settings.get("log_failed_clone_creation")&&!g.runtime.clonesAvailable()&&t.addLog(a("log-msg-clone-cap",{sprite:this.getName()}),g.runtime.sequencer.activeThread,"internal-warn");for(var e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];var i=ee.call(this,...s);return n.settings.get("log_clone_create")&&i&&t.addLog(a("log-msg-clone-created",{sprite:this.getName()}),g.runtime.sequencer.activeThread,"internal"),i};const te=g.runtime.startHats;for(g.runtime.startHats=function(e,s){n.settings.get("log_broadcasts")&&"event_whenbroadcastreceived"===e&&t.addLog(a("log-msg-broadcasted",{broadcast:s.BROADCAST_OPTION}),g.runtime.sequencer.activeThread,"internal");for(var o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];return te.call(this,e,s,...i)};;)await n.tab.waitForElement('[class*="stage-header_stage-size-row"]',{markAsSeen:!0,reduxEvents:["scratch-gui/mode/SET_PLAYER","scratch-gui/mode/SET_FULL_SCREEN","fontsLoaded/SET_FONTS_LOADED","scratch-gui/locales/SELECT_LOCALE"]}),"editor"===n.tab.editorMode?n.tab.appendToSharedSpace({space:"stageHeader",element:l,order:0}):L(!1)},"style.css":n.n(T).a}}}]);